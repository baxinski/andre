{"rLMv42IB8Wx35J1-wcxH": {"status": "", "category": 4, "updated": "2018-04-20T13:13:00.486495", "user_id": null, "views": "3", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Network Scans", "released": "2018-04-20T13:13:00.486491", "sigma_text": "title: Network Scans\ndescription: Detects many failed connection attempts to different ports or hosts\nauthor: Thomas Patzke\nlogsource:\n    category: firewall\ndetection:\n    selection:\n        action: denied\n    timeframe: 24h\n    condition:\n        - selection | count(dst_port) by src_ip > 10\n        - selection | count(dst_ip) by src_ip > 10\nfields:\n    - src_ip\n    - dst_ip\n    - dst_port\nfalsepositives:\n    - Inventarization systems\n    - Vulnerability scans\n    - Penetration testing activity\nlevel: medium\n", "git_filepath": "/network/net_susp_network_scan.yml", "title": "sigma: Network Scans", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "d9d3030101ea563fdd3f15539adc431765fd43c5e0a92dc6ab2aea98e89f67b7", "level": "medium"}, "C7Mw42IB8Wx35J1-781m": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:17.826647", "user_id": null, "views": 6, "permission_id": 3, "author": "Michael Haag", "mitre_attack": null, "title_keyword": "sigma: WSF/JSE/JS/VBA/VBE File Execution", "released": "2018-04-20T13:14:17.826644", "sigma_text": "title: WSF/JSE/JS/VBA/VBE File Execution\nstatus: experimental\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '*.jse'\n            - '*.vbe'\n            - '*.js'\n            - '*.vba'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. I recommend adding the user profile path in CommandLine if it is getting too noisy.\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_script_execution.yml", "title": "sigma: WSF/JSE/JS/VBA/VBE File Execution", "author_keyword": "Michael Haag", "is_verified": true, "downloads": 0, "hash": "b7760869dfb5db9ff271d0136e769338e253a0560542e09c9f96ed735e97ecf2", "level": "medium"}, "HbMx42IB8Wx35J1-J83F": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:32.259984", "user_id": null, "views": 9, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Scheduled Task Creation", "released": "2018-04-20T13:14:32.259981", "sigma_text": "title: Scheduled Task Creation\nstatus: experimental\ndescription: Detects the creation of scheduled tasks in user session \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\schtasks.exe'\n        CommandLine: '* /create *'\n    filter:\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\n    - Software installation\nlevel: low\n", "git_filepath": "/windows/sysmon/sysmon_susp_schtask_creation.yml", "title": "sigma: Scheduled Task Creation", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "494813e45ee6efc2d696560a5e5f018e1185412f3d10fc338a1f052d891eb9f6", "level": "low"}, "27Mw42IB8Wx35J1-Vsya": {"status": "experimental", "category": 13, "updated": "2018-04-20T13:13:38.712225", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: WMI Persistence", "released": "2018-04-20T13:13:38.712222", "sigma_text": "title: WMI Persistence\nstatus: experimental\ndescription: Detects suspicious WMI event filter and command line event consumer based on event id 5861 and 5859 (Windows 10, 2012 and higher). Modified by SOC Prime, replaced condition \"selection and 1 of keywords or selection2\" with \"(selection and keywords) or selection2\"\nauthor: Florian Roth\nreferences:\n    - https://twitter.com/mattifestation/status/899646620148539397\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nlogsource:\n    product: windows\n    service: wmi\ndetection:\n    selection:\n        EventID: 5861\n    keywords:\n        - 'ActiveScriptEventConsumer'\n        - 'CommandLineEventConsumer'\n        - 'CommandLineTemplate'\n        - 'Binding EventFilter'\n    selection2:\n        EventID: 5859\n    condition: (selection and keywords) or selection2\nfalsepositives:\n    - Unknown (data set is too small; further testing needed)\nlevel: high\n", "git_filepath": "/windows/other/win_wmi_persistence.yml", "title": "sigma: WMI Persistence", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "ca78de2954618bbc3cc7c528312cf93d86638573ce7084ff9c8d7b6324439282", "level": "high"}, "tzwdG2YBatiiaHt9jCRn": {"status": "", "category": null, "updated": "2018-09-27T12:58:20.447864", "author_keyword": "@neu5ron", "user_id": null, "title": "Active Directory User Backdoors", "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "Active Directory User Backdoors", "released": "2018-09-27T12:58:20.447861", "sigma_text": "title: Active Directory User Backdoors\ndescription: Detects scenarios where one can control another users account without having to use their credentials via msDS-AllowedToDelegateTo and or service principal names (SPN).\nreferences:\n    - https://msdn.microsoft.com/en-us/library/cc220234.aspx\n    - https://adsecurity.org/?p=3466\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description1: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\n    description2: 'Requirements: Audit Policy : DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes'\ndetection:\n    selection1:\n        EventID: 4738\n    filter1:\n        AllowedToDelegateTo: null\n    selection2:\n        EventID: 5136\n        AttributeLDAPDisplayName: 'msDS-AllowedToDelegateTo'\n    selection3:\n        EventID: 5136\n        ObjectClass: 'user'\n        AttributeLDAPDisplayName: 'servicePrincipalName'\n    condition: (selection1 and not filter1) or selection2 or selection3\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_ad_user_backdoors.yml", "hash": "b7386f367a78cbb92a5d780f65c9c61a30c7a0a86e17b7a0c2f7160ad6cebe4a", "level": "high", "is_verified": false, "downloads": 0}, "nDwdG2YBatiiaHt9diSb": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:14.869243", "author_keyword": "Florian Roth", "user_id": null, "title": "Elise Backdoor", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Elise Backdoor", "released": "2018-09-27T12:58:14.869239", "sigma_text": "title: Elise Backdoor\nstatus: experimental\ndescription: Detects Elise backdoor acitivty as used by APT32 \nreferences: \n    - https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting\ntags:\n    - attack.g0030\n    - attack.g0050\n    - attack.s0081\nauthor: Florian Roth\ndate: 2018/01/31\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image: 'C:\\Windows\\SysWOW64\\cmd.exe'\n        CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\n    selection2:\n        EventID: 1\n        CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: critical\n", "git_filepath": "/apt/apt_elise.yml", "hash": "02b03ffa716d3cce7b8a065fd850a5e8833f0069795a8ba9ead99ec1d07b79ca", "level": "critical", "is_verified": false, "downloads": 0}, "4bMw42IB8Wx35J1-acxd": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:43.516965", "user_id": null, "views": 1, "permission_id": 3, "author": "Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Suspicious PowerShell Invocations - Specific", "released": "2018-04-20T13:13:43.516961", "sigma_text": "title: Suspicious PowerShell Invocations - Specific\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters\nauthor: Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - ' -nop -w hidden -c * [Convert]::FromBase64String'\n        - ' -w hidden -noni -nop -c \"iex(New-Object'\n        - ' -w hidden -ep bypass -Enc'\n        - 'powershell.exe reg add HKCU\\software\\microsoft\\windows\\currentversion\\run'\n        - 'bypass -noprofile -windowstyle hidden (new-object system.net.webclient).download'\n        - 'iex(New-Object Net.WebClient).Download'\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_suspicious_invocation_specific.yml", "title": "sigma: Suspicious PowerShell Invocations - Specific", "author_keyword": "Florian Roth (rule)", "is_verified": true, "downloads": 0, "hash": "9d5a08706320cb20e7368bc08db0b60f04d1cea0ef8b96cfb86e138ffe24a9e3", "level": "high"}, "I7Mx42IB8Wx35J1-Os2s": {"status": "experimental", "category": 12, "updated": "2018-04-20T13:14:37.097876", "user_id": null, "views": 12, "permission_id": 3, "author": "Florian Roth, Tom Ueltschi", "mitre_attack": null, "title_keyword": "sigma: NotPetya Ransomware Activity", "released": "2018-04-20T13:14:37.097872", "sigma_text": "title: NotPetya Ransomware Activity\nstatus: experimental\ndescription: Detects NotPetya ransomware activity in which the extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil. Modified by SOC Prime, replaced condition \"1 of them\" with \"fsutil_clean_journal or pipe_com or event_clean or rundll32_dash1 or perfc_keyword\"\nauthor: Florian Roth, Tom Ueltschi\nreferences:\n    - https://securelist.com/schroedingers-petya/78870/\n    - https://www.hybrid-analysis.com/sample/64b0b58a2c030c77fdb2b537b2fcc4af432bc55ffb36599a31d418c7c69e94b1?environmentId=100\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    fsutil_clean_journal:\n        EventID: 1\n        Image: '*\\fsutil.exe'\n        CommandLine: '* deletejournal *'        \n    pipe_com:\n        EventID: 1\n        CommandLine: '*\\AppData\\Local\\Temp\\* \\\\.\\pipe\\*'\n    event_clean:\n        EventID: 1\n        Image: '*\\wevtutil.exe'\n        CommandLine: '* cl *'\n    rundll32_dash1:\n        EventID: 1\n        Image: '*\\rundll32.exe'\n        CommandLine: '*.dat,#1'       \n    perfc_keyword:\n        - '*\\perfc.dat*'\n    condition: fsutil_clean_journal or pipe_com or event_clean or rundll32_dash1 or perfc_keyword\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Admin activity\nlevel: critical\n", "git_filepath": "/windows/malware/sysmon_malware_notpetya.yml", "title": "sigma: NotPetya Ransomware Activity", "author_keyword": "Florian Roth, Tom Ueltschi", "is_verified": true, "downloads": 2, "hash": "a9406bce69496b5e823ffca83fe5e68a3096d22ac6c1f5d7a19cb6638133076f", "level": "critical"}, "DbMw42IB8Wx35J1-9c2V": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:19.411347", "user_id": null, "views": 7, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Control Panel DLL Load", "released": "2018-04-20T13:14:19.411344", "sigma_text": "title: Suspicious Control Panel DLL Load\nstatus: experimental\ndescription: Detects suspicious Rundll32 execution from control.exe as used by Equation Group and Exploit Kits\nauthor: Florian Roth\ndate: 2017/04/15\nreferences:\n    - https://twitter.com/rikvduijn/status/853251879320662017\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\System32\\control.exe'\n        CommandLine: '*\\rundll32.exe *'\n    filter:\n        CommandLine: '*Shell32.dll*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_control_dll_load.yml", "title": "sigma: Suspicious Control Panel DLL Load", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "c663daa714c776e4f56652af353d10e9855999d53027ca8aab6d5ca8be6a2855", "level": "high"}, "gTxFSWMB_9rlszZ2yM9n": {"status": "testing", "category": "", "updated": "2018-05-10T08:58:20Z", "user_id": "80", "views": 20, "downloads": 1, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: YiSpecter Malware Detection.", "released": "2018-05-10T08:58:20Z", "sigma_text": "title: YiSpecter Malware Detection.\ndescription: YiSpecter Malware C2 Domains And Subdomains Communication Detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences: https://researchcenter.paloaltonetworks.com/2015/10/yispecter-first-ios-malware-attacks-non-jailbroken-ios-devices-by-abusing-private-apis/\ndate: 2015/10/4\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection:\n    r-dns:\n    - bb800.com\n    - ad.bb800.com\n    - down.bb800.com\n    - ty1.bb800.com\n    - iosnoico.bb800.com\n    - qvod.bb800.com\n    - qvios.od.bb800.com\n    - dp.bb800.com\n    - iosads.cdn.bb800.com\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: YiSpecter Malware Detection.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "1fc27b0fdca502c0bead4e8caa22e420c26afc5e2b6232719f0aba5c1c443fcb", "level": "medium"}, "sTwdG2YBatiiaHt9hyTj": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:19.293000", "author_keyword": "Florian Roth", "user_id": null, "title": "SAM Dump to AppData", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "SAM Dump to AppData", "released": "2018-09-27T12:58:19.292997", "sigma_text": "title: SAM Dump to AppData\nstatus: experimental\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers\ntags:\n    - attack.credential_access\n    - attack.t1003\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\n    description: The source of this type of event is Kernel-General\ndetection:\n    selection:\n        EventID: 16\n    keywords:\n        - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\n    condition: all of them\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_sam_dump.yml", "hash": "1b34439e532a7781a2d9667a8897617320a10d7e25961f8060a598c3b67642b0", "level": "high", "is_verified": false, "downloads": 0}, "tTwdG2YBatiiaHt9iiT-": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:20.086274", "author_keyword": "Florian Roth", "user_id": null, "title": "Rare Schtasks Creations", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Rare Schtasks Creations", "released": "2018-09-27T12:58:20.086269", "sigma_text": "title: Rare Schtasks Creations\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\nstatus: experimental\nauthor: Florian Roth\ntags:\n    - attack.execution\n    - attack.privilege_escalation\n    - attack.persistence\n    - attack.t1053\nlogsource:\n    product: windows\n    service: security\n    description: 'The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.'\ndetection:\n    selection:\n        EventID: 4698\n    timeframe: 7d\n    condition: selection | count(TaskName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n", "git_filepath": "/windows/builtin/win_rare_schtasks_creations.yml", "hash": "06ec800ff8fa93fd41e36229860a0200740e4d587198bc533abdba1f6495942c", "level": "low", "is_verified": false, "downloads": 0}, "DrMw42IB8Wx35J1--M3A": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:20.222303", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Taskmgr as LOCAL_SYSTEM", "released": "2018-04-20T13:14:20.222300", "sigma_text": "title: Taskmgr as LOCAL_SYSTEM\nstatus: experimental\ndescription: Detects the creation of taskmgr.exe process in context of LOCAL_SYSTEM\nauthor: Florian Roth\ndate: 2018/03/18\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        User: 'NT AUTHORITY\\SYSTEM'\n        Image: '*\\taskmgr.exe'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_taskmgr_localsystem.yml", "title": "sigma: Taskmgr as LOCAL_SYSTEM", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "6d8c7e9d6f2e460aeae9d81afa6c09647d6b367f401c188b96c48d038d5481ab", "level": "high"}, "cTzqAWMB_9rlszZ2Js_S": {"status": "testing", "category": "", "updated": "2018-04-30T12:33:43Z", "user_id": "80", "views": 59, "downloads": 1, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: OrangeWorm C2 Communication", "released": "2018-04-26T12:25:12Z", "sigma_text": "title: OrangeWorm C2 Communication\ndescription: OrangeWorm C2 Communication detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences: https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\nstatus: testing\nlogsource:\n  product: firewall\ndetection:\n  outgoing:\n    dst:\n    - 65.116.107.24\n    - 13.44.61.126\n    - 56.28.111.63\n    - 118.71.138.69\n    - 117.32.65.101\n    - 18.25.62.70\n    - 92.137.43.17\n    - 33.25.72.21\n    - 16.48.37.37\n    - 91.29.51.11\n  incoming:\n    src:\n    - 65.116.107.24\n    - 13.44.61.126\n    - 56.28.111.63\n    - 118.71.138.69\n    - 117.32.65.101\n    - 18.25.62.70\n    - 92.137.43.17\n    - 33.25.72.21\n    - 16.48.37.37\n    - 91.29.51.11\n  condition: outgoing or incoming\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: OrangeWorm C2 Communication", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "57b8acc5fc7c39f50f272d5489f0eabee806f684717a6c2e5b19fdb5115219ec", "level": "medium"}, "xrMw42IB8Wx35J1-E8z1": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:21.651361", "user_id": null, "views": 9, "permission_id": 3, "author": "juju4", "mitre_attack": null, "title_keyword": "sigma: Admin User Remote Logon", "released": "2018-04-20T13:13:21.651358", "sigma_text": "title: Admin User Remote Logon\ndescription: Detect remote login by Administrator user depending on internal pattern\nreferences:\n  - https://car.mitre.org/wiki/CAR-2016-04-005\nstatus: experimental\nauthor: juju4\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Identifiable administrators usernames (pattern or special unique character. ex: \"Admin-*\"), internal policy mandating use only as secondary account'\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 10\n        AuthenticationPackageName: Negotiate\n        AccountName: 'Admin-*'\n    condition: selection\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n", "git_filepath": "/windows/builtin/win_admin_rdp_login.yml", "title": "sigma: Admin User Remote Logon", "author_keyword": "juju4", "is_verified": true, "downloads": 6, "hash": "fb24388aaa0512de0092d5b0ebc666159f673ed902f8d4a070da9a08466fd579", "level": "low"}, "NrMx42IB8Wx35J1-d814": {"status": "", "category": 2, "updated": "2018-04-20T13:14:52.662879", "user_id": null, "views": 7, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Ps.exe Renamed SysInternals Tool", "released": "2018-04-20T13:14:52.662876", "sigma_text": "title: Ps.exe Renamed SysInternals Tool\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report\nreferences:\n    - https://www.us-cert.gov/ncas/alerts/TA17-293A\nauthor: Florian Roth\ndate: 2017/10/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: 'ps.exe -accepteula'\n    condition: selection\nfalsepositives:\n    - Renamed SysInternals tool\nlevel: high", "git_filepath": "/apt/apt_ta17_293a_ps.yml", "title": "sigma: Ps.exe Renamed SysInternals Tool", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "ee8a68907b16990bf7465a4cfdb70506cc70df2a7a1cb44d4897086a71bbf6dc", "level": "high"}, "O7Mx42IB8Wx35J1-h80Y": {"status": "experimental", "category": 2, "updated": "2018-04-20T13:14:56.662699", "user_id": null, "views": 14, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Elise Backdoor", "released": "2018-04-20T13:14:56.662696", "sigma_text": "title: Elise Backdoor\nstatus: experimental\ndescription: Detects Elise backdoor acitivty as used by APT32. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\nreferences: \n    - https://community.rsa.com/community/products/netwitness/blog/2018/01/30/apt32-continues-asean-targeting\nauthor: Florian Roth\ndate: 2018/01/31\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image: 'C:\\Windows\\SysWOW64\\cmd.exe'\n        CommandLine: '*\\Windows\\Caches\\NavShExt.dll *'\n    selection2:\n        EventID: 1\n        CommandLine: '*\\AppData\\Roaming\\MICROS~1\\Windows\\Caches\\NavShExt.dll,Setting'\n    condition: selection1 or selection2\nfalsepositives:\n    - Unknown\nlevel: critical\n", "git_filepath": "/apt/apt_elise.yml", "title": "sigma: Elise Backdoor", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "a43b817040a454607cecd88179744f034cfa99939d4715e8922f284be12806a1", "level": "critical"}, "67Mw42IB8Wx35J1-icxY": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:51.702639", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Svchost Process", "released": "2018-04-20T13:13:51.702636", "sigma_text": "title: Suspicious Svchost Process\nstatus: experimental\ndescription: Detects a suspicious scvhost process start \nauthor: Florian Roth\ndate: 2017/08/15\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\svchost.exe'\n    filter:\n        ParentImage: '*\\services.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_svchost.yml", "title": "sigma: Suspicious Svchost Process", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "854202d5f2b316e94156097f9ccb0e620873619dd62ecf038081bd5934e2e87a", "level": "high"}, "NLMx42IB8Wx35J1-cc1K": {"status": "", "category": 2, "updated": "2018-04-20T13:14:51.081681", "user_id": null, "views": 15, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Equation Group C2 Communication", "released": "2018-04-20T13:14:51.081678", "sigma_text": "title: Equation Group C2 Communication\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools.  Modified by SOC Prime, replaced condition \"1 of them\" with \"outgoing or incoming\"\nreferences:\n    - 'https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation'\n    - 'https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195'\nauthor: Florian Roth\nlogsource:\n    product: firewall\ndetection:\n    outgoing:\n        dst:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    incoming:\n        src:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    condition: outgoing or incoming\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_equationgroup_c2.yml", "title": "sigma: Equation Group C2 Communication", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 4, "hash": "7e09fd5a886ea90b056d22c9dd58a091982f43941f34575eb399750b87e243fa", "level": "high"}, "prMv42IB8Wx35J1-rswC": {"status": "", "category": 3, "updated": "2018-04-20T13:12:55.550904", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Log Entries", "released": "2018-04-20T13:12:55.550901", "sigma_text": "title: Suspicious Log Entries\ndescription: Detects suspicious log entries in Linux log files\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious log lines\n        - 'entered promiscuous mode'\n        # OSSEC https://github.com/ossec/ossec-hids/blob/master/etc/rules/syslog_rules.xml\n        - 'Deactivating service'\n        - 'Oversized packet received from'  \n        - 'imuxsock begins to drop messages'      \n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_shell_susp_log_entries.yml", "title": "sigma: Suspicious Log Entries", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "197911e27c186b5f5bce3557263e09e6a20d4792a0a8474b650a0bf94ff72ab6", "level": "medium"}, "FbMx42IB8Wx35J1-Ds20": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:25.842542", "user_id": null, "views": 1, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: QuarksPwDump Dump File", "released": "2018-04-20T13:14:25.842539", "sigma_text": "title: QuarksPwDump Dump File\nstatus: experimental\ndescription: Detects a dump file written by QuarksPwDump password dumper\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet/details/QuarksPWDump.htm\nauthor: Florian Roth\ndate: 2018/02/10\nlevel: critical\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        # Sysmon: File Creation (ID 11)\n        EventID: 11\n        TargetFilename: '*\\AppData\\Local\\Temp\\SAM-*.dmp*'\n    condition: selection\nfalsepositives:\n    - Unknown\n", "git_filepath": "/windows/sysmon/sysmon_quarkspw_filedump.yml", "title": "sigma: QuarksPwDump Dump File", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "cb8c6ceb101148f1c983ea3059920e3c4180725c2a633e5992d7ee539c24d16c", "level": "critical"}, "J7Mx42IB8Wx35J1-R81l": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:40.355350", "user_id": null, "views": 8, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Download from Suspicious Dyndns Hosts", "released": "2018-04-20T13:14:40.355346", "sigma_text": "title: Download from Suspicious Dyndns Hosts\nstatus: experimental\ndescription: Detects download of certain file types from hosts with dynamic DNS names (selected list)\nreferences:\n    - https://www.alienvault.com/blogs/security-essentials/dynamic-dns-security-and-potential-threats\nauthor: Florian Roth\ndate: 2017/11/08\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n        r-dns: \n            - '*.hopto.org'\n            - '*.no-ip.org'\n            - '*.no-ip.info'\n            - '*.no-ip.biz'\n            - '*.no-ip.com'\n            - '*.noip.com'\n            - '*.ddns.name'\n            - '*.myftp.org'\n            - '*.myftp.biz'\n            - '*.serveblog.net'\n            - '*.servebeer.com'\n            - '*.servemp3.com'\n            - '*.serveftp.com'\n            - '*.servequake.com'\n            - '*.servehalflife.com'\n            - '*.servehttp.com'\n            - '*.servegame.com'\n            - '*.servepics.com'\n            - '*.myvnc.com'\n            - '*.ignorelist.com'\n            - '*.jkub.com'\n            - '*.dlinkddns.com'\n            - '*.jumpingcrab.com'\n            - '*.ddns.info'\n            - '*.mooo.com'\n            - '*.dns-dns.com'\n            - '*.strangled.net'\n            - '*.ddns.info'\n            - '*.adultdns.net'\n            - '*.craftx.biz'\n            - '*.ddns01.com'\n            - '*.dns53.biz'\n            - '*.dnsapi.info'\n            - '*.dnsd.info'\n            - '*.dnsdynamic.com'\n            - '*.dnsdynamic.net'\n            - '*.dnsget.org'\n            - '*.fe100.net'\n            - '*.flashserv.net'\n            - '*.ftp21.net'\n            - '*.http01.com'\n            - '*.http80.info'\n            - '*.https443.com'\n            - '*.imap01.com'\n            - '*.kadm5.com'\n            - '*.mysq1.net'\n            - '*.ns360.info'\n            - '*.ntdll.net'\n            - '*.ole32.com'\n            - '*.proxy8080.com'\n            - '*.sql01.com'\n            - '*.ssh01.com'\n            - '*.ssh22.net'\n            - '*.tempors.com'\n            - '*.tftpd.net'\n            - '*.ttl60.com'\n            - '*.ttl60.org'\n            - '*.user32.com'\n            - '*.voip01.com'\n            - '*.wow64.net'\n            - '*.x64.me'\n            - '*.xns01.com'\n            - '*.dyndns.org'\n            - '*.dyndns.info'\n            - '*.dyndns.tv'\n            - '*.dyndns-at-home.com'\n            - '*.dnsomatic.com'\n            - '*.zapto.org'\n            - '*.webhop.net'\n            - '*.25u.com'\n            - '*.slyip.net'\n    condition: selection\nfields:\n    - cs-ip\n    - c-uri\nfalsepositives:\n    - Software downloads\nlevel: medium\n", "git_filepath": "/proxy/proxy_download_susp_dyndns.yml", "title": "sigma: Download from Suspicious Dyndns Hosts", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "e4e674fe909020b018905f25dc7fe6bf019671f1f20038d58262603fca06ce9f", "level": "medium"}, "vrMv42IB8Wx35J1--sz1": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:15.251891", "user_id": null, "title": "sigma: WCE wceaux.dll Access", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: WCE wceaux.dll Access", "released": "2018-04-20T13:13:15.251888", "sigma_text": "title: WCE wceaux.dll Access\nstatus: experimental\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\nauthor: Thomas Patzke\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4658\n            - 4660\n            - 4663\n        ObjectName: '*\\wceaux.dll'\n    condition: selection\nfalsepositives: \n    - Penetration testing\nlevel: critical\n", "git_filepath": "/windows/builtin/win_mal_wceaux_dll.yml", "hash": "c8b62639df169e7e88490c300fb94bf82190291269fddbf69d5105c033d9a8fd", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 0, "level": "critical"}, "BbMw42IB8Wx35J1-283u": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:12.844577", "user_id": null, "views": 3, "permission_id": 3, "author": "Dimitrios Slamaris", "mitre_attack": null, "title_keyword": "sigma: DHCP Callout DLL installation", "released": "2018-04-20T13:14:12.844574", "sigma_text": "title: DHCP Callout DLL installation\nstatus: experimental\ndescription: Detects the installation of a Callout DLL via CalloutDlls and CalloutEnabled parameter in Registry, which can be used to execute code in context of the DHCP server (restart required)\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: \n            - '*\\Services\\DHCPServer\\Parameters\\CalloutDlls'\n            - '*\\Services\\DHCPServer\\Parameters\\CalloutEnabled'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_dhcp_calloutdll.yml", "title": "sigma: DHCP Callout DLL installation", "author_keyword": "Dimitrios Slamaris", "is_verified": true, "downloads": 0, "hash": "5917acc25b583d9a831e063ad6f134e45963a5c08925d3671e245d64b6c2fc03", "level": "high"}, "kjwdG2YBatiiaHt9biRU": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:12.749795", "author_keyword": "Florian Roth", "user_id": null, "title": "Oracle WebLogic Exploit", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Oracle WebLogic Exploit", "released": "2018-09-27T12:58:12.749791", "sigma_text": "title: Oracle WebLogic Exploit\ndescription: Detects access to a webshell droped into a keytore folder on the WebLogic server\nauthor: Florian Roth\ndate: 2018/07/22\nstatus: experimental\nreferences: \n    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-2894\n    - https://twitter.com/pyn3rd/status/1020620932967223296\n    - https://github.com/LandGrey/CVE-2018-2894\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        c-uri-path: \n            - '*/config/keystore/*.js*'\n    condition: selection\nfields:\n    - c-ip\n    - c-dns\nfalsepositives:\n    - Unknown\ntags:\n    - attack.t1100\n    - attack.t1190\n    - attack.initial_access\n    - attack.persistence\n    - attack.privilege_escalation\n    - cve.2018-2894\nlevel: critical\n", "git_filepath": "/web/web_cve_2018_2894_weblogic_exploit.yml", "hash": "ca87008e185c0ed29895e99c580bf251a8420d70fb77f9d472e40800edab2bb9", "level": "critical", "is_verified": false, "downloads": 0}, "gDw-SWMB_9rlszZ2cc8i": {"status": "testing", "category": "", "updated": "2018-05-10T08:50:19Z", "user_id": "80", "views": 21, "downloads": 0, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: DualToy Trojan Detection.", "released": "2018-05-10T08:50:19Z", "sigma_text": "title: DualToy Trojan Detection.\ndescription: DualToy Trojan C2 Domains Communication Detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences: https://researchcenter.paloaltonetworks.com/2016/09/dualtoy-new-windows-trojan-sideloads-risky-apps-to-android-and-ios-devices/\ndate: 2016/09/13\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection:\n    r-dns:\n    - www.zaccl.com\n    - pack.1e5.com\n    - rsys.topfreeweb.net\n    - abc.yuedea.com\n    - report.boxlist.info\n    - tt.51wanyx.net\n    - hk.pk2012.info\n    - center.oldlist.info\n    - up.top258.cn\n    - dl.dswzd.com\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: DualToy Trojan Detection.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "a576c7f91e3209ff1e695864a2edb9010cd018bf6314c033359de4967078d51a", "level": "medium"}, "6LMw42IB8Wx35J1-f8z8": {"status": "", "category": 15, "updated": "2018-04-20T13:13:49.306407", "user_id": null, "title": "sigma: Suspicious Driver Load from Temp", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Driver Load from Temp", "released": "2018-04-20T13:13:49.306403", "sigma_text": "title: Suspicious Driver Load from Temp\ndescription: Detetcs a driver load from a temporary directory\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 6\n        ImageLoaded: '*\\Temp\\*'\n    condition: selection\nfalsepositives:\n    - there is a relevant set of false positives depending on applications in the envirnment \nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_driver_load.yml", "hash": "84530c5a576964c31029283042c3955d750f6ca3e1e1254598d0e60e1c0bf651", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "medium"}, "NbMx42IB8Wx35J1-dM1l": {"status": "experimental", "category": 2, "updated": "2018-04-20T13:14:51.872196", "user_id": null, "views": 13, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Pandemic Registry Key", "released": "2018-04-20T13:14:51.872193", "sigma_text": "title: Pandemic Registry Key\nstatus: experimental\ndescription: Detects Pandemic Windows Implant. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\nreferences:\n    - https://wikileaks.org/vault7/#Pandemic\n    - https://twitter.com/MalwareJake/status/870349480356454401\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 13\n        TargetObject: \n            - '\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet002\\services\\null\\Instance*'\n    selection2:\n        EventID: 1\n        Command: 'loaddll -a *'\n    condition: selection1 or selection2\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: critical\n", "git_filepath": "/apt/apt_pandemic.yml", "title": "sigma: Pandemic Registry Key", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "b7879df720c9b416858ecd239e5228df7331e1aa7a4c94cf3a86d382db5c737b", "level": "critical"}, "5bMw42IB8Wx35J1-dsyR": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:46.895361", "user_id": null, "views": 8, "permission_id": 3, "author": "Florian Roth (rule), Lee Holmes (idea)", "mitre_attack": null, "title_keyword": "sigma: PowerShell Downgrade Attack", "released": "2018-04-20T13:13:46.895358", "sigma_text": "title: PowerShell Downgrade Attack\nstatus: experimental\ndescription: Detects PowerShell downgrade attack by comparing the host versions with the actually used engine version 2.0\nreferences:\n    - http://www.leeholmes.com/blog/2017/03/17/detecting-and-preventing-powershell-downgrade-attacks/\nauthor: Florian Roth (rule), Lee Holmes (idea)\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection:\n        EventID: 400\n        EngineVersion: '2.*'\n    filter:\n        HostVersion: '2.*' \n    condition: selection and not filter\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: medium\n", "git_filepath": "/windows/powershell/powershell_downgrade_attack.yml", "title": "sigma: PowerShell Downgrade Attack", "author_keyword": "Florian Roth (rule), Lee Holmes (idea)", "is_verified": true, "downloads": 0, "hash": "48a4a6a83c6d429f248be0e740804d2181cb8d4fe3c508ceaa1bced2c847ebc3", "level": "medium"}, "sDwdG2YBatiiaHt9hyQR": {"status": "", "category": null, "updated": "2018-09-27T12:58:19.082671", "author_keyword": "Florian Roth", "user_id": null, "title": "Interactive Logon to Server Systems", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Interactive Logon to Server Systems", "released": "2018-09-27T12:58:19.082667", "sigma_text": "title: Interactive Logon to Server Systems\ndescription: Detects interactive console logons to \nauthor: Florian Roth\ntags:\n    - attack.lateral_movement\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 528\n            - 529\n            - 4624\n            - 4625\n        LogonType: 2\n        ComputerName:\n            - '%ServerSystems%'\n            - '%DomainControllers%'\n    filter:\n        LogonProcessName: Advapi\n        ComputerName: '%Workstations%'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative activity via KVM or ILO board\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_interactive_logons.yml", "hash": "da71c630a2b0384fe360f55e2624e6f8df3ca3a771cfcf671b7c4a25eb66b605", "level": "medium", "is_verified": false, "downloads": 0}, "PrMx42IB8Wx35J1-kM1m": {"status": "", "category": 2, "updated": "2018-04-20T13:14:59.045071", "user_id": null, "views": 96, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: WMIExec VBS Script", "released": "2018-04-20T13:14:59.045068", "sigma_text": "title: WMIExec VBS Script\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Florian Roth\nreferences:\n    - https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\cscript.exe'\n        CommandLine: '*.vbs /shell *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/apt/apt_cloudhopper.yml", "title": "sigma: WMIExec VBS Script", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 13, "hash": "804163dcdced65036bd7b801bb1cdebfbd3dbeb847b07e59d017ccd3fb3a1ae6", "level": "critical"}, "fTwdG2YBatiiaHt9XSRe": {"status": "", "category": null, "updated": "2018-09-27T12:58:08.407850", "author_keyword": null, "user_id": null, "title": "Multiple Modsecurity Blocks", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Multiple Modsecurity Blocks", "released": "2018-09-27T12:58:08.407847", "sigma_text": "title: Multiple Modsecurity Blocks\ndescription: Detects multiple blocks by the mod_security module (Web Application Firewall) \nlogsource:\n    product: linux\n    service: modsecurity\ndetection:\n    selection:\n        - 'mod_security: Access denied'\n        - 'ModSecurity: Access denied'\n        - 'mod_security-message: Access denied'\n    timeframe: 120m \n    condition: selection | count() > 6\nfalsepositives:\n    - Vulnerability scanners\n    - Frequent attacks if system faces Internet\nlevel: medium\n", "git_filepath": "/linux/modsecurity/modsec_mulitple_blocks.yml", "hash": "c5cf7aabef064bce0c70368a8755b1b63ae4ca5949a718b08f423d494f38b4ce", "level": "medium", "is_verified": false, "downloads": 0}, "BLMw42IB8Wx35J1-2M3G": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:12.036682", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth, juju4", "mitre_attack": null, "title_keyword": "sigma: Suspicious Certutil Command", "released": "2018-04-20T13:14:12.036679", "sigma_text": "title: Suspicious Certutil Command\nstatus: experimental\ndescription: Detetcs a suspicious Microsoft certutil execution with sub commands like 'decode' sub command, which is sometimes used to decode malicious code with the built-in certutil utility\nauthor:\n    - Florian Roth, juju4\nreferences:\n    - https://twitter.com/JohnLaTwC/status/835149808817991680\n    - https://twitter.com/subTee/status/888102593838362624\n    - https://twitter.com/subTee/status/888071631528235010\n    - https://blogs.technet.microsoft.com/pki/2006/11/30/basic-crl-checking-with-certutil/\n    - https://www.trustedsec.com/2017/07/new-tool-release-nps_payload/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: \n            - '*\\certutil.exe * -decode *'\n            - '*\\certutil.exe * -decodehex *'\n            - '*\\certutil.exe *-urlcache* http*'\n            - '*\\certutil.exe *-urlcache* ftp*'\n            - '*\\certutil.exe *-URL*'\n            - '*\\certutil.exe *-ping*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - False positives depend on scripts and administrative tools used in the monitored environment\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_certutil_command.yml", "title": "sigma: Suspicious Certutil Command", "author_keyword": "Florian Roth, juju4", "is_verified": true, "downloads": 0, "hash": "2be7d5028e869ea506fa2436ff5351f942bcc16294bb5d149daa62ac9798acca", "level": "high"}, "9rMw42IB8Wx35J1-q8zQ": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:00.527079", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Execution in Webserver Root Folder", "released": "2018-04-20T13:14:00.527076", "sigma_text": "title: Execution in Webserver Root Folder\nstatus: experimental\ndescription: Detects a suspicious program execution in a web service root folder (filter out false positives)\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: \n            - '*\\wwwroot\\*'\n            - '*\\wmpub\\*'\n            - '*\\htdocs\\*'          \n    filter:\n        Image: \n            - '*bin\\*'\n            - '*\\Tools\\*'\n            - '*\\SMSComponent\\*'\n        ParentImage:\n            - '*\\services.exe'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Various applications\n    - Tools that include ping or nslookup command invocations\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_execution_path_webserver.yml", "title": "sigma: Execution in Webserver Root Folder", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "3cab2c2fe19eb3dcd79c3e3b128c7e6853678254324f7a0f9f59dd1a1adf4872", "level": "medium"}, "ybMw42IB8Wx35J1-HcyN": {"status": "", "category": 11, "updated": "2018-04-20T13:13:24.107807", "user_id": null, "title": "sigma: Multiple Failed Logins with Different Accounts from Single Source System", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Multiple Failed Logins with Different Accounts from Single Source System", "released": "2018-04-20T13:13:24.107804", "sigma_text": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection1:\n        EventID:\n            - 529\n            - 4625\n        UserName: not null\n        WorkstationName: not null\n    selection2:\n        EventID: 4776\n        UserName: not null\n        Workstation: not null\n    timeframe: 24h \n    condition:\n        - selection1 | count(UserName) by WorkstationName > 3\n        - selection2 | count(UserName) by Workstation > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Other multiuser systems like Citrix server farms\n    - Workstations with frequently changing users \nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_failed_logons_single_source.yml", "hash": "ccf3b409d554838e1ce5402f86d291e562f7254fdde5f533a801c98e15749721", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "medium"}, "CLMw42IB8Wx35J1-5c1d": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:15.233198", "user_id": null, "views": 3, "permission_id": 3, "author": "Michael Haag, Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious WMI execution", "released": "2018-04-20T13:14:15.233195", "sigma_text": "title: Suspicious WMI execution\nstatus: experimental\ndescription: Detects WMI executing suspicious commands\nreferences:\n    - https://digital-forensics.sans.org/blog/2010/06/04/wmic-draft/\n    - https://www.hybrid-analysis.com/sample/4be06ecd234e2110bd615649fe4a6fa95403979acf889d7e45a78985eb50acf9?environmentId=1\n    - https://blog.malwarebytes.com/threat-analysis/2016/04/rokku-ransomware/\nauthor: Michael Haag, Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - '*/NODE:*process call create *'\n            - '* path AntiVirusProduct get *'\n            - '* path FirewallProduct get *'\n            - '* shadowcopy delete *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned\n    - If using Splunk, I recommend | stats count by Computer,CommandLine following for easy hunting by Computer/CommandLine.\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_wmi_execution.yml", "title": "sigma: Suspicious WMI execution", "author_keyword": "Michael Haag, Florian Roth", "is_verified": true, "downloads": 0, "hash": "d400b0e07442789296d60577555634945ae56afddcaf5aaacdf049607024f198", "level": "medium"}, "1bMw42IB8Wx35J1-RMwF": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:33.955184", "user_id": null, "views": 1, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Microsoft Malware Protection Engine Crash", "released": "2018-04-20T13:13:33.955181", "sigma_text": "title: Microsoft Malware Protection Engine Crash\ndescription: This rule detects a suspicious crash of the Microsoft Malware Protection Engine. Modified by SOC Prime, replaced condition \"1 of selection* and all of keywords\" with \"(selection1 or selection2) and keywords\"\nstatus: experimental\ndate: 2017/05/09\nreferences:\n    - https://bugs.chromium.org/p/project-zero/issues/detail?id=1252&desc=5\n    - https://technet.microsoft.com/en-us/library/security/4022344\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection1:\n        Source: 'Application Error'\n        EventID: 1000 \n    selection2:\n        Source: 'Windows Error Reporting'\n        EventID: 1001\n    keywords:\n        - 'MsMpEng.exe'\n        - 'mpengine.dll'\n    condition: (selection1 or selection2) and keywords\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_msmpeng_crash.yml", "title": "sigma: Microsoft Malware Protection Engine Crash", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "862e6c06c0ac99a50b90dea146ac81a3dbf2ec52b12da213f6f12779b3852c0c", "level": "high"}, "0rMw42IB8Wx35J1-OsxS": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:31.472029", "user_id": null, "views": "2", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Suspicious Kerberos RC4 Ticket Encryption", "released": "2018-04-20T13:13:31.472026", "sigma_text": "title: Suspicious Kerberos RC4 Ticket Encryption\nstatus: experimental\nreferences:\n    - https://adsecurity.org/?p=3458\n    - https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\ndescription: Detects service ticket requests using RC4 encryption type\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769\n        TicketOptions: '0x40810000'\n        TicketEncryptionType: '0x17'\n    reduction:\n        - ServiceName: '$*'\n    condition: selection and not reduction\nfalsepositives:\n    - Service accounts used on legacy systems (e.g. NetApp)\n    - Windows Domains with DFL 2003 and legacy systems\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_rc4_kerberos.yml", "title": "sigma: Suspicious Kerberos RC4 Ticket Encryption", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "4e27efbae027c5a28236feb1a3a523b405e5d597de17ca41c8bfec8844224ad9", "level": "medium"}, "jTwdG2YBatiiaHt9aiR2": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:11.759700", "author_keyword": "Markus Neis", "user_id": null, "title": "DNS TXT Answer with possible execution strings", "permission_id": 3, "author": "Markus Neis", "mitre_attack": null, "title_keyword": "DNS TXT Answer with possible execution strings", "released": "2018-09-27T12:58:11.759697", "sigma_text": "title: DNS TXT Answer with possible execution strings    \nstatus: experimental\ndescription: Detects strings used in command execution in DNS TXT Answer \nreferences:\n    - https://twitter.com/stvemillertime/status/1024707932447854592\n    - https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1\ntags:\n    - attack.t1071\nauthor: Markus Neis\ndate: 2018/08/08\nlogsource:\n    category: dns\ndetection:\n    selection:\n        answer:\n            - '*IEX*'\n            - '*Invoke-Expression*'\n            - '*cmd.exe*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/network/net_susp_dns_txt_exec_strings.yml", "hash": "afb603ee20d60788d5b0f7eec68201f9c71e7ce6258125f93c9eb3dcefee5423", "level": "high", "is_verified": false, "downloads": 0}, "7rMw42IB8Wx35J1-ksyr": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:54.089402", "user_id": null, "views": 3, "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Mimikatz Detection LSASS Access", "released": "2018-04-20T13:13:54.089399", "sigma_text": "title: Mimikatz Detection LSASS Access\nstatus: experimental\ndescription: Detects process access to LSASS which is typical for Mimikatz (0x1000 PROCESS_QUERY_ LIMITED_INFORMATION, 0x0400 PROCESS_QUERY_ INFORMATION, 0x0010 PROCESS_VM_READ)\nreferences:\n    - https://onedrive.live.com/view.aspx?resid=D026B4699190F1E6!2843&ithint=file%2cpptx&app=PowerPoint&authkey=!AMvCRTKB_V1J5ow\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: 'C:\\windows\\system32\\lsass.exe'\n        GrantedAccess: '0x1410'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_mimikatz_detection_lsass.yml", "title": "sigma: Mimikatz Detection LSASS Access", "author_keyword": null, "is_verified": false, "downloads": 0, "hash": "448d994c5bd9d17724949ed0df3c1d3c5f6c35f59e68c9e8e2e9fb2c9e668c9c", "level": "high"}, "5LMw42IB8Wx35J1-c8xy": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:46.094702", "user_id": null, "title": "sigma: PowerShell called from an Executable Version Mismatch", "permission_id": 3, "author": "Sean Metcalf (source), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: PowerShell called from an Executable Version Mismatch", "released": "2018-04-20T13:13:46.094699", "sigma_text": "title: PowerShell called from an Executable Version Mismatch\nstatus: experimental\ndescription: Detects PowerShell called from an executable by the version mismatch method\nreferences:\n    - https://adsecurity.org/?p=2921\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell-classic\ndetection:\n    selection1:\n        EventID: 400\n        EngineVersion: \n            - '2.*'\n            - '4.*'\n            - '5.*'\n        HostVersion: '3.*'\n    condition: selection1\nfalsepositives:\n    - Penetration Tests\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_exe_calling_ps.yml", "hash": "d5f7b79a714022b5cd7dbe4e171340530957f873b704915e73e11c11f9904f69", "author_keyword": "Sean Metcalf (source), Florian Roth (rule)", "is_verified": false, "downloads": 0, "level": "high"}, "lDwdG2YBatiiaHt9byT-": {"status": "", "category": null, "updated": "2018-09-27T12:58:13.176046", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Django framework exceptions", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Django framework exceptions", "released": "2018-09-27T12:58:13.176043", "sigma_text": "title: Django framework exceptions\ndescription: Detects suspicious Django web application framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.djangoproject.com/en/1.11/ref/exceptions/\n    - https://docs.djangoproject.com/en/1.11/topics/logging/#django-security\nlogsource:\n    category: application\n    product: django\ndetection:\n    keywords:\n        - SuspiciousOperation\n        # Subclasses of SuspiciousOperation\n        - DisallowedHost\n        - DisallowedModelAdminLookup\n        - DisallowedModelAdminToField\n        - DisallowedRedirect\n        - InvalidSessionKey\n        - RequestDataTooBig\n        - SuspiciousFileOperation\n        - SuspiciousMultipartForm\n        - SuspiciousSession\n        - TooManyFieldsSent\n        # Further security-related exceptions\n        - PermissionDenied\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_django_exceptions.yml", "hash": "b63d176cddd09eba823355eb2ee8dbdebe25492b29f9c0ccceab31527a93d0c4", "level": "medium", "is_verified": false, "downloads": 0}, "MgLA82MBqfpvXJhTtg1h": {"status": "testing", "category": "", "updated": "2018-06-12T11:35:00Z", "user_id": "80", "views": 24, "downloads": 0, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: InvisiMole SpyWare Detector.", "released": "2018-06-12T11:28:03Z", "sigma_text": "title: InvisiMole SpyWare Detector.\ndescription: InvisiMole SpyWare Detector.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n- https://github.com/eset/malware-ioc/tree/master/invisimole\ndate: 2018/06/07\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    file_hash:\n    - 5EE6E0410052029EAFA10D1669AE3AA04B508BF9\n    - 2FCC87AB226F4A1CC713B13A12421468C82CD586\n    - B6BA65A48FFEB800C29822265190B8EAEA3935B1\n    - C8C4B6BCB4B583BA69663EC3AED8E1E01F310F9F\n    - A5A20BC333F22FD89C34A532680173CBCD287FF8\n  selection_registry1:\n    EventID: \"13\"\n    TargetObject:\n    - HKEY_CURRENT_USER\\Software\\Microsoft\\IE\\Cache\n    keywords:\n    - Index\n  selection_registry2:\n    EventID: \"13\"\n    TargetObject:\n    - HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Console\n    - HKEY_CURRENT_USER\\Software\\Microsoft\\Direct3D\n    keywords:\n    - Settings\n    - Type\n  selection_registry3:\n    EventID: \"13\"\n    TargetObject:\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\OLE\n    - HKEY_CURRENT_USER\\Software\\Microsoft\\Direct3D\n    keywords:\n    - Common\n    - Current\n    - ENC\n    - FFLT\n    - Flag1\n    - FlagLF\n    - FlagLF2\n    - IfData\n    - INFO\n    - InstallA\n    - InstallB\n    - LegacyImpersonationNumber\n    - LM\n    - MachineAccessStateData\n    - MachineState*\n    - RPT\n    - SP2\n    - SP3\n    - SettingsMC\n    - SettingsSR1\n    - SettingsSR2\n    EventType: SetValue\n  condition: selection or selection_registry1 or selection_registry2 or selection_registry3\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Defense Evasion:\n  - Modify Registry\n  Execution:\n  - User Execution", "title": "sigma: InvisiMole SpyWare Detector.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "4b8f07ca577f6e40f43676ba4a1ace9b503476549e28d79e2a763948f4eef72b", "level": "high"}, "gDwdG2YBatiiaHt9XyTg": {"status": "", "category": null, "updated": "2018-09-27T12:58:09.050586", "author_keyword": null, "user_id": null, "title": "Relevant ClamAV Message", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Relevant ClamAV Message", "released": "2018-09-27T12:58:09.050583", "sigma_text": "title: Relevant ClamAV Message\ndescription: Detects relevant ClamAV messages\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml\nlogsource:\n    product: linux\n    service: clamav\ndetection:\n    keywords:\n        - 'Trojan*FOUND'\n        - 'VirTool*FOUND'\n        - 'Webshell*FOUND'\n        - 'Rootkit*FOUND'\n        - 'Htran*FOUND'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_clamav.yml", "hash": "7225a68b5e89ab9e53df07628b078cede7cad3330c8881aa15dbf841bf4d6103", "level": "high", "is_verified": false, "downloads": 0}, "37Mw42IB8Wx35J1-Y8wM": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:41.898135", "user_id": null, "views": 9, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious PowerShell Download", "released": "2018-04-20T13:13:41.898132", "sigma_text": "title: Suspicious PowerShell Download\nstatus: experimental\ndescription: Detects suspicious PowerShell download command\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    keywords:\n        - 'System.Net.WebClient).DownloadString('\n        - 'system.net.webclient).downloadfile('\n    condition: keywords\nfalsepositives:\n    - PowerShell scripts that download content from the Internet\nlevel: medium\n", "git_filepath": "/windows/powershell/powershell_suspicious_download.yml", "title": "sigma: Suspicious PowerShell Download", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "e0dcc7e1dff72061c02b545ed6d525ae9d3cb7e2b9c4baf954aaa6baf55d2a30", "level": "medium"}, "2bMw42IB8Wx35J1-UMx4": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:37.142545", "user_id": null, "views": "2", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: SAM Dump to AppData", "released": "2018-04-20T13:13:37.142542", "sigma_text": "title: SAM Dump to AppData\nstatus: experimental\ndescription: Detects suspicious SAM dump activity as cause by QuarksPwDump and other password dumpers. Modified by SOC Prime, replaced condition \"all of them\" with \"selection and keywords\"\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\n    description: The source of this type of event is Kernel-General\ndetection:\n    selection:\n        EventID: 16\n    keywords:\n        - '*\\AppData\\Local\\Temp\\SAM-*.dmp *'\n    condition: selection and keywords\nfalsepositives: \n    - Penetration testing\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_sam_dump.yml", "title": "sigma: SAM Dump to AppData", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "7a275e688353635fbb599d9dca705ff53fd8c05ac58c1b28d7a2258352bc3695", "level": "high"}, "kDwdG2YBatiiaHt9bCS5": {"status": "", "category": null, "updated": "2018-09-27T12:58:12.338340", "author_keyword": "Florian Roth", "user_id": null, "title": "Webshell Detection by Keyword", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Webshell Detection by Keyword", "released": "2018-09-27T12:58:12.338338", "sigma_text": "title: Webshell Detection by Keyword\ndescription: Detects webshells that use GET requests by keyword searches in URL strings\nauthor: Florian Roth\nlogsource:\n    category: webserver\ndetection:\n    keywords:\n        - '=whoami'\n        - '=net%20user'\n        - '=cmd%20/c%20'\n    condition: keywords\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Web sites like wikis with articles on os commands and pages that include the os commands in the URLs\n    - User searches in search boxes of the respective website\nlevel: high\n", "git_filepath": "/web/web_webshell_keyword.yml", "hash": "55d30e3d96c837cfc3d2c41cc0d7c23a35900a598b2f65f26cd83481c51f3414", "level": "high", "is_verified": false, "downloads": 0}, "wrMw42IB8Wx35J1-B8yF": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:18.468130", "user_id": null, "views": 1, "permission_id": 3, "author": "Roberto Rodriguez (source), Dominik Schaudel (rule)", "mitre_attack": null, "title_keyword": "sigma: Successful Overpass the Hash Attempt", "released": "2018-04-20T13:13:18.468127", "sigma_text": "title: Successful Overpass the Hash Attempt\nstatus: experimental\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\nreferences: \n    - https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\nauthor: Roberto Rodriguez (source), Dominik Schaudel (rule)\ndate: 2018/02/12\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 9\n        LogonProcessName: seclogo\n        AuthenticationPackageName: Negotiate\n    condition: selection\nfalsepositives:\n    - Runas command-line tool using /netonly parameter\nlevel: high", "git_filepath": "/windows/builtin/win_overpass_the_hash.yml", "title": "sigma: Successful Overpass the Hash Attempt", "author_keyword": "Roberto Rodriguez (source), Dominik Schaudel (rule)", "is_verified": false, "downloads": 0, "hash": "8668833624867396fe3d93bf0c7206dc57c65f89693c1b728b4434dae86afbde", "level": "high"}, "B7Mw42IB8Wx35J1-4s0q": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:14.440821", "user_id": null, "views": "1", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: WMI Persistence - Command Line Event Consumer", "released": "2018-04-20T13:14:14.440818", "sigma_text": "title: WMI Persistence - Command Line Event Consumer\nstatus: experimental\ndescription: Detects WMI command line event consumers\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\wbem\\WmiPrvSE.exe'\n        ImageLoaded: 'wbemcons.dll'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_wmi_persistence_commandline_event_consumer.yml", "title": "sigma: WMI Persistence - Command Line Event Consumer", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 0, "hash": "8fab428e0fabf7b5c4439bbfa14ceac551386dd2a8cfd2a776a075a5cf455805", "level": "high"}, "o7Mv42IB8Wx35J1-pMyU": {"status": "", "category": 3, "updated": "2018-04-20T13:12:53.137850", "user_id": null, "views": "1", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Shellshock Expression", "released": "2018-04-20T13:12:53.137847", "sigma_text": "title: Shellshock Expression\ndescription: Detects shellshock expressions in log files\nreferences:\n    - http://rubular.com/r/zxBfjWfFYs\nlogsource:\n    product: linux\ndetection:\n    expression:\n        - /\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/\n    condition: expression\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_shellshock.yml", "title": "sigma: Shellshock Expression", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "c5635163777ca02f1c3ebf0f4dd838ed6bbd9993a7fb21223705d06f48ac7527", "level": "high"}, "ErMx42IB8Wx35J1-Bc1M": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:23.434316", "user_id": null, "title": "sigma: Suspicious TSCON Start", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious TSCON Start", "released": "2018-04-20T13:14:23.434313", "sigma_text": "title: Suspicious TSCON Start\nstatus: experimental\ndescription: Detects a tscon.exe start as LOCAL SYSTEM \nreference: \n    - http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html\n    - https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6\nauthor: Florian Roth\ndate: 2018/03/17\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        User: 'NT AUTHORITY\\SYSTEM'\n        Image: '*\\tscon.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_tscon_localsystem.yml", "hash": "a71bbdd96405a5007f15550cbf65bcd584896858229a742b85a32d7397c590ef", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "high"}, "dDwFB2MB_9rlszZ2Y88r": {"status": "testing", "category": "", "updated": "2018-04-27T12:16:56Z", "user_id": "8", "views": 14, "downloads": 0, "author": "Ruslan Mikhalov", "mitre_attack": "", "title_keyword": "sigma: klist purge", "released": "2018-04-27T12:13:03Z", "sigma_text": "title: klist purge\ndescription: Delete Evidence of Pass-the-Ticket attack\nauthor: Ruslan Mikhalov\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  sysmon_klistpurge:\n    EventID: \"1\"\n    CommandLine: klist*purge\n  condition: sysmon_klistpurge\nfields:\n- EventID\n- CommandLine\nfalsepositives:\n- Administrative activity\nlevel: high\nmitre-attack:\n  Defense Evasion:\n  - Indicator Removal on Host\nreference:\n- https://attack.mitre.org/wiki/Technique/T1097\n- \"\"", "title": "sigma: klist purge", "author_keyword": "Ruslan Mikhalov", "is_verified": true, "permission_id": 3, "hash": "af5803f92375fb9bec0d3bbab1c61b6261c3a29ee7b05e65a3c9eec6be0ba4ed", "level": "high"}, "iTwdG2YBatiiaHt9ZyQh": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:10.907076", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious Named Error", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious Named Error", "released": "2018-09-27T12:58:10.907072", "sigma_text": "title: Suspicious Named Error\nstatus: experimental\ndescription: Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml\nauthor: Florian Roth\ndate: 2018/02/20\nlogsource:\n    product: linux\n    service: syslog\ndetection:\n    keywords:\n        - '* dropping source port zero packet from *'\n        - '* denied AXFR from *'\n        - '* exiting (due to fatal error)*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_susp_named.yml", "hash": "849def7473a8730ca7ed269763487c24babf2f8dbc0ce4ba5dc88105d7163dad", "level": "high", "is_verified": false, "downloads": 0}, "77Mw42IB8Wx35J1-lczD": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:54.879239", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Regsvr32 Anomaly", "released": "2018-04-20T13:13:54.879236", "sigma_text": "title: Regsvr32 Anomaly\nstatus: experimental\ndescription: Detects various anomalies in relation to regsvr32.exe. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2 or selection3 or selection4 or selection5\"\nauthor: Florian Roth\nreferences:\n    - https://subt0x10.blogspot.de/2017/04/bypass-application-whitelisting-script.html\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # Loads from Temp folder\n    selection1:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        CommandLine: '*\\Temp\\*'\n    # Loaded by powershell\n    selection2:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        ParentImage: '*\\powershell.exe'\n    # Regsvr32.exe used with http(s) address\n    selection3:\n        EventID: 1\n        Image: '*\\regsvr32.exe'\n        CommandLine: \n            - '*/i:http* scrobj.dll'\n            - '*/i:ftp* scrobj.dll'\n    # Regsvr32.exe spawned wscript.exe process - indicator of COM scriptlet\n    # https://www.hybrid-analysis.com/sample/f34da6d84a9663928606894fbc494cd9bf2f03c98cf0c775462802558d3a50ef?environmentId=100\n    selection4:\n        EventID: 1\n        Image: '*\\wscript.exe'\n        ParentImage: '*\\regsvr32.exe'\n    # https://twitter.com/danielhbohannon/status/974321840385531904\n    selection5:\n        EventID: 1\n        Image: '*\\EXCEL.EXE'\n        CommandLine: '*..\\..\\..\\Windows\\System32\\regsvr32.exe *'\n    condition: selection1 or selection2 or selection3 or selection4 or selection5\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_regsvr32_anomalies.yml", "title": "sigma: Regsvr32 Anomaly", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "b5f959c69a463475a161a34432eb3721b147a7298d8d5cf3cd15a9bf50cef5ba", "level": "high"}, "rbMv42IB8Wx35J1-xMx0": {"status": "", "category": 1, "updated": "2018-04-20T13:13:01.298042", "user_id": null, "views": "3", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Spring framework exceptions", "released": "2018-04-20T13:13:01.298039", "sigma_text": "title: Spring framework exceptions\ndescription: Detects suspicious Spring framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html\nlogsource:\n    category: application\n    product: spring\ndetection:\n    keywords:\n        - AccessDeniedException\n        - CsrfException\n        - InvalidCsrfTokenException\n        - MissingCsrfTokenException\n        - CookieTheftException\n        - InvalidCookieException\n        - RequestRejectedException\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_spring_exceptions.yml", "title": "sigma: Spring framework exceptions", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "19d5740e125674961f46163228bfc8c942ea9e6280f3975adc8459c7406284ce", "level": "medium"}, "LbMx42IB8Wx35J1-W82L": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:45.514165", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Windows PowerShell WebDav User Agent", "released": "2018-04-20T13:14:45.514162", "sigma_text": "title: Windows PowerShell WebDav User Agent\nstatus: experimental\ndescription: Detects Windows PowerShell Web Access\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 2018/04/06\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent: 'Microsoft-WebDAV-MiniRedir/*'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Administrative scripts that download files from the Internet\n    - Administrative scripts that retrieve certain website contents\nlevel: high\n", "git_filepath": "/proxy/proxy_powershell_download_webdav.yml", "title": "sigma: Windows PowerShell WebDav User Agent", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 2, "hash": "ee3023f96e4d829ff6f92aaed269623647ec271cf0ec5990909bd8a1bb2295f2", "level": "high"}, "mjwdG2YBatiiaHt9dCTm": {"status": "", "category": null, "updated": "2018-09-27T12:58:14.431405", "author_keyword": "Florian Roth", "user_id": null, "title": "Ps.exe Renamed SysInternals Tool", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Ps.exe Renamed SysInternals Tool", "released": "2018-09-27T12:58:14.431401", "sigma_text": "title: Ps.exe Renamed SysInternals Tool\ndescription: Detects renamed SysInternals tool execution with a binary named ps.exe as used by Dragonfly APT group and documentied in TA17-293A report\nreferences:\n    - https://www.us-cert.gov/ncas/alerts/TA17-293A\ntags:\n    - attack.defense_evasion\n    - attack.g0035\n    - attack.t1036\nauthor: Florian Roth\ndate: 2017/10/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: 'ps.exe -accepteula'\n    condition: selection\nfalsepositives:\n    - Renamed SysInternals tool\nlevel: high", "git_filepath": "/apt/apt_ta17_293a_ps.yml", "hash": "490aa039afb3ea27bfeb3a0520507d5311bcbc3fea9afa525636d2c1278014e5", "level": "high", "is_verified": false, "downloads": 0}, "0bMw42IB8Wx35J1-N8w5": {"status": "", "category": 11, "updated": "2018-04-20T13:13:30.679088", "user_id": null, "views": "4", "permission_id": 3, "author": "Omer Faruk Celik", "mitre_attack": null, "title_keyword": "sigma: smbexec.py Service Installation", "released": "2018-04-20T13:13:30.679085", "sigma_text": "title: smbexec.py Service Installation\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\nauthor: Omer Faruk Celik\ndate: 2018/03/20\nreferences:\n    - https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\nlogsource:\n    product: windows\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'BTOBTO'\n        ServiceFileName: '*\\execute.bat'\n    condition: service_installation\nfields:\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: critical", "git_filepath": "/windows/builtin/win_hack_smbexec.yml", "title": "sigma: smbexec.py Service Installation", "author_keyword": "Omer Faruk Celik", "is_verified": true, "downloads": 0, "hash": "8b888a138a3645a6b50034a32d428befd0764a3851ce780acebc080c0d72ec71", "level": "critical"}, "njwdG2YBatiiaHt9dyTf": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:15.193274", "author_keyword": "Markus Neis", "user_id": null, "title": "Turla Group Named Pipes", "permission_id": 3, "author": "Markus Neis", "mitre_attack": null, "title_keyword": "Turla Group Named Pipes", "released": "2018-09-27T12:58:15.193271", "sigma_text": "title: Turla Group Named Pipes \nstatus: experimental\ndescription: Detects a named pipe used by Turla group samples\nreferences:\n    - Internal Research\ndate: 2017/11/06\ntags:\n    - attack.g0010\nauthor: Markus Neis\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n    selection:\n        EventID: \n            - 17\n            - 18\n        PipeName: \n            - '\\atctl' # https://www.virustotal.com/#/file/a4ddb2664a6c87a1d3c5da5a5a32a5df9a0b0c8f2e951811bd1ec1d44d42ccf1/detection\n            - '\\userpipe' # ruag apt case\n            - '\\iehelper' # ruag apt case\n            - '\\sdlrpc' # project cobra https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            - '\\comnap' # https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            # - '\\rpc'  # may cause too many false positives : http://kb.palisade.com/index.php?pg=kb.page&id=483\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n", "git_filepath": "/apt/apt_turla_namedpipes.yml", "hash": "9a5f31d4764788fd85a41fe5bc64b7b2c97da59ad40bd3983857ed31ab2e0bd7", "level": "critical", "is_verified": false, "downloads": 0}, "_LMw42IB8Wx35J1-v8yx": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:05.615250", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Exploit for CVE-2017-0261", "released": "2018-04-20T13:14:05.615247", "sigma_text": "title: Exploit for CVE-2017-0261\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process FLTLDR.exe as used in exploits for CVE-2017-0261 and CVE-2017-0262 \nreferences:\n  - https://www.fireeye.com/blog/threat-research/2017/05/eps-processing-zero-days.html\nauthor: Florian Roth\ndate: 2018/02/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\FLTLDR.exe*'\n    condition: selection\nfalsepositives:\n    - Several false positives identified, check for suspicious file names or locations (e.g. Temp folders)\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_0261.yml", "title": "sigma: Exploit for CVE-2017-0261", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "2c0f1ada2e154cf55cb1a3eb666f4b042e753ed68ac2931b93e3f604f9fe1872", "level": "medium"}, "pbMv42IB8Wx35J1-qszC": {"status": "", "category": 3, "updated": "2018-04-20T13:12:54.720654", "user_id": null, "title": "sigma: Relevant ClamAV Message", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Relevant ClamAV Message", "released": "2018-04-20T13:12:54.720651", "sigma_text": "title: Relevant ClamAV Message\ndescription: Detects relevant ClamAV messages\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/clam_av_rules.xml\nlogsource:\n    product: linux\n    service: clamav\ndetection:\n    keywords:\n        - 'Trojan*FOUND'\n        - 'VirTool*FOUND'\n        - 'Webshell*FOUND'\n        - 'Rootkit*FOUND'\n        - 'Htran*FOUND'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_clamav.yml", "hash": "7225a68b5e89ab9e53df07628b078cede7cad3330c8881aa15dbf841bf4d6103", "author_keyword": null, "is_verified": false, "downloads": 0, "level": "high"}, "r7Mv42IB8Wx35J1-yszU": {"status": "", "category": 1, "updated": "2018-04-20T13:13:02.930172", "user_id": null, "title": "sigma: Python SQL Exceptions", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Python SQL Exceptions", "released": "2018-04-20T13:13:02.930169", "sigma_text": "title: Python SQL Exceptions\ndescription: Generic rule for SQL exceptions in Python according to PEP 249\nauthor: Thomas Patzke\nreferences:\n    - https://www.python.org/dev/peps/pep-0249/#exceptions\nlogsource:\n    category: application\n    product: python\ndetection:\n    exceptions:\n        - DataError\n        - IntegrityError\n        - ProgrammingError\n        - OperationalError\n    condition: exceptions\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/app_python_sql_exceptions.yml", "hash": "728818f710d6f0a4e5639fa6e9fa8a238157a574f63bb9ce1dcb502b30d5575b", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 0, "level": "medium"}, "K7Mx42IB8Wx35J1-VM3-": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:43.837046", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Download from Suspicious TLD", "released": "2018-04-20T13:14:43.837042", "sigma_text": "title: Download from Suspicious TLD\nstatus: experimental\ndescription: Detects download of certain file types from hosts in suspicious TLDs \nreferences:\n    - https://www.symantec.com/connect/blogs/shady-tld-research-gdn-and-our-2016-wrap\n    - https://promos.mcafee.com/en-US/PDF/MTMW_Report.pdf\n    - https://www.spamhaus.org/statistics/tlds/\nauthor: Florian Roth\ndate: 2017/11/07\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n        r-dns: \n            # Symantec / Chris Larsen analysis \n            - '*.country'\n            - '*.stream'\n            - '*.gdn'\n            - '*.mom'\n            - '*.xin'\n            - '*.kim'\n            - '*.men'\n            - '*.loan'\n            - '*.download'\n            - '*.racing'\n            - '*.online'\n            - '*.science'\n            - '*.ren'\n            - '*.gb'\n            - '*.win'\n            - '*.top'\n            - '*.review'\n            - '*.vip'\n            - '*.party'\n            - '*.tech'\n            - '*.tech'\n            - '*.xyz'\n            - '*.date'\n            - '*.faith'\n            - '*.zip'\n            - '*.cricket'\n            - '*.space'\n            - '*.top'\n            # McAfee report\n            - '*.info'\n            - '*.vn'\n            - '*.cm'\n            - '*.am'\n            - '*.cc'\n            - '*.asia'\n            - '*.ws'\n            - '*.tk'\n            - '*.biz'\n            - '*.su'\n            - '*.st'\n            - '*.ro'\n            - '*.ge'\n            - '*.ms'\n            - '*.pk'\n            - '*.nu'\n            - '*.me'\n            - '*.ph'\n            - '*.to'\n            - '*.tt'\n            - '*.name'\n            - '*.tv'\n            - '*.tv'\n            - '*.kz'\n            - '*.tc'\n            - '*.mobi'\n            # Spamhaus\n            - '*.study'\n            - '*.click'\n            - '*.link'\n            - '*.trade'\n            - '*.accountant'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\nfalsepositives:\n    - All kind of software downloads\nlevel: low\n", "git_filepath": "/proxy/proxy_download_susp_tlds_blacklist.yml", "title": "sigma: Download from Suspicious TLD", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "a0896bce8e5549cd2b0e60a59daced89707135e7c9ac3ee67eb66b2e552ef201", "level": "low"}, "ArMw42IB8Wx35J1-0s2T": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:10.448990", "user_id": null, "title": "sigma: New RUN Key Pointing to Suspicious Folder", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: New RUN Key Pointing to Suspicious Folder", "released": "2018-04-20T13:14:10.448987", "sigma_text": "title: New RUN Key Pointing to Suspicious Folder\nstatus: experimental\ndescription: Detects suspicious new RUN key element pointing to an executable in a suspicious folder\nauthor: Florian Roth\ndate: 2017/10/17\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13\n        TargetObject: '\\REGISTRY\\MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\*'\n        Details: \n          - 'C:\\Windows\\Temp\\*'\n          - '*\\AppData\\*'\n          - 'C:\\$Recycle.bin\\*'\n          - 'C:\\Temp\\*'\n          - 'C:\\Users\\Public\\*'\n          - 'C:\\Users\\Default\\*'\n    condition: selection\nfields:\n    - Image\nfalsepositives:\n    - Software with rare behaviour\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_run_key_img_folder.yml", "hash": "b5da6609b0031a06cafbae3c0b8cf48377d2113069602831d98dcc5d79c5d937", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "high"}, "swIC1WMBqfpvXJhTewwE": {"status": "testing", "category": "", "updated": "2018-06-06T12:31:48Z", "user_id": "80", "views": 24, "downloads": 0, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: FlawedAmmyy RAT Detection (Hashes).", "released": "2018-06-06T12:11:39Z", "sigma_text": "title: FlawedAmmyy RAT Detection (Hashes).\ndescription: FlawedAmmyy RAT Detection Through Hashes.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\ndate: 2018/03/07\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    file_hash:\n    - 18436342cab7f1d078354e86cb749b1de388dcb4d1e22c959de91619947dfd63\n    - d82ca606007be9c988a5f961315c3eed1b12725c6a39aa13888e693dc3b9a975\n    - 8903d514549aa9568c7fea0123758b954b9703c301b5e4941acb33cccd0d7c57\n    - 2b53466eebd2c65f81004c567df9025ce68017241e421abcf33799bd3e827900\n    - 0d100ff26a764c65f283742b9ec9014f4fd64df4f1e586b57f3cdce6eadeedcd\n    - 9a7fb98dd4c83f1b4995b9b358fa236969e826e4cb84f63f4f9881387bc88ccf\n    - b0ad80bf5e28e81ad8a7b13eec9c5c206f412870814d492b78f7ce4d574413d2\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\n    - 404d3d65430fbbdadedb206a29e6158c66a8efa2edccb7e648c1dd017de47572\n    - cc0205845562e017ff8b3aafb17de167529d113fc680e07ee9d8753d81487b2f\n    - 790e7dc8b2544f1c76ff95e56315fee7ef3fe623975c37d049cc47f82f18e4f2\n    - 2d19c42f753dcee5b46344f352c11a1c645f0b77e205c218c985bd1eb988c7ce\n    - 6e701670350b4aea3d2ead4b929317b0a6d835aa4c0331b25d65ecbfbf8cb500\n    - 3cd39abdbeb171d713ee8367ab60909f72da865dbb3bd858e4f6d31fd9c930d0\n    - 1f5d31d41ebb417d161bc49d1c50533fcbff523bb583883b10b14974a3de8984\n    - 6877ac35a3085d6c10fa48655cf9c2399bd96c3924273515eaf89b511bbe356a\n    - 059c0588902be3e8a5d747df9e91f65cc50d908540bdeb08acf15242cc9a25b5\n    - c8b202e5a737b8b5902e852de730dbd170893f146ab9bbc9c06b0d93a7625e85\n    - 927fa5fea13f8f3c28e307ffea127fb3511b32024349b39bbaee63fac8dcded7\n    - 6048a55de1350238dfc0dd6ebed12ddfeb0a1f3788c1dc772801170756bf15c7\n    - adfdead4419c134f0ab2951f22cfd4d5a1d83c0abfe328ae456321fccf241eb6\n    - 022f662903c6626fb81e844f7761f6f1cbaa6339e391468b5fbfb6d0a1ebf8cb\n    - 3f5f5050adcf0d0894db64940299ac07994c4501b361dce179e3d45d9d155adf\n    - cafa3466e422dd4256ff20336c1a032bbf6e915f410145b42b453e2646004541\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Execution:\n  - User Execution", "title": "sigma: FlawedAmmyy RAT Detection (Hashes).", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "31f359fb629ec07b652e6d720c91784af54b3db672196144069ebf43347be115", "level": "high"}, "urMv42IB8Wx35J1-7syP": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:12.076842", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: DNS Server Error Failed Loading the ServerLevelPluginDLL", "released": "2018-04-20T13:13:12.076839", "sigma_text": "title: DNS Server Error Failed Loading the ServerLevelPluginDLL\ndescription: This rule detects a DNS server error in which a specified plugin DLL (in registry) could not be loaded\nstatus: experimental\ndate: 2017/05/08\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\n    - https://technet.microsoft.com/en-us/library/cc735829(v=ws.10).aspx\n    - https://twitter.com/gentilkiwi/status/861641945944391680\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: dns-server\ndetection:\n    selection:\n        EventID: \n            - 150\n            - 770\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "git_filepath": "/windows/builtin/win_susp_dns_config.yml", "title": "sigma: DNS Server Error Failed Loading the ServerLevelPluginDLL", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "a4091bf811822c08eb7cb1d8501d9bd95c8001bc63f0c6528de69a56674c891c", "level": "critical"}, "qbMv42IB8Wx35J1-t8yi": {"status": "", "category": 3, "updated": "2018-04-20T13:12:58.017480", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious VSFTPD Error Messages", "released": "2018-04-20T13:12:58.017477", "sigma_text": "title: Suspicious VSFTPD Error Messages\ndescription: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/dagwieers/vsftpd/\nauthor: Florian Roth\ndate: 2017/07/05\nlogsource:\n    product: linux\n    service: vsftpd\ndetection:\n    keywords:\n        - 'Connection refused: too many sessions for this address.'\n        - 'Connection refused: tcp_wrappers denial.'\n        - 'Bad HTTP verb.'\n        - 'port and pasv both active'\n        - 'pasv and port both active'\n        - 'Transfer done (but failed to open directory).'\n        - 'Could not set file modification time.'\n        - 'bug: pid active in ptrace_sandbox_free'\n        - 'PTRACE_SETOPTIONS failure'\n        - 'weird status:'\n        - \"couldn't handle sandbox event\"\n        - 'syscall * out of bounds'\n        - 'syscall not permitted:'\n        - 'syscall validate failed:'\n        - 'Input line too long.'\n        - 'poor buffer accounting in str_netfd_alloc'\n        - 'vsf_sysutil_read_loop'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_susp_vsftp.yml", "title": "sigma: Suspicious VSFTPD Error Messages", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "f032d1128d52f2af5f2a11d18e75401074f6ff22482c57c84d76e5b8125602b4", "level": "medium"}, "uTwdG2YBatiiaHt9jiQk": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:20.893362", "author_keyword": "Florian Roth", "user_id": null, "title": "Executable used by PlugX in Uncommon Location", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Executable used by PlugX in Uncommon Location", "released": "2018-09-27T12:58:20.893357", "sigma_text": "title: Executable used by PlugX in Uncommon Location\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - 'http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/'\n    - 'https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/'\nauthor: Florian Roth\ndate: 2017/06/12\ntags:\n    - attack.s0013\nlogsource:\n    product: windows\n    service: security\ndetection:\n    # CamMute\n    selection_cammute:\n        EventID: 4688\n        CommandLine: '*\\CamMute.exe'\n    filter_cammute:\n        EventID: 4688\n        CommandLine: '*\\Lenovo\\Communication Utility\\*'\n    # Chrome Frame Helper\n    selection_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\Google\\Chrome\\application\\*'    \n    # Microsoft Device Emulator\n    selection_devemu:\n        EventID: 4688\n        CommandLine: '*\\dvcemumanager.exe'\n    filter_devemu:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Device Emulator\\*'   \n    # Windows Media Player Gadget\n    selection_gadget:\n        EventID: 4688\n        CommandLine: '*\\Gadget.exe'\n    filter_gadget:\n        EventID: 4688\n        CommandLine: '*\\Windows Media Player\\*'\n    # HTML Help Workshop\n    selection_hcc:\n        EventID: 4688\n        CommandLine: '*\\hcc.exe'\n    filter_hcc:\n        EventID: 4688\n        CommandLine: '*\\HTML Help Workshop\\*'\n    # Hotkey Command Module for Intel Graphics Contollers\n    selection_hkcmd:\n        EventID: 4688\n        CommandLine: '*\\hkcmd.exe'\n    filter_hkcmd:\n        EventID: 4688\n        CommandLine: \n            - '*\\System32\\*'\n            - '*\\SysNative\\*'\n            - '*\\SysWowo64\\*'\n    # McAfee component\n    selection_mc:\n        EventID: 4688\n        CommandLine: '*\\Mc.exe'\n    filter_mc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    # MsMpEng - Microsoft Malware Protection Engine\n    selection_msmpeng:\n        EventID: 4688\n        CommandLine: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Security Client\\*'\n            - '*\\Windows Defender\\*'\n            - '*\\AntiMalware\\*'\n    # Microsoft Security Center\n    selection_msseces:\n        EventID: 4688\n        CommandLine: '*\\msseces.exe'\n    filter_msseces:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Security Center\\*'\n    # Microsoft Office 2003 OInfo\n    selection_oinfo:\n        EventID: 4688\n        CommandLine: '*\\OInfoP11.exe'\n    filter_oinfo:\n        EventID: 4688\n        CommandLine: '*\\Common Files\\Microsoft Shared\\*'      \n    # OLE View\n    selection_oleview:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_oleview:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n    # RC\n    selection_rc:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_rc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n            - '*\\Microsoft.NET\\*'  \n    condition: ( selection_cammute and not filter_cammute ) or  \n                ( selection_chrome_frame and not filter_chrome_frame ) or\n                ( selection_devemu and not filter_devemu ) or\n                ( selection_gadget and not filter_gadget ) or \n                ( selection_hcc and not filter_hcc ) or \n                ( selection_hkcmd and not filter_hkcmd ) or \n                ( selection_mc and not filter_mc ) or\n                ( selection_msmpeng and not filter_msmpeng ) or\n                ( selection_msseces and not filter_msseces ) or\n                ( selection_oinfo and not filter_oinfo ) or \n                ( selection_oleview and not filter_oleview ) or \n                ( selection_rc and not filter_rc ) \nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_plugx_susp_exe_locations.yml", "hash": "bea693f0c6ee0691d6182b0a58a2fbbd85e8dc48f88c0b51204e924d68fed872", "level": "high", "is_verified": false, "downloads": 0}, "N7Mx42IB8Wx35J1-es2F": {"status": "experimental", "category": 2, "updated": "2018-04-20T13:14:53.443564", "user_id": null, "views": "12", "permission_id": 3, "author": "Markus Neis", "mitre_attack": null, "title_keyword": "sigma: Turla Group Named Pipes", "released": "2018-04-20T13:14:53.443560", "sigma_text": "title: Turla Group Named Pipes \nstatus: experimental\ndescription: Detects a named pipe used by Turla group samples\nreferences:\n    - Internal Research\ndate: 2017/11/06\nauthor: Markus Neis\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n    selection:\n        EventID: \n            - 17\n            - 18\n        PipeName: \n            - '\\atctl' # https://www.virustotal.com/#/file/a4ddb2664a6c87a1d3c5da5a5a32a5df9a0b0c8f2e951811bd1ec1d44d42ccf1/detection\n            - '\\userpipe' # ruag apt case\n            - '\\iehelper' # ruag apt case\n            - '\\sdlrpc' # project cobra https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            - '\\comnap' # https://www.gdatasoftware.com/blog/2015/01/23926-analysis-of-project-cobra\n            # - '\\rpc'  # may cause too many false positives : http://kb.palisade.com/index.php?pg=kb.page&id=483\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: critical\n", "git_filepath": "/apt/apt_turla_namedpipes.yml", "title": "sigma: Turla Group Named Pipes", "author_keyword": "Markus Neis", "is_verified": true, "downloads": 2, "hash": "35e1686626434bf0fbc40bd294ed1ce05dc14b38504fb6c90b0ec11b8a08d1f3", "level": "critical"}, "gzwdG2YBatiiaHt9YiRQ": {"status": "", "category": null, "updated": "2018-09-27T12:58:09.674383", "author_keyword": null, "user_id": null, "title": "Multiple Failed Logins with Different Accounts from Single Source System", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Multiple Failed Logins with Different Accounts from Single Source System", "released": "2018-09-27T12:58:09.674381", "sigma_text": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nlogsource:\n    product: linux\n    service: auth\ndetection:\n    selection:\n        pam_message: \"authentication failure\"\n        pam_user: '*'\n        pam_rhost: '*'\n    timeframe: 24h \n    condition: selection | count(pam_user) by pam_rhost > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Workstations with frequently changing users \nlevel: medium\n", "git_filepath": "/linux/lnx_susp_failed_logons_single_source.yml", "hash": "55ca9fbc76ccc89223f54cc9102b980ac070eb2563567be80b773f0d3f6cf285", "level": "medium", "is_verified": false, "downloads": 0}, "rrMv42IB8Wx35J1-x8ye": {"status": "experimental", "category": 1, "updated": "2018-04-20T13:13:02.106867", "user_id": null, "views": "6", "permission_id": 3, "author": "Bjoern Kimminich", "mitre_attack": null, "title_keyword": "sigma: Suspicious SQL Error Messages", "released": "2018-04-20T13:13:02.106863", "sigma_text": "title: Suspicious SQL Error Messages\nstatus: experimental\ndescription: Detects SQL error messages that indicate probing for an injection attack\nauthor: Bjoern Kimminich\nreferences:\n    - http://www.sqlinjection.net/errors\nlogsource:\n    category: application\n    product: sql\ndetection:\n    keywords:\n        # Oracle\n        - quoted string not properly terminated\n        # MySQL\n        - You have an error in your SQL syntax\n        # SQL Server\n        - Unclosed quotation mark\n        # SQLite\n        - near \"*\": syntax error\n        - SELECTs to the left and right of UNION do not have the same number of result columns\n    condition: keywords\nfalsepositives:\n    - Application bugs\nlevel: high\n", "git_filepath": "/application/app_sqlinjection_errors.yml", "title": "sigma: Suspicious SQL Error Messages", "author_keyword": "Bjoern Kimminich", "is_verified": false, "downloads": 0, "hash": "8a68f82e9366de8b42329c4ce135126fd4678fc06eaa40a70281f502ed720571", "level": "high"}, "oLMv42IB8Wx35J1-lMxy": {"status": "experimental", "category": 9, "updated": "2018-04-20T13:12:48.106864", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Program Executions in Suspicious Folders", "released": "2018-04-20T13:12:48.106861", "sigma_text": "title: Program Executions in Suspicious Folders\nstatus: experimental\ndescription: Detects program executions in suspicious non-program folders related to malware or hacking activity\nreferences:\n    - 'Internal Research'\ndate: 2018/01/23\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'SYSCALL'\n        exe:\n            # Temporary folder\n            - '/tmp/*'\n            # Web server \n            - '/var/www/*'            # Standard\n            - '/usr/local/apache2/*'  # Classical Apache\n            - '/usr/local/httpd/*'    # Old SuSE Linux 6.*\n            - '/var/apache/*'         # Solaris\n            - '/srv/www/*'            # SuSE Linux 9.*\n            - '/home/httpd/html/*'    # Redhat 6 or older\n            # Data dirs of typically exploited services (incomplete list)\n            - '/var/lib/pgsql/data/*'\n            - '/usr/local/mysql/data/*'\n            - '/var/lib/mysql/*'\n            - '/var/vsftpd/*'\n            - '/etc/bind/*'\n            - '/var/named/*'\n            # Others\n            - '*/public_html/*'\n    condition: selection\nfalsepositives:\n    - Admin activity (especially in /tmp folders)\n    - Crazy web applications\nlevel: medium\n", "git_filepath": "/linux/auditd/lnx_auditd_susp_exe_folders.yml", "title": "sigma: Program Executions in Suspicious Folders", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "cbf9b2509623ce4b03622a5de906b3411531ab025c06d8ccc1333c6f0b731c0d", "level": "medium"}, "7bMw42IB8Wx35J1-j8yW": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:53.301054", "user_id": null, "views": 9, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: UAC Bypass via Event Viewer", "released": "2018-04-20T13:13:53.301050", "sigma_text": "title: UAC Bypass via Event Viewer\nstatus: experimental\ndescription: Detects UAC bypass method using Windows event viewer\nreferences:\n    - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/\n    - https://www.hybrid-analysis.com/sample/e122bc8bf291f15cab182a5d2d27b8db1e7019e4e96bb5cdbd1dfe7446f3f51f?environmentId=100\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    methregistry:\n        EventID: 13\n        TargetObject: 'HKEY_USERS\\*\\mscfile\\shell\\open\\command'\n    methprocess:\n        EventID: 1\n        ParentImage: '*\\eventvwr.exe'\n    filterprocess:\n        Image: '*\\mmc.exe'\n    condition: methregistry or ( methprocess and not filterprocess )\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_uac_bypass_eventvwr.yml", "title": "sigma: UAC Bypass via Event Viewer", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "9f8687b4591eb93814f93a28a96da69ce23cddf34b1c2005b878a8886ef33330", "level": "critical"}, "czxOBmMB_9rlszZ2ls9q": {"status": "testing", "category": 11, "updated": "2018-04-27T12:36:23Z", "user_id": "8", "views": 54, "downloads": 4, "author": "Ruslan Mikhalov", "mitre_attack": "", "title_keyword": "sigma: Enabling RDP remotely using PsExec", "released": "2018-04-27T08:53:23Z", "sigma_text": "title: Enabling RDP remotely using PsExec\ndescription: Detects enabling RDP remotely via PsExec.\nauthor: Ruslan Mikhalov\ndate: 2018/03/13\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  sysmon_remoterdpenable:\n    EventID: \"1\"\n    Image: '*\\reg.exe'\n    CommandLine: '\"reg\" add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 /f'\n    ParentCommandLine: '*\\PSEXESVC.exe'\n  condition: sysmon_remoterdpenable\nfields:\n- EventID\n- Image\n- CommandLine\n- ParentCommandLine\nfalsepositives:\n- Administrative activity\nlevel: low\nreference:\n- https://twitter.com/zuphzuph/status/987383421847486464?s=21\nstatus: testing", "title": "sigma: Enabling RDP remotely using PsExec", "author_keyword": "Ruslan Mikhalov", "is_verified": true, "permission_id": 3, "hash": "0a46087ceb8058f8a954f77d4684e501ce59fc79649cf68f887fbbba37c8180b", "level": "low"}, "kTwdG2YBatiiaHt9bSR1": {"status": "", "category": null, "updated": "2018-09-27T12:58:12.526686", "author_keyword": "Florian Roth", "user_id": null, "title": "Apache Segmentation Fault", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Apache Segmentation Fault", "released": "2018-09-27T12:58:12.526680", "sigma_text": "title: Apache Segmentation Fault\ndescription: Detects a segmentation fault error message caused by a creashing apacke worker process \nauthor: Florian Roth\nreferences:\n    - http://www.securityfocus.com/infocus/1633\nlogsource:\n    product: apache\ndetection:\n    keywords:\n        - 'exit signal Segmentation Fault'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/web/web_apache_segfault.yml", "hash": "7b91b70b26a6849c372a058ffb811f124b545e6c2a150c32b4ba1633b221bff7", "level": "high", "is_verified": false, "downloads": 0}, "OLMx42IB8Wx35J1-fc2e": {"status": "", "category": 2, "updated": "2018-04-20T13:14:54.236578", "user_id": null, "views": 12, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Equation Group Indicators", "released": "2018-04-20T13:14:54.236575", "sigma_text": "title: Equation Group Indicators\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\nreferences:\n    - https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # evolvingstrategy, elgingamble, estesfox\n        - 'chown root*chmod 4777 '\n        - 'cp /bin/sh .;chown'\n        # tmpwatch\n        - 'chmod 4777 /tmp/.scsi/dev/bin/gsh'\n        - 'chown root:root /tmp/.scsi/dev/bin/'\n        # estesfox\n        - 'chown root:root x;'\n        # ratload\n        - '/bin/telnet locip locport < /dev/console | /bin/sh'\n        - '/tmp/ratload'\n        # ewok\n        - 'ewok -t '\n        # xspy\n        - 'xspy -display '\n        # elatedmonkey\n        - 'cat > /dev/tcp/127.0.0.1/80 <<END'\n        # ftshell\n        - 'rm -f /current/tmp/ftshell.latest'\n        # ghost\n        - 'ghost_* -v '\n        # morerats client\n        - ' --wipe > /dev/null'\n        # noclient\n        - 'ping -c 2 *; grep * /proc/net/arp >/tmp/gx'\n        - 'iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;'\n        # auditcleaner\n        - '> /var/log/audit/audit.log; rm -f .'\n        - 'cp /var/log/audit/audit.log .tmp'\n        # reverse shell\n        - 'sh >/dev/tcp/* <&1 2>&1'\n        # packrat\n        - 'ncat -vv -l -p * <'\n        - 'nc -vv -l -p * <'\n        # empty bowl\n        - '< /dev/console | uudecode && uncompress'\n        - 'sendmail -osendmail;chmod +x sendmail'\n        # echowrecker\n        - '/usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron'\n        # dubmoat\n        - 'chmod 666 /var/run/utmp~'\n        # poptop\n        - 'chmod 700 nscd crond'\n        # abopscript\n        - 'cp /etc/shadow /tmp/.'\n        # ys\n        - '</dev/console |uudecode > /dev/null 2>&1 && uncompress'\n        # jacktelnet\n        - 'chmod 700 jp&&netstat -an|grep'\n        # others\n        - 'uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755'\n        - 'chmod 700 crond'\n        - 'wget http*; chmod +x /tmp/sendmail'\n        - 'chmod 700 fp sendmail pt'\n        - 'chmod 755 /usr/vmsys/bin/pipe'\n        - 'chmod -R 755 /usr/vmsys'\n        - 'chmod 755 $opbin/*tunnel'\n        - '< /dev/console | uudecode && uncompress'\n        - 'chmod 700 sendmail'\n        - 'chmod 0700 sendmail'\n        - '/usr/bin/wget http*sendmail;chmod +x sendmail;'\n        - '&& telnet * 2>&1 </dev/console'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_equationgroup_lnx.yml", "title": "sigma: Equation Group Indicators", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 11, "hash": "b171f24007a73640f7ebdae458e5f65e9d1312da1cb5d1daced64fe140b4bc84", "level": "high"}, "fzwdG2YBatiiaHt9XyQc": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:08.852372", "author_keyword": "Florian Roth", "user_id": null, "title": "Program Executions in Suspicious Folders", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Program Executions in Suspicious Folders", "released": "2018-09-27T12:58:08.852361", "sigma_text": "title: Program Executions in Suspicious Folders\nstatus: experimental\ndescription: Detects program executions in suspicious non-program folders related to malware or hacking activity\nreferences:\n    - 'Internal Research'\ndate: 2018/01/23\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    selection:\n        type: 'SYSCALL'\n        exe:\n            # Temporary folder\n            - '/tmp/*'\n            # Web server \n            - '/var/www/*'              # Standard\n            - '/home/*/public_html/*'   # Per-user\n            - '/usr/local/apache2/*'    # Classical Apache\n            - '/usr/local/httpd/*'      # Old SuSE Linux 6.* Apache\n            - '/var/apache/*'           # Solaris Apache\n            - '/srv/www/*'              # SuSE Linux 9.*\n            - '/home/httpd/html/*'      # Redhat 6 or older Apache\n            - '/srv/http/*'             # ArchLinux standard\n            - '/usr/share/nginx/html/*' # ArchLinux nginx\n            # Data dirs of typically exploited services (incomplete list)\n            - '/var/lib/pgsql/data/*'\n            - '/usr/local/mysql/data/*'\n            - '/var/lib/mysql/*'\n            - '/var/vsftpd/*'\n            - '/etc/bind/*'\n            - '/var/named/*'\n    condition: selection\nfalsepositives:\n    - Admin activity (especially in /tmp folders)\n    - Crazy web applications\nlevel: medium\n", "git_filepath": "/linux/auditd/lnx_auditd_susp_exe_folders.yml", "hash": "11dbaab4c593b13c294e7d820a5a26dd424c968d6ac1746a3613981665776fdc", "level": "medium", "is_verified": false, "downloads": 0}, "izwdG2YBatiiaHt9aCTN": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:11.335216", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious DNS Query with B64 Encoded String", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious DNS Query with B64 Encoded String", "released": "2018-09-27T12:58:11.335213", "sigma_text": "title: Suspicious DNS Query with B64 Encoded String   \nstatus: experimental\ndescription: Detects suspicious DNS queries using base64 encoding\nreferences:\n    - https://github.com/krmaxwell/dns-exfiltration\nauthor: Florian Roth\ndate: 2018/05/10\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - '*==.*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium", "git_filepath": "/network/net_susp_dns_b64_queries.yml", "hash": "389b4482c863caea3f620043c550e049c87aaec097cafe230238b61a14a4c54b", "level": "medium", "is_verified": false, "downloads": 0}, "ILMx42IB8Wx35J1-Mc1P": {"status": "", "category": 15, "updated": "2018-04-20T13:14:34.701192", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Ping Hex IP", "released": "2018-04-20T13:14:34.701189", "sigma_text": "title: Ping Hex IP\ndescription: Detects a ping command that uses a hex encoded IP address\nreferences:\n    - https://github.com/vysec/Aggressor-VYSEC/blob/master/ping.cna\n    - https://twitter.com/vysecurity/status/977198418354491392\nauthor: Florian Roth\ndate: 2018/03/23\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            - '*\\ping.exe 0x*'\n            - '*\\ping 0x*'\n    condition: selection\nfields:\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely, because no sane admin pings IP addresses in a hexadecimal form\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_ping_hex_ip.yml", "title": "sigma: Ping Hex IP", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "6a72e5da63c4e1398c0b4b15b0c67ef16c4886e19d040152415b539b697f996a", "level": "high"}, "KbMx42IB8Wx35J1-Ts0a": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:42.072982", "user_id": null, "views": 11, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Windows PowerShell User Agent", "released": "2018-04-20T13:14:42.072979", "sigma_text": "title: Windows PowerShell User Agent\nstatus: experimental\ndescription: Detects Windows PowerShell Web Access\nreferences:\n    - https://msdn.microsoft.com/powershell/reference/5.1/microsoft.powershell.utility/Invoke-WebRequest\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent: '* WindowsPowerShell/*'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Administrative scripts that download files from the Internet\n    - Administrative scripts that retrieve certain website contents\nlevel: medium\n", "git_filepath": "/proxy/proxy_powershell_ua.yml", "title": "sigma: Windows PowerShell User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 6, "hash": "bf1c625ee0efd6a3b9118234ad21fc47d26ac85527e7b9d4e4c4cb5907141f42", "level": "medium"}, "CrMw42IB8Wx35J1-682d": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:16.859542", "user_id": null, "views": "2", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: WMI Persistence - Script Event Consumer File Write", "released": "2018-04-20T13:14:16.859539", "sigma_text": "title: WMI Persistence - Script Event Consumer File Write\nstatus: experimental\ndescription: Detects file writes of WMI script event consumer\nreferences:\n    - https://www.eideon.com/2018-03-02-THL03-WMIBackdoors/\nauthor: Thomas Patzke\ndate: 2018/03/07\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 11\n        Image: 'C:\\WINDOWS\\system32\\wbem\\scrcons.exe'\n    condition: selection\nfalsepositives: \n    - Unknown (data set is too small; further testing needed)\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_wmi_persistence_script_event_consumer_write.yml", "title": "sigma: WMI Persistence - Script Event Consumer File Write", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "6cedb6ee27d74395db274f3e4535d832ffe7a111f8b4a010da83e661a1c30d4a", "level": "high"}, "cDyHAWMB_9rlszZ2Hs8s": {"status": "testing", "category": 2, "updated": "2018-04-30T13:28:20Z", "user_id": "3518", "views": 97, "downloads": 0, "author": "Eugene Nechiporenko, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: DiskShadow and Vshadow launch detection", "released": "2018-04-26T10:37:02Z", "sigma_text": "title: DiskShadow and Vshadow launch detection\nstatus: testing\ndescription: This rule detects execution vshadow.exe and diskshadow.exe\nreferences:\n- https://bohops.com/2018/02/10/vshadow-abusing-the-volume-shadow-service-for-evasion-persistence-and-active-directory-database-extraction/\n- https://bohops.com/2018/03/26/diskshadow-the-return-of-vss-evasion-persistence-and-active-directory-database-extraction/\nauthor: Eugene Nechiporenko, SOC Prime\ndate: 2018/04/25\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection1:\n    EventID: \"1\"\n    ParentImage:\n    - '*\\vshadow.exe'\n    Image:\n    - '*\\notepad.exe'\n  selection2:\n    EventID: \"1\"\n    ParentImage:\n    - '*\\diskshadow.exe'\n    Image:\n    - '*\\notepad.exe'\n  selection3:\n    EventID: \"1\"\n    CommandLine:\n    - 'vshadow.exe -nw -exec=c:\\windows\\system32\\notepad.exe c:'\n    - diskshadow.exe /s c:\\*\n  condition:\n  - selection1 or selection2 or selection3\nfields:\n- ParentImage\n- Image\n- CommandLine\nfalsepositives:\n- Administrative activity\n- User activity\nlevel: high\nmitre-attack:\n  Credential Access:\n  - Credential Dumping\n  Persistence:\n  - Registry Run Keys / Start Folder\n  - Scheduled Task", "title": "sigma: DiskShadow and Vshadow launch detection", "author_keyword": "Eugene Nechiporenko, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "1de2442f27727a9416d38eccbbadd5c8fad8f25a336b8bb907b155546c2033ee", "level": "high"}, "F7Mx42IB8Wx35J1-Fc0T": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:27.473899", "user_id": null, "views": 5, "permission_id": 3, "author": "Margaritis Dimitrios (idea), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: WScript or CScript Dropper", "released": "2018-04-20T13:14:27.473896", "sigma_text": "title: WScript or CScript Dropper\nstatus: experimental\ndescription: Detects wscript/cscript executions of scripts located in user directories\nauthor: Margaritis Dimitrios (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        CommandLine:\n            - '* C:\\Users\\*.jse *'\n            - '* C:\\Users\\*.vbe *'\n            - '* C:\\Users\\*.js *'\n            - '* C:\\Users\\*.vba *'\n            - '* C:\\Users\\*.vbs *'\n            - '* C:\\ProgramData\\*.jse *'\n            - '* C:\\ProgramData\\*.vbe *'\n            - '* C:\\ProgramData\\*.js *'\n            - '* C:\\ProgramData\\*.vba *'\n            - '* C:\\ProgramData\\*.vbs *'\n    falsepositive:\n        ParentImage: '*\\winzip*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Winzip\n    - Other self-extractors\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_malware_script_dropper.yml", "title": "sigma: WScript or CScript Dropper", "author_keyword": "Margaritis Dimitrios (idea), Florian Roth (rule)", "is_verified": false, "downloads": 0, "hash": "45ac9f5b2866ca0785ea3cda7207b9104a0321680f8b27a56673dee04da9071a", "level": "high"}, "s7Mv42IB8Wx35J1-2My-": {"status": "", "category": 11, "updated": "2018-04-20T13:13:06.492106", "user_id": null, "views": "2", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Security Eventlog Cleared", "released": "2018-04-20T13:13:06.492103", "sigma_text": "title: Security Eventlog Cleared\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 517\n            - 1102\n    condition: selection\nfalsepositives:\n    - Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\n    - System provisioning (system reset before the golden image creation)\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_security_eventlog_cleared.yml", "title": "sigma: Security Eventlog Cleared", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "3f91e2459996d325acf0e8eb7e508313771e128c6d975206ff4f534550b9e9bd", "level": "high"}, "obMv42IB8Wx35J1-m8zM": {"status": "experimental", "category": 9, "updated": "2018-04-20T13:12:50.890013", "user_id": null, "views": 8, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Detects Suspicious Commands on Linux systems", "released": "2018-04-20T13:12:50.890011", "sigma_text": "title: Detects Suspicious Commands on Linux systems\nstatus: experimental\ndescription: Detects relevant commands often related to malware or hacking activity. Modified by SOC Prime, replaced condition \"1 of cmds\" with \"cmds\"\nreferences:\n    - 'Internal Research - mostly derived from exploit code including code in MSF'\ndate: 2017/12/12\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    cmds:\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: '777'\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: 'u+s'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/ksh'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/sh'\n    condition: cmds\nfalsepositives:\n    - Admin activity\nlevel: medium", "git_filepath": "/linux/auditd/lnx_auditd_susp_cmds.yml", "title": "sigma: Detects Suspicious Commands on Linux systems", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "98839916cb4fb821428bfceeecf3141c55ee580e024e35179363535eb6fe54e9", "level": "medium"}, "gTwdG2YBatiiaHt9YCS1": {"status": "", "category": null, "updated": "2018-09-27T12:58:09.263239", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious Activity in Shell Commands", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious Activity in Shell Commands", "released": "2018-09-27T12:58:09.263235", "sigma_text": "title: Suspicious Activity in Shell Commands\ndescription: Detects suspicious shell commands used in various exploit codes (see references)\nreferences:\n    - http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html\n    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121\n    - http://pastebin.com/FtygZ1cg\n    - https://artkond.com/2017/03/23/pivoting-guide/\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious commands\n        - 'wget * - http* | perl'\n        - 'wget * - http* | sh'\n        - 'wget * - http* | bash'\n        - 'python -m SimpleHTTPServer'\n        - 'import pty; pty.spawn'\n        # Malware \n        - '*wget *; chmod +x*'\n        - '*wget *; chmod 777 *'\n        - '*cd /tmp || cd /var/run || cd /mnt*'\n        # Apache Struts in-the-wild exploit codes  \n        - 'stop;service iptables stop;'\n        - 'stop;SuSEfirewall2 stop;'\n        - 'chmod 777 2020'\n        - '\">>/etc/rc.local;'\n        - 'wget -c *;chmod 777'\n        # Metasploit framework exploit codes\n        - 'base64 -d /tmp/'\n        - ' | base64 -d'\n        - '/bin/chmod u+s'\n        - 'chmod +s /tmp/'\n        - 'chmod u+s /tmp/'\n        - '/tmp/haxhax'\n        - '/tmp/ns_sploit'\n        - 'nc -l -p '\n        - 'cp /bin/ksh '\n        - 'cp /bin/sh '\n        - ' /tmp/*.b64 '\n        - '/tmp/ysocereal.jar'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_shell_susp_commands.yml", "hash": "50f16b4015f68d5b6b9bb9d5670f1e32ccb13d86125b28b2167b117f8af17ce1", "level": "high", "is_verified": false, "downloads": 0}, "ozwdG2YBatiiaHt9fCQU": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:16.269648", "author_keyword": "Florian Roth", "user_id": null, "title": "Rare Service Installs", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Rare Service Installs", "released": "2018-09-27T12:58:16.269638", "sigma_text": "title: Rare Service Installs\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services \nstatus: experimental\nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    timeframe: 7d\n    condition: selection | count(ServiceFileName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n", "git_filepath": "/windows/builtin/win_rare_service_installs.yml", "hash": "cc3d6f0714a57ef14068b253df8b3b95d5fb5b9278a1a7d193a5b19553d8650e", "level": "low", "is_verified": false, "downloads": 0}, "-7Mw42IB8Wx35J1-vMyI": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:04.806586", "user_id": null, "views": "1", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Shells Spawned by Web Servers", "released": "2018-04-20T13:14:04.806583", "sigma_text": "title: Shells Spawned by Web Servers\nstatus: experimental\ndescription: Web servers that spawn shell processes could be the result of a successfully placed web shell or an other attack\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\w3wp.exe'\n            - '*\\httpd.exe'\n            - '*\\nginx.exe'\n            - '*\\php-cgi.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\powershell.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Particular web applications may spawn a shell process legitimately\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_webshell_spawn.yml", "title": "sigma: Shells Spawned by Web Servers", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "fe2c93240ae0f0780159099fdb33902b491acdae08006df50dd15926da6a8800", "level": "high"}, "FLMx42IB8Wx35J1-C82V": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:25.043634", "user_id": null, "views": 2, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Reconnaissance Activity", "released": "2018-04-20T13:14:25.043631", "sigma_text": "title: Suspicious Reconnaissance Activity\nstatus: experimental\ndescription: Detects suspicious command line activity on Windows systems\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            - 'net group \"domain admins\" /domain'\n            - 'net localgroup administrators'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Inventory tool runs\n    - Penetration tests\n    - Administrative activity\nanalysis:\n    recommendation: Check if the user that executed the commands is suspicious (e.g. service accounts, LOCAL_SYSTEM)\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_recon_activity.yml", "title": "sigma: Suspicious Reconnaissance Activity", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "26a9c2938e5c5d25a21bce564049170a32dadc920e237a47e92417ddf64172a5", "level": "medium"}, "w7Mw42IB8Wx35J1-Csye": {"status": "", "category": 11, "updated": "2018-04-20T13:13:19.260521", "user_id": null, "views": "8", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: PsExec Service Start", "released": "2018-04-20T13:13:19.260518", "sigma_text": "title: PsExec Service Start\ndescription: Detects a PsExec service start. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection\"\nauthor: Florian Roth\ndate: 2018/03/13\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Detailed Tracking > Audit Process creation, Group Policy : Administrative Templates\\System\\Audit Process Creation'\ndetection:\n    selection:\n        EventID: 4688\n        CommandLine: 'C:\\Windows\\PSEXESVC.exe'\n    condition: selection\nfalsepositives:\n    - Administrative activity\nlevel: low", "git_filepath": "/windows/builtin/win_psexesvc_start.yml", "title": "sigma: PsExec Service Start", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "d8c0c2184a4bebe0b6cbc5d95175c4a9b65c81161559a47f54c77c570cb39061", "level": "low"}, "87Mw42IB8Wx35J1-osxn": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:58.117855", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Execution in Non-Executable Folder", "released": "2018-04-20T13:13:58.117852", "sigma_text": "title: Execution in Non-Executable Folder\nstatus: experimental\ndescription: Detects a suspicious exection from an uncommon folder\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: \n            - '*\\$Recycle.bin'\n            - '*\\Users\\All Users\\*'\n            - '*\\Users\\Default\\*'\n            - '*\\Users\\Public\\*'\n            - 'C:\\Perflogs\\*'\n            - '*\\config\\systemprofile\\*'\n            - '*\\Windows\\Fonts\\*'\n            - '*\\Windows\\IME\\*'\n            - '*\\Windows\\addins\\*'       \n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_execution_path.yml", "title": "sigma: Execution in Non-Executable Folder", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "50694844328ebc63f6c1f91028ce2c9dc062085ea24f268c22d4559c65e3fdab", "level": "high"}, "sjwdG2YBatiiaHt9iCSN": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:19.463277", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Secure Deletion with SDelete", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Secure Deletion with SDelete", "released": "2018-09-27T12:58:19.463275", "sigma_text": "title: Secure Deletion with SDelete\nstatus: experimental\ndescription: Detects renaming of file while deletion with SDelete tool\nauthor: Thomas Patzke\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\ntags:\n    - attack.defense_evasion\n    - attack.t1107\n    - attack.t1116\n    - attack.s0195\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n            - 4658\n        ObjectName:\n            - '*.AAA'\n            - '*.ZZZ'\n    condition: selection\nfalsepositives:\n    - Legitime usage of SDelete\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_sdelete.yml", "hash": "a2cb33efe08836f3f8872825e1bb1bd370233075607ab488639bd024c2d2b316", "level": "medium", "is_verified": false, "downloads": 0}, "oTwdG2YBatiiaHt9eiRH": {"status": "", "category": null, "updated": "2018-09-27T12:58:15.809370", "author_keyword": null, "user_id": null, "title": "Turla Service Install", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Turla Service Install", "released": "2018-09-27T12:58:15.809365", "sigma_text": "title: Turla Service Install\ndescription: 'This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET' \nreferences:\n    - https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\ntags:\n    - attack.command_and_control\n    - attack.g0010\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName:\n            - 'srservice'\n            - 'ipvpn'\n            - 'hkmsvc' \n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_carbonpaper_turla.yml", "hash": "63d7d685c32d477a85d145a057b8bb76a0303c7d7b2161fa0332a64a428e2dab", "level": "high", "is_verified": false, "downloads": 0}, "1rMw42IB8Wx35J1-R8wd": {"status": "", "category": 11, "updated": "2018-04-20T13:13:34.747326", "user_id": null, "title": "sigma: Hacktool Use", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Hacktool Use", "released": "2018-04-20T13:13:34.747323", "sigma_text": "title: Hacktool Use\ndescription: This method detects well-known keywords, certain field combination that appear in Windows Eventlog when certain hack tools are used\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    # Ruler https://github.com/sensepost/ruler\n    selection1:\n        EventID: \n          - 4776\n          - 4624\n          - 4625\n        WorkstationName: 'RULER'\n    condition: selection1\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/windows/builtin/win_alert_hacktool_use.yml", "hash": "496426c50c5a118cde28e357db3c8607f4f79e7163c69ff584be8093f8d72dc6", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "level": "critical"}, "oDwdG2YBatiiaHt9eSSc": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:15.637714", "author_keyword": "Florian Roth", "user_id": null, "title": "Pandemic Registry Key", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Pandemic Registry Key", "released": "2018-09-27T12:58:15.637709", "sigma_text": "title: Pandemic Registry Key\nstatus: experimental\ndescription: Detects Pandemic Windows Implant\nreferences:\n    - https://wikileaks.org/vault7/#Pandemic\n    - https://twitter.com/MalwareJake/status/870349480356454401\ntags:\n    - attack.lateral_movement\n    - attack.t1105\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 13\n        TargetObject: \n            - '\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\services\\null\\Instance*'\n            - '\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet002\\services\\null\\Instance*'\n    selection2:\n        EventID: 1\n        Command: 'loaddll -a *'\n    condition: 1 of them\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: critical\n", "git_filepath": "/apt/apt_pandemic.yml", "hash": "ff032d497af05df05df82071b5f5265826ca603fd91133110941b831a288c622", "level": "critical", "is_verified": false, "downloads": 0}, "4rMw42IB8Wx35J1-bMys": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:44.362711", "user_id": null, "views": 20, "permission_id": 3, "author": "Sean Metcalf (source), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Malicious PowerShell Commandlets", "released": "2018-04-20T13:13:44.362708", "sigma_text": "title: Malicious PowerShell Commandlets\nstatus: experimental\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\nreferences:\n    - https://adsecurity.org/?p=2921\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        - Invoke-DllInjection\n        - Invoke-Shellcode\n        - Invoke-WmiCommand\n        - Get-GPPPassword\n        - Get-Keystrokes\n        - Get-TimedScreenshot\n        - Get-VaultCredential\n        - Invoke-CredentialInjection\n        - Invoke-Mimikatz\n        - Invoke-NinjaCopy\n        - Invoke-TokenManipulation\n        - Out-Minidump\n        - VolumeShadowCopyTools\n        - Invoke-ReflectivePEInjection\n        - Invoke-UserHunter\n        - Find-GPOLocation\n        - Invoke-ACLScanner\n        - Invoke-DowngradeAccount\n        - Get-ServiceUnquoted\n        - Get-ServiceFilePermission\n        - Get-ServicePermission\n        - Invoke-ServiceAbuse\n        - Install-ServiceBinary\n        - Get-RegAutoLogon\n        - Get-VulnAutoRun\n        - Get-VulnSchTask\n        - Get-UnattendedInstallFile\n        - Get-WebConfig\n        - Get-ApplicationHost\n        - Get-RegAlwaysInstallElevated\n        - Get-Unconstrained\n        - Add-RegBackdoor\n        - Add-ScrnSaveBackdoor\n        - Gupt-Backdoor\n        - Invoke-ADSBackdoor\n        - Enabled-DuplicateToken\n        - Invoke-PsUaCme\n        - Remove-Update\n        - Check-VM\n        - Get-LSASecret\n        - Get-PassHashes\n        - Invoke-Mimikatz\n        - Show-TargetScreen\n        - Port-Scan\n        - Invoke-PoshRatHttp\n        - Invoke-PowerShellTCP\n        - Invoke-PowerShellWMI\n        - Add-Exfiltration\n        - Add-Persistence\n        - Do-Exfiltration\n        - Start-CaptureServer\n        - Invoke-DllInjection\n        - Invoke-ReflectivePEInjection\n        - Invoke-ShellCode\n        - Get-ChromeDump\n        - Get-ClipboardContents\n        - Get-FoxDump\n        - Get-IndexedItem\n        - Get-Keystrokes\n        - Get-Screenshot\n        - Invoke-Inveigh\n        - Invoke-NetRipper\n        - Invoke-NinjaCopy\n        - Out-Minidump\n        - Invoke-EgressCheck\n        - Invoke-PostExfil\n        - Invoke-PSInject\n        - Invoke-RunAs\n        - MailRaider\n        - New-HoneyHash\n        - Set-MacAttribute\n        - Get-VaultCredential\n        - Invoke-DCSync\n        - Invoke-Mimikatz\n        - Invoke-PowerDump\n        - Invoke-TokenManipulation\n        - Exploit-Jboss\n        - Invoke-ThunderStruck\n        - Invoke-VoiceTroll\n        - Set-Wallpaper\n        - Invoke-InveighRelay\n        - Invoke-PsExec\n        - Invoke-SSHCommand\n        - Get-SecurityPackages\n        - Install-SSP\n        - Invoke-BackdoorLNK\n        - PowerBreach\n        - Get-GPPPassword\n        - Get-SiteListPassword\n        - Get-System\n        - Invoke-BypassUAC\n        - Invoke-Tater\n        - Invoke-WScriptBypassUAC\n        - PowerUp\n        - PowerView\n        - Get-RickAstley\n        - Find-Fruit\n        - HTTP-Login\n        - Find-TrustedDocuments\n        - Invoke-Paranoia\n        - Invoke-WinEnum\n        - Invoke-ARPScan\n        - Invoke-PortScan\n        - Invoke-ReverseDNSLookup\n        - Invoke-SMBScanner\n        - Invoke-Mimikittenz\n    condition: keywords\nfalsepositives:\n    - Penetration testing\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_malicious_commandlets.yml", "title": "sigma: Malicious PowerShell Commandlets", "author_keyword": "Sean Metcalf (source), Florian Roth (rule)", "is_verified": true, "downloads": 0, "hash": "bc1334fb14917264768d40e818253f2722d6554f2560144c3110ee233b725e3d", "level": "high"}, "jDwdG2YBatiiaHt9aSSl": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:11.550660", "author_keyword": "Florian Roth", "user_id": null, "title": "Telegram Bot API Request", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Telegram Bot API Request", "released": "2018-09-27T12:58:11.550658", "sigma_text": "title: Telegram Bot API Request\nstatus: experimental\ndescription: Detects suspicious DNS queries to api.telegram.org used by Telegram Bots of any kind\nreferences:\n    - https://core.telegram.org/bots/faq\n    - https://researchcenter.paloaltonetworks.com/2018/03/unit42-telerat-another-android-trojan-leveraging-telegrams-bot-api-to-target-iranian-users/\n    - https://blog.malwarebytes.com/threat-analysis/2016/11/telecrypt-the-ransomware-abusing-telegram-api-defeated/\n    - https://www.welivesecurity.com/2016/12/13/rise-telebots-analyzing-disruptive-killdisk-attacks/\nauthor: Florian Roth\ndate: 2018/06/05\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - 'api.telegram.org'   # Telegram Bot API Request https://core.telegram.org/bots/faq\n    condition: selection\nfalsepositives:\n    - Legitimate use of Telegram bots in the company\nlevel: medium", "git_filepath": "/network/net_susp_telegram_api.yml", "hash": "cf636abe0667739ad6c7fcbf5f8708e37c3f9169cc462c613997a153ea91daa8", "level": "medium", "is_verified": false, "downloads": 0}, "KrMx42IB8Wx35J1-Uc0l": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:42.852150", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Exploit Framework User Agent", "released": "2018-04-20T13:14:42.852147", "sigma_text": "title: Exploit Framework User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings used by exploit / pentest framworks like Metasploit in proxy logs\nreferences:\n    - https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Cobalt Strike https://www.cobaltstrike.com/help-malleable-c2\n        - 'Internet Explorer *'\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; InfoPath.2)'  # https://goo.gl/f4H5Ez\n        # Metasploit Framework - Analysis by Didier Stevens https://blog.didierstevens.com/2015/03/16/quickpost-metasploit-user-agent-strings/\n        - 'Mozilla/4.0 (compatible; Metasploit RSPEC)'\n        - 'Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)'\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)'  # old browser, rare, base-lining needed\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Trident/4.0; SIMBAR={7DB0F6DE-8DE7-4841-9084-28FA914B0F2E}; SLCC1; .N'\n        - 'Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)'  # only use in proxy logs - not for detection in web server logs\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/525.13 (KHTML, like Gecko) Chrome/4.0.221.6 Safari/525.13'\n        # Metasploit Update by Florian Roth 08.07.2017\n        - 'Mozilla/5.0'\n        - 'Mozilla/4.0 (compatible; SPIPE/1.0'\n        # - 'Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)'  # too many false positives expected\n        # - 'Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko'  # too many false positives expected\n        - 'Mozilla/5.0 (Windows NT 6.3; rv:39.0) Gecko/20100101 Firefox/35.0'\n        - 'Sametime Community Agent'  # Unknown if prone to false positives - used in https://goo.gl/gHZkeR\n        - 'X-FORWARDED-FOR'\n        - 'DotDotPwn v2.1'\n        - 'SIPDROID'\n        # Exploits\n        - '*wordpress hash grabber*'\n        - '*exploit*'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/proxy/proxy_ua_frameworks.yml", "title": "sigma: Exploit Framework User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "c1512d6d980e3cee09097943215b84358cb7dce9238f8765b3344769d65cdbfa", "level": "high"}, "MLMx42IB8Wx35J1-ZM34": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:47.926511", "user_id": null, "views": 8, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious User Agent", "released": "2018-04-20T13:14:47.926508", "sigma_text": "title: Suspicious User Agent\nstatus: experimental\ndescription: Detects suspicious malformed user agent strings in proxy logs\nreferences:\n    - https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Badly scripted UA\n        - 'user-agent'  # User-Agent: User-Agent:\n        - '* (compatible;MSIE *'  # typical typo - missing space\n        - '*.0;Windows NT *'  # typical typo - missing space\n        - 'Mozilla/3.0 *'\n        - 'Mozilla/2.0 *'\n        - 'Mozilla/1.0 *'\n        - 'Mozilla *'  # missing slash\n        - ' Mozilla/*'  # leading space \n        - 'Mozila/*'  # single 'l'\n        - '_'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/proxy/proxy_ua_suspicious.yml", "title": "sigma: Suspicious User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 6, "hash": "1eb1c812c3308ec3de10e607a5566f2e0df3130f3921c7dfd7c335e772079f95", "level": "high"}, "tjwdG2YBatiiaHt9iySU": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:20.238112", "author_keyword": "Thomas Patzke", "user_id": null, "title": "WCE wceaux.dll Access", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "WCE wceaux.dll Access", "released": "2018-09-27T12:58:20.238110", "sigma_text": "title: WCE wceaux.dll Access\nstatus: experimental\ndescription: Detects wceaux.dll access while WCE pass-the-hash remote command execution on source host\nauthor: Thomas Patzke\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\ntags:\n    - attack.credential_access\n    - attack.t1003\n    - attack.s0005\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4658\n            - 4660\n            - 4663\n        ObjectName: '*\\wceaux.dll'\n    condition: selection\nfalsepositives: \n    - Penetration testing\nlevel: critical\n", "git_filepath": "/windows/builtin/win_mal_wceaux_dll.yml", "hash": "4cb204f4744ef7ea4b28ebc7c281c9acc613d0f0b10afe47abae3c916ba5b605", "level": "critical", "is_verified": false, "downloads": 0}, "nzwdG2YBatiiaHt9eCS9": {"status": "", "category": null, "updated": "2018-09-27T12:58:15.414273", "author_keyword": "Florian Roth", "user_id": null, "title": "StoneDrill Service Install", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "StoneDrill Service Install", "released": "2018-09-27T12:58:15.414270", "sigma_text": "title: StoneDrill Service Install\ndescription: 'This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky'   \nauthor: Florian Roth\nreferences:\n    - https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\ntags:\n    - attack.persistence\n    - attack.g0064\n    - attack.t1050\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName: NtsSrv\n        ServiceFileName: '* LocalService'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n", "git_filepath": "/apt/apt_stonedrill.yml", "hash": "100a4ade83ce69288757337177efbdfb3621146043356374e40017559e5353fb", "level": "high", "is_verified": false, "downloads": 0}, "ObMx42IB8Wx35J1-gM3k": {"status": "", "category": 2, "updated": "2018-04-20T13:14:55.075554", "user_id": null, "views": "9", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: StoneDrill Service Install", "released": "2018-04-20T13:14:55.075551", "sigma_text": "title: StoneDrill Service Install\ndescription: 'This method detects a service install of the malicious Microsoft Network Realtime Inspection Service service described in StoneDrill report by Kaspersky'   \nauthor: Florian Roth\nreferences:\n    - https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName: NtsSrv\n        ServiceFileName: '* LocalService'\n    condition: selection\nfalsepositives:\n    - Unlikely\nlevel: high\n", "git_filepath": "/apt/apt_stonedrill.yml", "title": "sigma: StoneDrill Service Install", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "5d962fa85cf937b742df5c266e3ebc96f9111ac2dca960a2a1f7c8ac6c2fdd2e", "level": "high"}, "_rMw42IB8Wx35J1-xczo": {"status": "", "category": 15, "updated": "2018-04-20T13:14:07.207142", "user_id": null, "title": "sigma: Password Dumper Remote Thread in LSASS", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Password Dumper Remote Thread in LSASS", "released": "2018-04-20T13:14:07.207139", "sigma_text": "title: Password Dumper Remote Thread in LSASS \ndescription: Detects password dumper activity by monitoring remote thread creation EventID 8 in combination with the lsass.exe process as TargetImage. The process in field Process is the malicious program. A single execution can lead to hundrets of events.\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 8\n        TargetImage: 'C:\\Windows\\System32\\lsass.exe'\n        StartModule: null\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_password_dumper_lsass.yml", "hash": "57712ab115a4210a27726f1a485b697437b1e18f0a76ea5df8e5e34f28b268b6", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 0, "level": "high"}, "A7Mw42IB8Wx35J1-1c2r": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:11.241617", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: PowerShell Network Connections", "released": "2018-04-20T13:14:11.241614", "sigma_text": "title: PowerShell Network Connections\nstatus: experimental\ndescription: \"Detetcs a Powershell process that opens network connections - check for suspicious target ports and target systems - adjust to your environment (e.g. extend filters with company's ip range')\"  \nauthor: Florian Roth\nreferences:\n    - https://www.youtube.com/watch?v=DLtJTxMWZ2o\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\powershell.exe'\n    filter:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.*'\n            - '127.0.0.1'\n        DestinationIsIpv6: 'false'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative scripts\nlevel: low\n", "git_filepath": "/windows/sysmon/sysmon_powershell_network_connection.yml", "title": "sigma: PowerShell Network Connections", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "de262c4e196ab247e83a08457a75ec2239339c22f1193459927a16a126265629", "level": "low"}, "pTwdG2YBatiiaHt9fSSa": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:16.660228", "author_keyword": "Florian Roth", "user_id": null, "title": "Eventlog Cleared", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Eventlog Cleared", "released": "2018-09-27T12:58:16.660225", "sigma_text": "title: Eventlog Cleared\nstatus: experimental\ndescription: Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution  \nauthor: Florian Roth\ndate: 2017/06/27\nreferences:\n    - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n        Source: Eventlog\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_eventlog_cleared.yml", "hash": "090495eeac6d8bae590f15802a31f801addaa9ac7d6fe6c8e64039ae9f01df32", "level": "high", "is_verified": false, "downloads": 0}, "M7Mx42IB8Wx35J1-bs0t": {"status": "", "category": 6, "updated": "2018-04-20T13:14:50.283914", "user_id": null, "views": 11, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Webshell Detection by Keyword", "released": "2018-04-20T13:14:50.283911", "sigma_text": "title: Webshell Detection by Keyword\ndescription: Detects webshells that use GET requests by keyword sarches in URL strings\nauthor: Florian Roth\nlogsource:\n    category: webserver\ndetection:\n    keywords:\n        - '=whoami'\n        - '=net%20user'\n        - '=cmd%20/c%20'\n    condition: keywords\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Web sites like wikis with articles on os commands and pages that include the os commands in the URLs\n    - User searches in search boxes of the respective website\nlevel: high\n", "git_filepath": "/web/web_webshell_keyword.yml", "title": "sigma: Webshell Detection by Keyword", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 2, "hash": "d56dced1395e8ca464a1b6baa9720b4d8f3319519fb9e46bd3c92cfd1a1eb89a", "level": "high"}, "jzwdG2YBatiiaHt9bCQG": {"status": "", "category": null, "updated": "2018-09-27T12:58:12.155187", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Multiple suspicious Response Codes caused by Single Client", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Multiple suspicious Response Codes caused by Single Client", "released": "2018-09-27T12:58:12.155185", "sigma_text": "title: Multiple suspicious Response Codes caused by Single Client\ndescription: Detects possible exploitation activity or bugs in a web application\nauthor: Thomas Patzke\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        response:\n          - 400\n          - 401\n          - 403\n          - 500\n    timeframe: 10m\n    condition: selection | count() by clientip > 10\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Unstable application\n    - Application that misuses the response codes\nlevel: medium\n", "git_filepath": "/web/web_multiple_suspicious_resp_codes_single_source.yml", "hash": "f794f2ae6d817e5bc12f0a777ad30baa0f1d6868907cf037ebb23fc65a53e778", "level": "medium", "is_verified": false, "downloads": 0}, "HLMx42IB8Wx35J1-JM2u": {"status": "", "category": null, "updated": "2018-04-20T13:14:31.469010", "user_id": null, "views": "2", "permission_id": 3, "author": "Karneades", "mitre_attack": null, "title_keyword": "sigma: Registry Persistence Mechanisms", "released": "2018-04-20T13:14:31.469007", "sigma_text": "title: Registry Persistence Mechanisms\ndescription: Detects persistence registry keys. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection_reg1d\"\nreferences:\n    - https://oddvar.moe/2018/04/10/persistence-using-globalflags-in-image-file-execution-options-hidden-from-autoruns-exe/\ndate: 2018/04/11\nauthor: Karneades\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection_reg1:\n        EventID: 13 \n        TargetObject: \n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\*\\GlobalFlag'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\ReportingMode'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SilentProcessExit\\*\\MonitorProcess'\n        EventType: 'SetValue'\n    condition: selection_reg1\nfalsepositives:\n    - unknown\nlevel: critical\n", "git_filepath": null, "title": "sigma: Registry Persistence Mechanisms", "author_keyword": "Karneades", "is_verified": false, "downloads": 0, "hash": "846b78fe114fb384eb0287c2356a5ac6186986810fd5891db38e46841dd655ea", "level": "critical"}, "xLMw42IB8Wx35J1-DczK": {"status": "", "category": 11, "updated": "2018-04-20T13:13:20.072552", "user_id": null, "views": 1, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Malicious Service Install", "released": "2018-04-20T13:13:20.072549", "sigma_text": "title: Malicious Service Install\ndescription: This method detects well-known keywords of malicious services in the Windows System Eventlog \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: \n          - 7045\n          - 4697\n    keywords:\n      - 'WCE SERVICE'\n      - 'WCESERVICE'\n      - 'DumpSvc'\n    quarkspwdump:\n        EventID: 16\n        HiveName: '*\\AppData\\Local\\Temp\\SAM*.dmp'\n    condition: ( selection and keywords ) or quarkspwdump\nfalsepositives:\n    - Unlikely\nlevel: high\n", "git_filepath": "/windows/builtin/win_mal_creddumper.yml", "title": "sigma: Malicious Service Install", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "77fefcb9b9909026f0520fa0f5982be015310e2563b5c68f0682e8f3b855518d", "level": "high"}, "sAL91GMBqfpvXJhTggyl": {"status": "testing", "category": "", "updated": "2018-06-06T12:31:07Z", "user_id": "80", "views": 19, "downloads": 0, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: FlawedAmmyy RAT Detection (Proxy).", "released": "2018-06-06T12:06:13Z", "sigma_text": "title: FlawedAmmyy RAT Detection (Proxy).\ndescription: FlawedAmmyy RAT Detection Through Proxy.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n- https://www.proofpoint.com/us/threat-insight/post/leaked-source-code-ammyy-admin-turned-flawedammyy-rat\ndate: 2018/03/07\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection1:\n    Request Url:\n    - http://chimachinenow.com\n    - http://highlandfamily.org\n    - http://intra.cfecgcaquitaine.com\n    - http://motifahsap.com\n    - http://sittalhaphedver.com\n    - http://wassronledorhad.in\n    - http://balzantruck.com\n    - http://185.176.221.54\n  condition: selection1\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Standard Application Layer Protocol", "title": "sigma: FlawedAmmyy RAT Detection (Proxy).", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "8af157c57d9fe525b60f9ea17e43351a91d73e9e46ddc036476939bf21804645", "level": "medium"}, "ALMw42IB8Wx35J1-zM0-": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:08.828232", "user_id": null, "views": "2", "permission_id": 3, "author": "Omer Yampel", "mitre_attack": null, "title_keyword": "sigma: UAC Bypass via sdclt", "released": "2018-04-20T13:14:08.828230", "sigma_text": "title: UAC Bypass via sdclt\nstatus: experimental\ndescription: Detects changes to HKCU:\\Software\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand\nreferences:\n    - https://enigma0x3.net/2017/03/17/fileless-uac-bypass-using-sdclt-exe/\nauthor: Omer Yampel\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 13 \n        TargetObject: 'HKEY_USERS\\*\\Classes\\exefile\\shell\\runas\\command\\isolatedCommand'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_uac_bypass_sdclt.yml", "title": "sigma: UAC Bypass via sdclt", "author_keyword": "Omer Yampel", "is_verified": false, "downloads": 0, "hash": "f9d43fe52e4c817633911f70b8fb53090f033ddebd4bc28c93adb4e60ee49388", "level": "high"}, "aQLRtWMBqfpvXJhTPQzE": {"status": "testing", "category": "", "updated": "2018-06-01T08:33:42Z", "user_id": "80", "views": 35, "downloads": 9, "author": "Alexandr Yamposlkyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: MuddyWater APT.", "released": "2018-05-31T10:49:39Z", "sigma_text": "title: MuddyWater APT.\ndescription: MuddyWater  APT Detector.\nreferences:\n- https://reaqta.com/2017/11/muddywater-apt-targeting-middle-east/\nauthor: Alexandr Yamposlkyi, SOC Prime\nstatus: testing\ndate: 2017/11/22\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection1:\n    EventID: \"1\"\n    file_hash:\n    - 4121db476b66241610985350b825b9f1680d0171ab01a52b5ffcb56481521e44\n    - a0abec361411cb11e01337939013bad1f54ad5865c73604a1b360d68ddfbd96a\n    - b2c10621c9c901f0f692cae0306baa840105231f35e6ec36e41b88eebd46df4c\n    - 16bcb6cc38347a722bb7682799e9d9da40788e3ca15f29e46b475efe869d0a04\n  selection2:\n    EventID: \"11\"\n  TargetFilename:\n  - C:\\Windows\\System32\\Tasks\\WindowsOptimizationsService\n  - C:\\Windows\\System32\\Tasks\\Microsoft\\WindowsOptimizationsService\n  condition: selection1 or selection2\nfields:\n- TargetFilename\n- Image\n- TargetObject\n- Hashes\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Execution:\n  - Command-Line Interface\n  - Scheduled Task", "title": "sigma: MuddyWater APT.", "author_keyword": "Alexandr Yamposlkyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "094a728dcf22c8d5405349a9b76a925b5bd18c36a48676115a6b5134a5c34a22", "level": "high"}, "xbMw42IB8Wx35J1-EMzg": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:20.862600", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Rare Schtasks Creations", "released": "2018-04-20T13:13:20.862597", "sigma_text": "title: Rare Schtasks Creations\ndescription: Detects rare scheduled tasks creations that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious code\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\n    description: 'The Advanced Audit Policy setting Object Access > Audit Other Object Access Events has to be configured to allow this detection (not in the baseline recommendations by Microsoft). We also recommend extracting the Command field from the embedded XML in the event data.'\ndetection:\n    selection:\n        EventID: 4698\n    timeframe: 7d\n    condition: selection | count(TaskName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n", "git_filepath": "/windows/builtin/win_rare_schtasks_creations.yml", "title": "sigma: Rare Schtasks Creations", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "08be97fccd3fff00cc0110e5f4d7d8f12ad89b34e30dee0de8a4f26db612a336", "level": "low"}, "hTwdG2YBatiiaHt9YyS-": {"status": "", "category": null, "updated": "2018-09-27T12:58:10.039929", "author_keyword": null, "user_id": null, "title": "Buffer Overflow Attempts", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Buffer Overflow Attempts", "released": "2018-09-27T12:58:10.039925", "sigma_text": "title: Buffer Overflow Attempts\ndescription: Detects buffer overflow attempts in Unix system log files\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml\nlogsource:\n    product: unix\ndetection:\n    keywords:\n        - 'attempt to execute code on stack by'\n        - 'FTP LOGIN FROM .* 0bin0sh'\n        - 'rpc.statd[\\d+]: gethostbyname error for'\n        - 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n    condition: keywords\nfalsepositives:\n    - Unkown\nlevel: high\n", "git_filepath": "/linux/lnx_buffer_overflows.yml", "hash": "b9a27413d6db2a9f8224e93a0c3b6ed7ff08aba9e9bf9357f830f4ff15ed9693", "level": "high", "is_verified": false, "downloads": 0}, "z7Mw42IB8Wx35J1-McwK": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:29.096936", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Rare Service Installs", "released": "2018-04-20T13:13:29.096933", "sigma_text": "title: Rare Service Installs\ndescription: Detects rare service installs that only appear a few times per time frame and could reveal password dumpers, backdoor installs or other types of malicious services \nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    timeframe: 7d\n    condition: selection | count(ServiceFileName) < 5 \nfalsepositives: \n    - Software installation\n    - Software updates\nlevel: low\n", "git_filepath": "/windows/builtin/win_rare_service_installs.yml", "title": "sigma: Rare Service Installs", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "e57ce95ff3e9ef49849e555acbc3f18846f63dbe1d4b8b02ea24850260d6ce3e", "level": "low"}, "y7Mw42IB8Wx35J1-JMya": {"status": "stable", "category": 11, "updated": "2018-04-20T13:13:25.909595", "user_id": null, "views": "1", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Addition of SID History to Active Directory Object", "released": "2018-04-20T13:13:25.909592", "sigma_text": "title: Addition of SID History to Active Directory Object\nstatus: stable\ndescription: An attacker can use the SID history attribute to gain additional privileges.\nreferences:\n    - https://adsecurity.org/?p=1772\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4765\n            - 4766\n    condition: selection\nfalsepositives:\n    - Migration of an account into a new domain\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_add_sid_history.yml", "title": "sigma: Addition of SID History to Active Directory Object", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 1, "hash": "a847f8bda8c49b4ac851346ac074fca40f56881da986c935e7078bce89f4d7db", "level": "medium"}, "4LMw42IB8Wx35J1-Zsw6": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:42.713351", "user_id": null, "views": 2, "permission_id": 3, "author": "Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Suspicious PowerShell Invocations - Generic", "released": "2018-04-20T13:13:42.713347", "sigma_text": "title: Suspicious PowerShell Invocations - Generic\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation command parameters. Modified by SOC Prime, replaced condition \"all of them\" with \"encoded and hidden and noninteractive\"\nauthor: Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\ndetection:\n    encoded:\n        - ' -enc '\n        - ' -EncodedCommand '\n    hidden:\n        - ' -w hidden '\n        - ' -window hidden '\n        - ' - windowstyle hidden '\n    noninteractive:\n        - ' -noni '\n        - ' -noninteractive '\n    condition: encoded and hidden and noninteractive\nfalsepositives:\n    - Penetration tests\n    - Very special / sneaky PowerShell scripts\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_suspicious_invocation_generic.yml", "title": "sigma: Suspicious PowerShell Invocations - Generic", "author_keyword": "Florian Roth (rule)", "is_verified": true, "downloads": 3, "hash": "cc5ed189cc6f44a2672d692c3f3f50c3aa6402b187af269ac30917ea41578473", "level": "high"}, "GLMx42IB8Wx35J1-GM1J": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:28.296154", "user_id": null, "views": "2", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Taskmgr as Parent", "released": "2018-04-20T13:14:28.296151", "sigma_text": "title: Taskmgr as Parent\nstatus: experimental\ndescription: Detects the creation of a process from Windows task manager\nauthor: Florian Roth\ndate: 2018/03/13\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\taskmgr.exe'\n    filter:\n        Image: \n            - 'resmon.exe'\n            - 'mmc.exe'\n    condition: selection and not filter\nfields:\n    - Image\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\nlevel: low\n", "git_filepath": "/windows/sysmon/sysmon_susp_taskmgr_parent.yml", "title": "sigma: Taskmgr as Parent", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "691dd40f77028c4773c47a82c097303b4b008796ac8f1a78abcb0c593dc48a12", "level": "low"}, "IbMx42IB8Wx35J1-NM1v": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:35.501494", "user_id": null, "views": 2, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Droppers exploiting CVE-2017-11882", "released": "2018-04-20T13:14:35.501491", "sigma_text": "title: Droppers exploiting CVE-2017-11882\nstatus: experimental\ndescription: Detects exploits that use CVE-2017-11882 to start EQNEDT32.EXE and other sub processes like mshta.exe\nreferences:\n    - https://www.hybrid-analysis.com/sample/2a4ae284c76f868fc51d3bb65da8caa6efacb707f265b25c30f34250b76b7507?environmentId=100\n    - https://www.google.com/url?hl=en&q=https://embedi.com/blog/skeleton-closet-ms-office-vulnerability-you-didnt-know-about&source=gmail&ust=1511481120837000&usg=AFQjCNGdL7gVwLXaNSl2Td8ylDYbSJFmPw\nauthor: Florian Roth\ndate: 2017/11/23\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\EQNEDT32.EXE'\n    condition: selection\nfields:\n    - CommandLine\nfalsepositives:\n    - unknown\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_11882.yml", "title": "sigma: Droppers exploiting CVE-2017-11882", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "6f81291f4cde9cc66f52c38e3cf7579ed5466dc7f29ff0d87b7f423ebd72b503", "level": "critical"}, "9bMw42IB8Wx35J1-qMyz": {"status": "", "category": 15, "updated": "2018-04-20T13:13:59.729412", "user_id": null, "title": "sigma: Exploit for CVE-2017-8759", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Exploit for CVE-2017-8759", "released": "2018-04-20T13:13:59.729409", "sigma_text": "title: Exploit for CVE-2017-8759 \ndescription: Detects Winword starting uncommon sub process csc.exe as used in exploits for CVE-2017-8759\nreferences:\n  - https://www.hybrid-analysis.com/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\n  - https://www.reverse.it/sample/0b4ef455e385b750d9f90749f1467eaf00e46e8d6c2885c260e1b78211a51684?environmentId=100\nauthor: Florian Roth\ndate: 15.09.2017\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\csc.exe'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2017_8759.yml", "hash": "fe4e5584feca381b99fe09991786be565f118ab7343e71ecdea5e4a403264f1e", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "critical"}, "ubMv42IB8Wx35J1-68xy": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:11.280643", "user_id": null, "views": "1", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Secure Deletion with SDelete", "released": "2018-04-20T13:13:11.280640", "sigma_text": "title: Secure Deletion with SDelete\nstatus: experimental\ndescription: Detects renaming of file while deletion with SDelete tool\nauthor: Thomas Patzke\nreferences:\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://technet.microsoft.com/en-us/en-en/sysinternals/sdelete.aspx\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4656\n            - 4663\n            - 4658\n        ObjectName:\n            - '*.AAA'\n            - '*.ZZZ'\n    condition: selection\nfalsepositives:\n    - Legitime usage of SDelete\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_sdelete.yml", "title": "sigma: Secure Deletion with SDelete", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "6498ba75054895d87be9ca0fa4067d3e586ed671e5b0cc304c7f0ad85f09bcc4", "level": "medium"}, "kzwdG2YBatiiaHt9byQv": {"status": "", "category": null, "updated": "2018-09-27T12:58:12.969051", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Ruby on Rails framework exceptions", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Ruby on Rails framework exceptions", "released": "2018-09-27T12:58:12.969048", "sigma_text": "title: Ruby on Rails framework exceptions\ndescription: Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - http://edgeguides.rubyonrails.org/security.html\n    - http://guides.rubyonrails.org/action_controller_overview.html\n    - https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception\n    - https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb\nlogsource:\n    category: application\n    product: ruby_on_rails\ndetection:\n    keywords:\n        - ActionController::InvalidAuthenticityToken\n        - ActionController::InvalidCrossOriginRequest\n        - ActionController::MethodNotAllowed\n        - ActionController::BadRequest\n        - ActionController::ParameterMissing\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_ruby_on_rails_exceptions.yml", "hash": "fc37278a20a4219a2b968eca569332e64a60b7777a2eaab62a2256817bd6c122", "level": "medium", "is_verified": false, "downloads": 0}, "zbMw42IB8Wx35J1-KszD": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:27.489837", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: USB Device Plugged", "released": "2018-04-20T13:13:27.489834", "sigma_text": "title: USB Device Plugged\ndescription: Detects plugged USB devices\nreferences:\n    - https://df-stream.com/2014/01/the-windows-7-event-log-and-usb-device/\n    - https://www.techrepublic.com/article/how-to-track-down-usb-flash-drive-usage-in-windows-10s-event-viewer/\nstatus: experimental\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: driver-framework\ndetection:\n    selection:\n        EventID: \n            - 2003  # Loading drivers\n            - 2100  # Pnp or power management\n            - 2102  # Pnp or power management\n    condition: selection\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n", "git_filepath": "/windows/builtin/win_usb_device_plugged.yml", "title": "sigma: USB Device Plugged", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "653b702c699ae891d48bbb1faedf458d7a7c94e7df71e4a5aba4ad90d42f28fc", "level": "low"}, "PbMx42IB8Wx35J1-jc1E": {"status": "", "category": 2, "updated": "2018-04-20T13:14:58.242500", "user_id": null, "views": 20, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: ZxShell Malware", "released": "2018-04-20T13:14:58.242496", "sigma_text": "title: ZxShell Malware\ndescription: Detects a ZxShell start by the called and well-known function name   \nauthor: Florian Roth\nreferences:\n    - https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Command: \n            - 'rundll32.exe *,zxFunction*'\n            - 'rundll32.exe *,RemoteDiskXXXXX'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/apt/apt_zxshell.yml", "title": "sigma: ZxShell Malware", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "002550a5c4732925fe002c60c540bab06a505776b1e973fd5f7735b250f9315b", "level": "critical"}, "3LMw42IB8Wx35J1-Wcy3": {"status": "experimental", "category": 13, "updated": "2018-04-20T13:13:39.509148", "user_id": null, "views": 2, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Rare Scheduled Task Creations", "released": "2018-04-20T13:13:39.509145", "sigma_text": "title: Rare Scheduled Task Creations\nstatus: experimental\ndescription: This rule detects rare scheduled task creations. Typically software gets installed on multiple systems and not only on a few. The aggregation and count function selects tasks with rare names. \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: taskscheduler\ndetection:\n    selection:\n        EventID: 106\n    timeframe: 7d\n    condition: selection | count() by TaskName < 5 \nfalsepositives:\n    - Software installation\nlevel: low\n", "git_filepath": "/windows/other/win_rare_schtask_creation.yml", "title": "sigma: Rare Scheduled Task Creations", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "b76611b1fd5b11565f6da669a48d85e8f69b85461cdf7dac56866753e11afdfc", "level": "low"}, "q7Mv42IB8Wx35J1-vswE": {"status": "", "category": 3, "updated": "2018-04-20T13:12:59.651881", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious SSHD Error", "released": "2018-04-20T13:12:59.651878", "sigma_text": "title: Suspicious SSHD Error\ndescription: Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/openssh/openssh-portable/blob/master/ssherr.c\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml\nauthor: Florian Roth\ndate: 2017/06/30\nlogsource:\n    product: linux\n    service: sshd\ndetection:\n    keywords:\n        - '*unexpected internal error*'\n        - '*unknown or unsupported key type*'\n        - '*invalid certificate signing key*'\n        - '*invalid elliptic curve value*'\n        - '*incorrect signature*'\n        - '*error in libcrypto*'\n        - '*unexpected bytes remain after decoding*'\n        - '*fatal: buffer_get_string: bad string*'\n        - '*Local: crc32 compensation attack*'\n        - '*bad client public DH value*'\n        - '*Corrupted MAC on input*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_susp_ssh.yml", "title": "sigma: Suspicious SSHD Error", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "5d7cbf03995553e77db9da9118dedb7a7d979b9905bb7b16e1ffab537150ecd1", "level": "medium"}, "srMv42IB8Wx35J1-1cyK": {"status": "", "category": 11, "updated": "2018-04-20T13:13:05.673712", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Malicious Service Installations", "released": "2018-04-20T13:13:05.673710", "sigma_text": "title: Malicious Service Installations\ndescription: Detects known malicious service installs that only appear in cases of lateral movement, credential dumping and other suspicious activity. Modified by SOC Prime, replaced condition \"selection and 1 of malsvc_*\" with \"keywords and not filters\"\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n    malsvc_wce:\n        ServiceName: \n            - 'WCESERVICE'\n            - 'WCE SERVICE'\n    malsvc_paexec:\n        ServiceFileName: '*\\PAExec*'\n    malsvc_winexe:\n        ServiceFileName: 'winexesvc.exe*'\n    malsvc_pwdumpx:\n        ServiceFileName: '*\\DumpSvc.exe'\n    malsvc_wannacry:\n        ServiceName: 'mssecsvc2.0'\n    malsvc_persistence:\n        ServiceFileName: '* net user *'\n    malsvc_others:\n        ServiceName:\n            - 'pwdump*'\n            - 'gsecdump*'\n            - 'cachedump*'\n    condition: selection and (malsvc_wce or malsvc_paexec or malsvc_winexe or malsvc_pwdumpx or malsvc_wannacry or malsvc_persistence or malsvc_others)\nfalsepositives: \n    - Penetration testing\nlevel: critical\n", "git_filepath": "/windows/builtin/win_mal_service_installs.yml", "title": "sigma: Malicious Service Installations", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 2, "hash": "f6aa6e14aefd98fb386a7daa61b162f6458628a4f7564b029477f34dac13431a", "level": "critical"}, "t7Mv42IB8Wx35J1-5cwe": {"status": "", "category": 11, "updated": "2018-04-20T13:13:09.660798", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Relevant Anti-Virus Event", "released": "2018-04-20T13:13:09.660795", "sigma_text": "title: Relevant Anti-Virus Event\ndescription: This detection method points out highly relevant Antivirus events. Modified by SOC Prime, replaced condition \"keywords and not 1 of filters\" with \"keywords and not filters\"\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: application\ndetection:\n    keywords:\n        - HTool\n        - Hacktool\n        - ASP/Backdoor\n        - JSP/Backdoor\n        - PHP/Backdoor\n        - Backdoor.ASP\n        - Backdoor.JSP\n        - Backdoor.PHP\n        - Webshell\n        - Portscan\n        - Mimikatz\n        - WinCred\n        - PlugX\n        - Korplug\n        - Pwdump\n        - Chopper\n        - WmiExec\n        - Xscan\n        - Clearlog\n        - ASPXSpy\n    filters:\n        - Keygen\n        - Crack\n    condition: keywords and not filters\nfalsepositives:\n    - Some software piracy tools (key generators, cracks) are classified as hack tools\nlevel: high\n", "git_filepath": "/windows/builtin/win_av_relevant_match.yml", "title": "sigma: Relevant Anti-Virus Event", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 3, "hash": "dc40322cad8b98ab635c2aff0287d1f529c75c8220f2817becc4657750fb9d24", "level": "high"}, "OwKCjWMBqfpvXJhT2wwM": {"status": "testing", "category": "", "updated": "2018-06-01T12:00:38Z", "user_id": "3518", "views": 49, "downloads": 1, "author": "Eugene Nechiporenko, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Detection MavInject32.exe (Microsoft Corp Signed) execution", "released": "2018-05-23T14:59:13Z", "sigma_text": "title: Detection MavInject32.exe (Microsoft Corp Signed) execution\ndescription: This rule detects execution and usage MavInject32.exe (Microsoft Corp Signed) that allows to load any dll in a running process.\nauthor: Eugene Nechiporenko, SOC Prime\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    ParentImage:\n    - '*\\cmd.exe'\n    Image:\n    - C:\\Program Files\\Common Files\\microsoft shared\\ClickToRun\\MavInject32.exe\n    ParentCommandLine:\n    - '*\\cmd.exe'\n    CommandLine:\n    - '*\\MavInject32.exe*'\n  keyword:\n  - INJECTRUNNING\n  condition: selection or keyword\nfields:\n- ParentCommandLine\n- ParentImage\n- CommandLine\n- Image\nfalsepositives:\n- Unknown\nlevel: high\ndate: 2018/05/31\nreference:\n- https://twitter.com/gn3mes1s/status/941315826107510784\nmitre-attack:\n  Privilege Escalation:\n  - DLL Search Order Hijacking\n  - Process Injection\n  Defense Evasion:\n  - Process Injection", "title": "sigma: Detection MavInject32.exe (Microsoft Corp Signed) execution", "author_keyword": "Eugene Nechiporenko, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "1f7dde16ce78a22f3e86c699f1ad8de45b15cc092f3eb759007e4703c58575b6", "level": "high"}, "MbMx42IB8Wx35J1-aM0O": {"status": "", "category": 6, "updated": "2018-04-20T13:14:48.716492", "user_id": null, "views": 5, "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Multiple suspicious Response Codes caused by Single Client", "released": "2018-04-20T13:14:48.716489", "sigma_text": "title: Multiple suspicious Response Codes caused by Single Client\ndescription: Detects possible exploitation activity or bugs in a web application\nauthor: Thomas Patzke\nlogsource:\n    category: webserver\ndetection:\n    selection:\n        response:\n          - 400\n          - 401\n          - 403\n          - 500\n    timeframe: 10m\n    condition: selection | count() by clientip > 10\nfields:\n    - client_ip\n    - vhost\n    - url\n    - response\nfalsepositives:\n    - Unstable application\n    - Application that misuses the response codes\nlevel: medium\n", "git_filepath": "/web/web_multiple_suspicious_resp_codes_single_source.yml", "title": "sigma: Multiple suspicious Response Codes caused by Single Client", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 1, "hash": "f794f2ae6d817e5bc12f0a777ad30baa0f1d6868907cf037ebb23fc65a53e778", "level": "medium"}, "17Mw42IB8Wx35J1-SsxG": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:35.556144", "user_id": null, "title": "sigma: DHCP Server Loaded the CallOut DLL", "permission_id": 3, "author": "Dimitrios Slamaris", "mitre_attack": null, "title_keyword": "sigma: DHCP Server Loaded the CallOut DLL", "released": "2018-04-20T13:13:35.556142", "sigma_text": "title: DHCP Server Loaded the CallOut DLL\nstatus: experimental\ndescription: This rule detects a DHCP server in which a specified Callout DLL (in registry) was loaded\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 1033\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "git_filepath": "/windows/builtin/win_susp_dhcp_config.yml", "hash": "437e0cdd3795ec6f32598db0a2c77ec3c58af1c6d64d5432b9f04ed1904c0589", "author_keyword": "Dimitrios Slamaris", "is_verified": false, "downloads": 0, "level": "critical"}, "fDwCJmMB_9rlszZ2DM9G": {"status": "testing", "category": "", "updated": "2018-05-10T09:24:38Z", "user_id": "80", "views": 40, "downloads": 0, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Lojack Double-Agent Communication", "released": "2018-05-03T12:37:38Z", "sigma_text": "title: Lojack Double-Agent Communication\ndescription: Lojack Double-Agent Communication Detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences: https://asert.arbornetworks.com/lojack-becomes-a-double-agent/\ndate: 2008/04/01\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection:\n    r-dns:\n    - sysanalyticweb.com\n    - elaxo.org\n    - ikmtrust.com\n    - lxwo.org\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: Lojack Double-Agent Communication", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "79a82c212d1e4a26157fc50f4311fec40d09a37f30a310a121301f0083d2dd1e", "level": "medium"}, "yrMw42IB8Wx35J1-IMy3": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:24.917521", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Executable used by PlugX in Uncommon Location", "released": "2018-04-20T13:13:24.917517", "sigma_text": "title: Executable used by PlugX in Uncommon Location\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - 'http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/'\n    - 'https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/'\nauthor: Florian Roth\ndate: 2017/06/12\nlogsource:\n    product: windows\n    service: security\ndetection:\n    # CamMute\n    selection_cammute:\n        EventID: 4688\n        CommandLine: '*\\CamMute.exe'\n    filter_cammute:\n        EventID: 4688\n        CommandLine: '*\\Lenovo\\Communication Utility\\*'\n    # Chrome Frame Helper\n    selection_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        EventID: 4688\n        CommandLine: '*\\Google\\Chrome\\application\\*'    \n    # Microsoft Device Emulator\n    selection_devemu:\n        EventID: 4688\n        CommandLine: '*\\dvcemumanager.exe'\n    filter_devemu:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Device Emulator\\*'   \n    # Windows Media Player Gadget\n    selection_gadget:\n        EventID: 4688\n        CommandLine: '*\\Gadget.exe'\n    filter_gadget:\n        EventID: 4688\n        CommandLine: '*\\Windows Media Player\\*'\n    # HTML Help Workshop\n    selection_hcc:\n        EventID: 4688\n        CommandLine: '*\\hcc.exe'\n    filter_hcc:\n        EventID: 4688\n        CommandLine: '*\\HTML Help Workshop\\*'\n    # Hotkey Command Module for Intel Graphics Contollers\n    selection_hkcmd:\n        EventID: 4688\n        CommandLine: '*\\hkcmd.exe'\n    filter_hkcmd:\n        EventID: 4688\n        CommandLine: \n            - '*\\System32\\*'\n            - '*\\SysNative\\*'\n            - '*\\SysWowo64\\*'\n    # McAfee component\n    selection_mc:\n        EventID: 4688\n        CommandLine: '*\\Mc.exe'\n    filter_mc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    # MsMpEng - Microsoft Malware Protection Engine\n    selection_msmpeng:\n        EventID: 4688\n        CommandLine: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Security Client\\*'\n            - '*\\Windows Defender\\*'\n            - '*\\AntiMalware\\*'\n    # Microsoft Security Center\n    selection_msseces:\n        EventID: 4688\n        CommandLine: '*\\msseces.exe'\n    filter_msseces:\n        EventID: 4688\n        CommandLine: '*\\Microsoft Security Center\\*'\n    # Microsoft Office 2003 OInfo\n    selection_oinfo:\n        EventID: 4688\n        CommandLine: '*\\OInfoP11.exe'\n    filter_oinfo:\n        EventID: 4688\n        CommandLine: '*\\Common Files\\Microsoft Shared\\*'      \n    # OLE View\n    selection_oleview:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_oleview:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n    # RC\n    selection_rc:\n        EventID: 4688\n        CommandLine: '*\\OleView.exe'\n    filter_rc:\n        EventID: 4688\n        CommandLine: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n            - '*\\Microsoft.NET\\*'  \n    condition: ( selection_cammute and not filter_cammute ) or  \n                ( selection_chrome_frame and not filter_chrome_frame ) or\n                ( selection_devemu and not filter_devemu ) or\n                ( selection_gadget and not filter_gadget ) or \n                ( selection_hcc and not filter_hcc ) or \n                ( selection_hkcmd and not filter_hkcmd ) or \n                ( selection_mc and not filter_mc ) or\n                ( selection_msmpeng and not filter_msmpeng ) or\n                ( selection_msseces and not filter_msseces ) or\n                ( selection_oinfo and not filter_oinfo ) or \n                ( selection_oleview and not filter_oleview ) or \n                ( selection_rc and not filter_rc ) \nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_plugx_susp_exe_locations.yml", "title": "sigma: Executable used by PlugX in Uncommon Location", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "0a4710e840cb2e6648e2ce8d7e7c8da572e5c816f003aa64ad2bf595747fc7c9", "level": "high"}, "qjwdG2YBatiiaHt9giQ2": {"status": "stable", "category": null, "updated": "2018-09-27T12:58:17.716263", "author_keyword": "Florian Roth", "user_id": null, "title": "User Added to Local Administrators", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "User Added to Local Administrators", "released": "2018-09-27T12:58:17.716259", "sigma_text": "title: User Added to Local Administrators\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity \nstatus: stable\nauthor: Florian Roth\ntags:\n    - attack.privilege_escalation\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4732\n        GroupName: Administrators\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and not filter\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n", "git_filepath": "/windows/builtin/win_user_added_to_local_administrators.yml", "hash": "4eb2473af243be97a4ee1c1463c6834f3eae1492ef37c11bd692d3ae5bc37408", "level": "low", "is_verified": false, "downloads": 0}, "rzwdG2YBatiiaHt9hiRJ": {"status": "", "category": null, "updated": "2018-09-27T12:58:18.882253", "author_keyword": "Florian Roth", "user_id": null, "title": "Security Eventlog Cleared", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Security Eventlog Cleared", "released": "2018-09-27T12:58:18.882233", "sigma_text": "title: Security Eventlog Cleared\ndescription: Some threat groups tend to delete the local 'Security' Eventlog using certain utitlities\ntags:\n    - attack.defense_evasion\n    - attack.t1070\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 517\n            - 1102\n    condition: selection\nfalsepositives:\n    - Rollout of log collection agents (the setup routine often includes a reset of the local Eventlog)\n    - System provisioning (system reset before the golden image creation)\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_security_eventlog_cleared.yml", "hash": "ef3a8c2a9974411cf32105f9f478c53cf1db0d236ad970c1e88203fe8e609185", "level": "high", "is_verified": false, "downloads": 0}, "KLMx42IB8Wx35J1-Ss3W": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:41.236457", "user_id": null, "views": 7, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Malware User Agent", "released": "2018-04-20T13:14:41.236454", "sigma_text": "title: Malware User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings used by malware in proxy logs\nreferences:\n    - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\n    - http://www.botopedia.org/search?searchword=scan&searchphrase=all\n    - https://networkraptor.blogspot.com/2015/01/user-agent-strings.html\n    - https://perishablepress.com/blacklist/ua-2013.txt\n    - https://www.bluecoat.com/en-gb/security-blog/2015-05-05/know-your-agents\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # RATs\n        - 'Mozilla/5.0 (Windows NT 6.1; WOW64; rv:53.0) Gecko/20100101 Chrome /53.0'  # DargonOK\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1)'  # Used by PlugX - base-lining recommended - https://community.rsa.com/thread/185439\n        - 'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0)'  # Used by PlugX - base-lining recommended - https://community.rsa.com/thread/185439\n        - 'Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR  1.1.4322)'  # Used by PlugX - old - https://goo.gl/Yfjtk5\n        - 'HttpBrowser/1.0'  # HTTPBrowser RAT\n        - '*<|>*'  # Houdini / Iniduoh / njRAT\n        - 'nsis_inetc (mozilla)'  # ZeroAccess\n        - 'Wget/1.9+cvs-stable (Red Hat modified)'  # Dyre / Upatre\n        # Ghost419 https://goo.gl/rW1yvZ\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)'\n        # Malware\n        - '*zeroup*'  # W32/Renos.Downloader\n        - 'Mozilla/5.0 (Windows NT 5.1 ; v.*'  # Kazy\n        - '* adlib/*'  # https://goo.gl/gcAHoh\n        - '* tiny'  # Trojan Downloader\n        - '* BGroom *'  # Trojan Downloader\n        - '* changhuatong'\n        - '* CholTBAgent'\n        - 'Mozilla/5.0 WinInet'\n        - 'RookIE/1.0'\n        - 'M'  # HkMain\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0)'  # Egamipload - old UA - probable prone to false positives\n        - 'Mozilla/4.0 (compatible;MSIE 7.0;Windows NT 6.0)'  # Yakes\n        - 'backdoorbot'\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30731)'  # Sality\n        - 'Opera/8.81 (Windows NT 6.0; U; en)'  # Sality\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.3) Gecko/20100401 Firefox/3.6.1 (.NET CLR 3.5.30729)'  # Sality\n        - 'Opera'  # Trojan Keragany\n        - 'Mozilla/4.0 (compatible; MSIE 5.0; Windows 98)'  # Fareit\n        - 'Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)'  # Webshell's back connect\n        - 'MSIE'  # Toby web shell\n        - '*(Charon; Inferno)'  # Loki Bot\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/5.0)'  # Fareit / Pony\n        # Others \n        - '* pxyscand*'\n        - '* asd'\n        - '* mdms'\n        - 'sample'\n        - 'nocase'\n        - 'Moxilla'\n        - 'Win32 *'\n        - '*Microsoft Internet Explorer*'\n        - 'agent *'\n        - 'AutoIt'  # Suspicious - base-lining recommended\n        - 'IczelionDownLoad'\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/proxy/proxy_ua_malware.yml", "title": "sigma: Malware User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "4ee6000a7f15d648fb2427855c6012ef0016a38b6d0bc4993bfa3139723d97dc", "level": "high"}, "qLMv42IB8Wx35J1-tMxg": {"status": "", "category": 3, "updated": "2018-04-20T13:12:57.183711", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Activity in Shell Commands", "released": "2018-04-20T13:12:57.183708", "sigma_text": "title: Suspicious Activity in Shell Commands\ndescription: Detects suspicious shell commands used in various exploit codes (see references)\nreferences:\n    - http://www.threatgeek.com/2017/03/widespread-exploitation-attempts-using-cve-2017-5638.html\n    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/multi/http/struts_code_exec_exception_delegator.rb#L121\n    - http://pastebin.com/FtygZ1cg\n    - https://artkond.com/2017/03/23/pivoting-guide/\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious commands\n        - 'wget * - http* | perl'\n        - 'wget * - http* | sh'\n        - 'wget * - http* | bash'\n        - 'python -m SimpleHTTPServer'\n        - 'import pty; pty.spawn'\n        # Malware \n        - '*wget *; chmod +x*'\n        - '*wget *; chmod 777 *'\n        - '*cd /tmp || cd /var/run || cd /mnt*'\n        # Apache Struts in-the-wild exploit codes  \n        - 'stop;service iptables stop;'\n        - 'stop;SuSEfirewall2 stop;'\n        - 'chmod 777 2020'\n        - '\">>/etc/rc.local;'\n        - 'wget -c *;chmod 777'\n        # Metasploit framework exploit codes\n        - 'base64 -d /tmp/'\n        - ' | base64 -d'\n        - '/bin/chmod u+s'\n        - 'chmod +s /tmp/'\n        - 'chmod u+s /tmp/'\n        - '/tmp/haxhax'\n        - '/tmp/ns_sploit'\n        - 'nc -l -p '\n        - 'cp /bin/ksh '\n        - 'cp /bin/sh '\n        - ' /tmp/*.b64 '\n        - '/tmp/ysocereal.jar'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_shell_susp_commands.yml", "title": "sigma: Suspicious Activity in Shell Commands", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "50f16b4015f68d5b6b9bb9d5670f1e32ccb13d86125b28b2167b117f8af17ce1", "level": "high"}, "pjwdG2YBatiiaHt9fiRc": {"status": "", "category": null, "updated": "2018-09-27T12:58:16.853459", "author_keyword": "Florian Roth", "user_id": null, "title": "Account Tampering - Suspicious Failed Logon Reasons", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Account Tampering - Suspicious Failed Logon Reasons", "released": "2018-09-27T12:58:16.853457", "sigma_text": "title: Account Tampering - Suspicious Failed Logon Reasons\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.\nauthor: Florian Roth\ntags:\n    - attack.persistence\n    - attack.privilege_escalation\n    - attack.t1078\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4625\n            - 4776\n        Status:\n            - '0xC0000072'\n            - '0xC000006F'\n            - '0xC0000070'\n            - '0xC0000413'\n            - '0xC000018C'\n    condition: selection\nfalsepositives:\n    - User using a disabled account\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_failed_logon_reasons.yml", "hash": "85c83787820ac9713f21090a0e135a8083cd51c3ecbbab2ffe5303ec68527c7c", "level": "high", "is_verified": false, "downloads": 0}, "hDwdG2YBatiiaHt9YiT6": {"status": "", "category": null, "updated": "2018-09-27T12:58:09.843971", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious Log Entries", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious Log Entries", "released": "2018-09-27T12:58:09.843969", "sigma_text": "title: Suspicious Log Entries\ndescription: Detects suspicious log entries in Linux log files\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # Generic suspicious log lines\n        - 'entered promiscuous mode'\n        # OSSEC https://github.com/ossec/ossec-hids/blob/master/etc/rules/syslog_rules.xml\n        - 'Deactivating service'\n        - 'Oversized packet received from'  \n        - 'imuxsock begins to drop messages'      \n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_shell_susp_log_entries.yml", "hash": "197911e27c186b5f5bce3557263e09e6a20d4792a0a8474b650a0bf94ff72ab6", "level": "medium", "is_verified": false, "downloads": 0}, "-bMw42IB8Wx35J1-tcxc": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:02.969586", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Executable used by PlugX in Uncommon Location", "released": "2018-04-20T13:14:02.969583", "sigma_text": "title: Executable used by PlugX in Uncommon Location\nstatus: experimental\ndescription: Detects the execution of an executable that is typically used by PlugX for DLL side loading started from an uncommon location\nreferences:\n    - 'http://www.hexacorn.com/blog/2016/03/10/beyond-good-ol-run-key-part-36/'\n    - 'https://countuponsecurity.com/2017/06/07/threat-hunting-in-the-enterprise-with-appcompatprocessor/'\nauthor: Florian Roth\ndate: 2017/06/12\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    # CamMute\n    selection_cammute:\n        EventID: 1\n        Image: '*\\CamMute.exe'\n    filter_cammute:\n        EventID: 1\n        Image: '*\\Lenovo\\Communication Utility\\*'\n    # Chrome Frame Helper\n    selection_chrome_frame:\n        EventID: 1\n        Image: '*\\chrome_frame_helper.exe'\n    filter_chrome_frame:\n        EventID: 1\n        Image: '*\\Google\\Chrome\\application\\*'    \n    # Microsoft Device Emulator\n    selection_devemu:\n        EventID: 1\n        Image: '*\\dvcemumanager.exe'\n    filter_devemu:\n        EventID: 1\n        Image: '*\\Microsoft Device Emulator\\*'   \n    # Windows Media Player Gadget\n    selection_gadget:\n        EventID: 1\n        Image: '*\\Gadget.exe'\n    filter_gadget:\n        EventID: 1\n        Image: '*\\Windows Media Player\\*'\n    # HTML Help Workshop\n    selection_hcc:\n        EventID: 1\n        Image: '*\\hcc.exe'\n    filter_hcc:\n        EventID: 1\n        Image: '*\\HTML Help Workshop\\*'\n    # Hotkey Command Module for Intel Graphics Contollers\n    selection_hkcmd:\n        EventID: 1\n        Image: '*\\hkcmd.exe'\n    filter_hkcmd:\n        EventID: 1\n        Image: \n            - '*\\System32\\*'\n            - '*\\SysNative\\*'\n            - '*\\SysWowo64\\*'\n    # McAfee component\n    selection_mc:\n        EventID: 1\n        Image: '*\\Mc.exe'\n    filter_mc:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'\n    # MsMpEng - Microsoft Malware Protection Engine\n    selection_msmpeng:\n        EventID: 1\n        Image: '*\\MsMpEng.exe'\n    filter_msmpeng:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Security Client\\*'\n            - '*\\Windows Defender\\*'\n            - '*\\AntiMalware\\*'\n    # Microsoft Security Center\n    selection_msseces:\n        EventID: 1\n        Image: '*\\msseces.exe'\n    filter_msseces:\n        EventID: 1\n        Image: '*\\Microsoft Security Center\\*'\n    # Microsoft Office 2003 OInfo\n    selection_oinfo:\n        EventID: 1\n        Image: '*\\OInfoP11.exe'\n    filter_oinfo:\n        EventID: 1\n        Image: '*\\Common Files\\Microsoft Shared\\*'      \n    # OLE View\n    selection_oleview:\n        EventID: 1\n        Image: '*\\OleView.exe'\n    filter_oleview:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n    # RC\n    selection_rc:\n        EventID: 1\n        Image: '*\\OleView.exe'\n    filter_rc:\n        EventID: 1\n        Image: \n            - '*\\Microsoft Visual Studio*'\n            - '*\\Microsoft SDK*'\n            - '*\\Windows Kit*'   \n            - '*\\Windows Resource Kit\\*'\n            - '*\\Microsoft.NET\\*'  \n    condition: ( selection_cammute and not filter_cammute ) or  \n                ( selection_chrome_frame and not filter_chrome_frame ) or\n                ( selection_devemu and not filter_devemu ) or\n                ( selection_gadget and not filter_gadget ) or \n                ( selection_hcc and not filter_hcc ) or \n                ( selection_hkcmd and not filter_hkcmd ) or \n                ( selection_mc and not filter_mc ) or\n                ( selection_msmpeng and not filter_msmpeng ) or\n                ( selection_msseces and not filter_msseces ) or\n                ( selection_oinfo and not filter_oinfo ) or \n                ( selection_oleview and not filter_oleview ) or \n                ( selection_rc and not filter_rc ) \nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_plugx_susp_exe_locations.yml", "title": "sigma: Executable used by PlugX in Uncommon Location", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "84336fd7c6949020d5f9451f71ae9a0665a42aa8d5b83a25ef8d01c0edb43555", "level": "high"}, "pzwdG2YBatiiaHt9fyQ8": {"status": "", "category": null, "updated": "2018-09-27T12:58:17.077991", "author_keyword": "Omer Faruk Celik", "user_id": null, "title": "smbexec.py Service Installation", "permission_id": 3, "author": "Omer Faruk Celik", "mitre_attack": null, "title_keyword": "smbexec.py Service Installation", "released": "2018-09-27T12:58:17.077988", "sigma_text": "title: smbexec.py Service Installation\ndescription: Detects the use of smbexec.py tool by detecting a specific service installation\nauthor: Omer Faruk Celik\ndate: 2018/03/20\nreferences:\n    - https://blog.ropnop.com/using-credentials-to-own-windows-boxes-part-2-psexec-and-services/\ntags:\n    - attack.lateral_movement\n    - attack.execution\n    - attack.t1077\n    - attack.t1035\nlogsource:\n    product: windows\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'BTOBTO'\n        ServiceFileName: '*\\execute.bat'\n    condition: service_installation\nfields:\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - Penetration Test\n    - Unknown\nlevel: critical", "git_filepath": "/windows/builtin/win_hack_smbexec.yml", "hash": "5a9bbf953f13644912b92ed7d24270a348d110d1d57a9d32edec53df27316f26", "level": "critical", "is_verified": false, "downloads": 0}, "vbMv42IB8Wx35J1-98zY": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:14.454706", "user_id": null, "views": 4, "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Password Dumper Activity on LSASS", "released": "2018-04-20T13:13:14.454703", "sigma_text": "title: Password Dumper Activity on LSASS\ndescription: Detects process handle on LSASS process with certain access mask and object type SAM_DOMAIN \nstatus: experimental\nreferences:\n    - https://twitter.com/jackcr/status/807385668833968128\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4656\n        ProcessName: 'C:\\Windows\\System32\\lsass.exe'\n        AccessMask: '0x705'\n        ObjectType: 'SAM_DOMAIN'\n    condition: selection\nfalsepositives:\n    - Unkown\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_lsass_dump.yml", "title": "sigma: Password Dumper Activity on LSASS", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "f71db2707e78a6ca64808cc1bbb81689bc0d42a023fb3aa3dfa19ff3840a7097", "level": "high"}, "EbMx42IB8Wx35J1-As0m": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:22.628718", "user_id": null, "views": 1, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Microsoft Outlook Spawning Windows Shell", "released": "2018-04-20T13:14:22.628715", "sigma_text": "title: Microsoft Outlook Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Outlook\nreferences:\n    - https://www2.cybereason.com/asset/60:research-cobalt-kitty-attack-lifecycle\nauthor: Florian Roth\ndate: 2018/03/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\schtasks.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - False positives are possible, depends on organisation and processes\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_outlook_shell.yml", "title": "sigma: Microsoft Outlook Spawning Windows Shell", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "f8aacb12262552a81115ebe82e10f7be90a1f902fd885f485560e60f5354f3a6", "level": "high"}, "gjwdG2YBatiiaHt9YSSP": {"status": "", "category": null, "updated": "2018-09-27T12:58:09.481194", "author_keyword": null, "user_id": null, "title": "Shellshock Expression", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Shellshock Expression", "released": "2018-09-27T12:58:09.481192", "sigma_text": "title: Shellshock Expression\ndescription: Detects shellshock expressions in log files\nreferences:\n    - http://rubular.com/r/zxBfjWfFYs\nlogsource:\n    product: linux\ndetection:\n    expression:\n        - /\\(\\)\\s*\\t*\\{.*;\\s*\\}\\s*;/\n    condition: expression\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_shellshock.yml", "hash": "c5635163777ca02f1c3ebf0f4dd838ed6bbd9993a7fb21223705d06f48ac7527", "level": "high", "is_verified": false, "downloads": 0}, "zrMw42IB8Wx35J1-Lcze": {"status": "", "category": 11, "updated": "2018-04-20T13:13:28.285174", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Kerberos Manipulation", "released": "2018-04-20T13:13:28.285171", "sigma_text": "title: Kerberos Manipulation\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n          - 675\n          - 4768\n          - 4769\n          - 4771\n        FailureCode:\n          - '0x9'\n          - '0xA'\n          - '0xB'\n          - '0xF'\n          - '0x10'\n          - '0x11'\n          - '0x13'\n          - '0x14'\n          - '0x1A'\n          - '0x1F'\n          - '0x21'\n          - '0x22'\n          - '0x23'\n          - '0x24'\n          - '0x26'\n          - '0x27'\n          - '0x28'\n          - '0x29'\n          - '0x2C'\n          - '0x2D'\n          - '0x2E'\n          - '0x2F'\n          - '0x31'\n          - '0x32'\n          - '0x3E'\n          - '0x3F'\n          - '0x40'\n          - '0x41'\n          - '0x43'\n          - '0x44'\n    condition: selection\nfalsepositives:\n    - Faulty legacy applications\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_kerberos_manipulation.yml", "title": "sigma: Kerberos Manipulation", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "4d00510e51a05d62e16b438656c30ee27d639ef00211f50159095c01cfcfaf11", "level": "high"}, "HrMx42IB8Wx35J1-K80P": {"status": "", "category": 15, "updated": "2018-04-20T13:14:33.101310", "user_id": null, "views": 15, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Webshell Detection With Command Line Keywords", "released": "2018-04-20T13:14:33.101307", "sigma_text": "title: Webshell Detection With Command Line Keywords\ndescription: Detects certain command line parameters often used during reconnissaince activity via web shells\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n          - '*\\apache*'\n          - '*\\tomcat*'\n          - '*\\w3wp.exe'\n          - '*\\php-cgi.exe'\n          - '*\\nginx.exe'\n          - '*\\httpd.exe'\n        CommandLine:\n          - 'whoami'\n          - 'net user'\n          - 'ping -n'\n          - 'systeminfo'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_webshell_detection.yml", "title": "sigma: Webshell Detection With Command Line Keywords", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 2, "hash": "011b4dc950e89cdf6c8b726fe9c01480403848be5126b45616795c2e11aed107", "level": "high"}, "-LMw42IB8Wx35J1-ssw6": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:02.168238", "user_id": null, "views": 6, "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Mimikatz In-Memory", "released": "2018-04-20T13:14:02.168235", "sigma_text": "title: Mimikatz In-Memory\nstatus: experimental\ndescription: Detects certain DLL loads when Mimikatz gets executed\nreferences:\n    - https://securityriskadvisors.com/blog/post/detecting-in-memory-mimikatz/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selector:\n        EventID: 7\n        Image: 'C:\\Windows\\System32\\rundll32.exe'\n    dllload1:\n        ImageLoaded: '*\\vaultcli.dll'\n    dllload2:\n        ImageLoaded: '*\\wlanapi.dll'        \n    exclusion:\n        ImageLoaded:\n            - 'ntdsapi.dll'\n            - 'netapi32.dll'\n            - 'imm32.dll'\n            - 'samlib.dll'\n            - 'combase.dll'\n            - 'srvcli.dll'\n            - 'shcore.dll'\n            - 'ntasn1.dll'\n            - 'cryptdll.dll'\n            - 'logoncli.dll'\n    timeframe: 30s\n    condition: selector | near dllload1 and dllload2 and not exclusion\nfalsepositives:\n    - unknown\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_mimikatz_inmemory_detection.yml", "title": "sigma: Mimikatz In-Memory", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "57d596609eaf96f5d302df2882f21bf3ddb0051e7807ad094132e4680d125968", "level": "medium"}, "JbMx42IB8Wx35J1-Qc0d": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:38.747665", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Flash Player Update from Suspicious Location", "released": "2018-04-20T13:14:38.747662", "sigma_text": "title: Flash Player Update from Suspicious Location\nstatus: experimental\ndescription: Detects a flashplayer update from an unofficial location\nreferences:\n    - https://gist.github.com/roycewilliams/a723aaf8a6ac3ba4f817847610935cfb\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        cs-uri-query: \n            - '*/install_flash_player.exe'\n            - '*/flash_install.php*'\n    filter:\n        cs-uri-query: '*.adobe.com/*'\n    condition: selection and not filter\nfalsepositives:\n    - Unknown flash download locations\nlevel: high\n", "git_filepath": "/proxy/proxy_susp_flash_download_loc.yml", "title": "sigma: Flash Player Update from Suspicious Location", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "5ac87e8455779ba271897e9c045a1e780d27bf1c2f2eb20b0213ad37279129ef", "level": "high"}, "OrMx42IB8Wx35J1-g836": {"status": "experimental", "category": 2, "updated": "2018-04-20T13:14:55.865044", "user_id": null, "views": "4", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Fireball Archer Install", "released": "2018-04-20T13:14:55.865041", "sigma_text": "title: Fireball Archer Install\nstatus: experimental\ndescription: Detects Archer malware invocation via rundll32\nauthor: Florian Roth\ndate: 2017/06/03\nreferences:\n    - https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\n    - https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/crime_fireball.yml", "title": "sigma: Fireball Archer Install", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "ae054c30ecf260e694d9ac1c20884b19f6b5e89192bbd323476ecd0472ce3cff", "level": "high"}, "BrMw42IB8Wx35J1-380Q": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:13.647015", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Exploit for CVE-2015-1641", "released": "2018-04-20T13:14:13.647011", "sigma_text": "title: Exploit for CVE-2015-1641\nstatus: experimental\ndescription: Detects Winword starting uncommon sub process MicroScMgmt.exe as used in exploits for CVE-2015-1641\nreferences:\n  - https://www.virustotal.com/en/file/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8/analysis/\n  - https://www.hybrid-analysis.com/sample/5567408950b744c4e846ba8ae726883cb15268a539f3bb21758a466e47021ae8?environmentId=100\nauthor: Florian Roth\ndate: 2018/02/22\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\WINWORD.EXE'\n        Image: '*\\MicroScMgmt.exe '\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_exploit_cve_2015_1641.yml", "title": "sigma: Exploit for CVE-2015-1641", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "fd0e9f52bd5029f3bdc71667d476dfb9a9e1c3676ba379b669be7de14d5523b0", "level": "critical"}, "NwK3gmMBqfpvXJhTgAxA": {"status": "testing", "category": "", "updated": "2018-06-01T08:33:20Z", "user_id": "80", "views": 35, "downloads": 1, "author": "Alexandr Yamposlkyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: StalinLocker Detector.", "released": "2018-05-21T12:40:54Z", "sigma_text": "title: StalinLocker Detector.\ndescription: Detects StalinLocker (Ransomware, Cryptovirus) Activities.\nreferences:\n- https://www.bleepingcomputer.com/news/security/stalinlocker-deletes-your-files-unless-you-enter-the-right-code/\nauthor: Alexandr Yamposlkyi, SOC Prime\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection1:\n    EventID: \"13\"\n    TargetObject:\n    - HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Stalin\n    - HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\Stalin\n  selection2:\n    EventID: \"1\"\n    Image:\n    - '*\\fl.dat'\n    - '*\\stalin.exe'\n    - '*\\USSR_Anthem.mp3'\n  selection3:\n    EventID: \"1\"\n    file_hash:\n    - 853177d9a42fab0d8d62a190894de5c27ec203240df0d9e70154a675823adf04\n  selection4:\n    EventID: \"11\"\n  TargetFilename: C:\\Windows\\System32\\Tasks\\Driver Update\n  condition: selection1 or selection2 or selection3 or selection4\nfields:\n- TargetFilename\n- EventID\n- Image\n- TargetObject\n- ParentImage\n- Hashes\nfalsepositives:\n- Administrator actions\nlevel: high\nmitre-attack:\n  Persistence:\n  - Registry Run Keys / Start Folder\n  - Scheduled Task\n  - Startup Items", "title": "sigma: StalinLocker Detector.", "author_keyword": "Alexandr Yamposlkyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "6685902aa70a679514dbb579bd2cf80c5ad213609e7d0c938bbd07b4e08b7379", "level": "high"}, "mzwdG2YBatiiaHt9dSTM": {"status": "", "category": null, "updated": "2018-09-27T12:58:14.662851", "author_keyword": "Florian Roth", "user_id": null, "title": "WMIExec VBS Script", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "WMIExec VBS Script", "released": "2018-09-27T12:58:14.662849", "sigma_text": "title: WMIExec VBS Script\ndescription: Detects suspicious file execution by wscript and cscript\nauthor: Florian Roth\nreferences:\n    - https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\ntags:\n    - attack.execution\n    - attack.g0045\n    - attack.t1064\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\cscript.exe'\n        CommandLine: '*.vbs /shell *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/apt/apt_cloudhopper.yml", "hash": "7d6ca9081e7e4e1cf6b3badabef2d57dbcde2b59afdca649f98a2049a6587a76", "level": "critical", "is_verified": false, "downloads": 0}, "6bMw42IB8Wx35J1-g8wX": {"status": "", "category": 15, "updated": "2018-04-20T13:13:50.099257", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Java Running with Remote Debugging", "released": "2018-04-20T13:13:50.099253", "sigma_text": "title: Java Running with Remote Debugging\ndescription: Detcts a JAVA process running with remote debugging allowing more than just localhost to connect\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: '*transport=dt_socket,address=*'\n    exclusion:\n        - CommandLine: '*address=127.0.0.1*'\n        - CommandLine: '*address=localhost*'\n    condition: selection and not exclusion\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_vul_java_remote_debugging.yml", "title": "sigma: Java Running with Remote Debugging", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "044dab159eac5dd01ba33e7f2ed9cb91bf159410c5dec1ecda3215b81cbd0fd0", "level": "medium"}, "bjwZ_WIB_9rlszZ2p897": {"status": "testing", "category": "", "updated": "2018-04-30T12:33:52Z", "user_id": "3518", "views": 47, "downloads": 2, "author": "Eugene Nechiporenko, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Detects malware AcroRD32.exe execution process", "released": "2018-04-25T13:58:59Z", "sigma_text": "title: Detects malware AcroRD32.exe execution process\nstatus: testing\ndescription: Masquerading malware with the name of a legitimate process name for Adobe's Acrobat Reader\nreferences:\n- https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/mandiant-apt1-report-appendix.zip\nauthor: Eugene Nechiporenko, SOC Prime\ndate: 2018/03/13\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    Image: '*\\AcroRD32.exe'\n  filter:\n    Image:\n    - '*\\Adobe\\Acrobat Reader DC\\Reader\\AcroRD32.exe'\n  condition: selection and not filter\nfields:\n- Image\n- CommandLine\n- ParentCommandLine\nfalsepositives:\n- Administrative activity\n- Legitimate process\n- User's destination folder\nlevel: high\nmitre-attack:\n  Defense Evasion:\n  - Masquerading", "title": "sigma: Detects malware AcroRD32.exe execution process", "author_keyword": "Eugene Nechiporenko, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "08a8fc1c2a7ad703c7ecead67636f8b2edff81e529122b5b194e471064a35ff8", "level": "high"}, "GrMx42IB8Wx35J1-Hs11": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:29.875524", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Office Macro Starts Cmd", "released": "2018-04-20T13:14:29.875521", "sigma_text": "title: Office Macro Starts Cmd\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Word or Excel \nreferences:\n    - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: \n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n        Image: '*\\cmd.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_office_macro_cmd.yml", "title": "sigma: Office Macro Starts Cmd", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "531f716975f057d96c8f66a7400bc3d93db90e76ade05f398061254d24f5fd64", "level": "high"}, "hjwdG2YBatiiaHt9ZCSj": {"status": "", "category": null, "updated": "2018-09-27T12:58:10.267840", "author_keyword": "Florian Roth", "user_id": null, "title": "SSHD Error Message CVE-2018-15473", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "SSHD Error Message CVE-2018-15473", "released": "2018-09-27T12:58:10.267830", "sigma_text": "title: SSHD Error Message CVE-2018-15473\ndescription: Detects exploitation attempt using public exploit code for CVE-2018-15473\nreferences:\n    - https://github.com/Rhynorater/CVE-2018-15473-Exploit\nauthor: Florian Roth\ndate: 2017/08/24\nlogsource:\n    product: linux\n    service: sshd\ndetection:\n    keywords:\n        - 'error: buffer_get_ret: trying to get more bytes 1907 than in buffer 308 [preauth]'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_ssh_cve_2018_15473.yml", "hash": "3fd8340bf447828cea089da87a1137d60ed0257a2f864349430695ac192afa22", "level": "medium", "is_verified": false, "downloads": 0}, "sLMv42IB8Wx35J1-zswE": {"status": "", "category": 1, "updated": "2018-04-20T13:13:03.746961", "user_id": null, "views": 1, "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Ruby on Rails framework exceptions", "released": "2018-04-20T13:13:03.746958", "sigma_text": "title: Ruby on Rails framework exceptions\ndescription: Detects suspicious Ruby on Rails exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - http://edgeguides.rubyonrails.org/security.html\n    - http://guides.rubyonrails.org/action_controller_overview.html\n    - https://stackoverflow.com/questions/25892194/does-rails-come-with-a-not-authorized-exception\n    - https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/middleware/exception_wrapper.rb\nlogsource:\n    category: application\n    product: ruby_on_rails\ndetection:\n    keywords:\n        - ActionController::InvalidAuthenticityToken\n        - ActionController::InvalidCrossOriginRequest\n        - ActionController::MethodNotAllowed\n        - ActionController::BadRequest\n        - ActionController::ParameterMissing\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_ruby_on_rails_exceptions.yml", "title": "sigma: Ruby on Rails framework exceptions", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "fc37278a20a4219a2b968eca569332e64a60b7777a2eaab62a2256817bd6c122", "level": "medium"}, "DLMw42IB8Wx35J1-8s16": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:18.616252", "user_id": null, "views": 3, "permission_id": 3, "author": "Markus Neis / Florian Roth", "mitre_attack": null, "title_keyword": "sigma: SquiblyTwo", "released": "2018-04-20T13:14:18.616249", "sigma_text": "title: SquiblyTwo\nstatus: experimental\ndescription: Detects WMI SquiblyTwo Attack with possible renamed WMI by looking for imphash. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\nreferences:\n    - https://subt0x11.blogspot.ch/2018/04/wmicexe-whitelisting-bypass-hacking.html\n    - https://twitter.com/mattifestation/status/986280382042595328\nauthor: Markus Neis / Florian Roth\nfalsepositives:\n    - Unknown\nlevel: medium\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image:\n            - '*\\wmic.exe'\n        CommandLine:\n            - 'wmic * *format:\\\"http*'\n            - \"wmic * /format:'http\"\n            - 'wmic * /format:http*'\n    selection2:\n        EventID: 1\n        Imphash:\n             - '1B1A3F43BF37B5BFE60751F2EE2F326E'\n             - '37777A96245A3C74EB217308F3546F4C'\n             - '9D87C9D67CE724033C0B40CC4CA1B206'\n        CommandLine:\n            - '* *format:\\\"http*'\n            - \"* /format:'http\"\n            - '* /format:http*'\n    condition: selection1 or selection2\n", "git_filepath": "/windows/sysmon/sysmon_bypass_squiblytwo.yml", "title": "sigma: SquiblyTwo", "author_keyword": "Markus Neis / Florian Roth", "is_verified": false, "downloads": 0, "hash": "c74a7d41e142f16a1901d7bfb1c54bedf4c417c93062c896b12d672e50e2df51", "level": "medium"}, "rTwdG2YBatiiaHt9hCS4": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:18.481539", "author_keyword": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "user_id": null, "title": "Backup Catalog Deleted", "permission_id": 3, "author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "mitre_attack": null, "title_keyword": "Backup Catalog Deleted", "released": "2018-09-27T12:58:18.481537", "sigma_text": "title: Backup Catalog Deleted\nstatus: experimental\ndescription: Detects backup catalog deletions\nreferences:\n    - https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection) \ntags:\n    - attack.defense_evasion\n    - attack.t1107\nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection:\n        EventID: 524\n        Source: Backup\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_backup_delete.yml", "hash": "75ed3234802d7377ad7af0f29456e9d56b6be3e8433f6097f75d34ab1504772d", "level": "medium", "is_verified": false, "downloads": 0}, "lzwdG2YBatiiaHt9ciSA": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:13.816452", "author_keyword": "Bjoern Kimminich", "user_id": null, "title": "Suspicious SQL Error Messages", "permission_id": 3, "author": "Bjoern Kimminich", "mitre_attack": null, "title_keyword": "Suspicious SQL Error Messages", "released": "2018-09-27T12:58:13.816441", "sigma_text": "title: Suspicious SQL Error Messages\nstatus: experimental\ndescription: Detects SQL error messages that indicate probing for an injection attack\nauthor: Bjoern Kimminich\nreferences:\n    - http://www.sqlinjection.net/errors\nlogsource:\n    category: application\n    product: sql\ndetection:\n    keywords:\n        # Oracle\n        - quoted string not properly terminated\n        # MySQL\n        - You have an error in your SQL syntax\n        # SQL Server\n        - Unclosed quotation mark\n        # SQLite\n        - 'near \"*\": syntax error'\n        - SELECTs to the left and right of UNION do not have the same number of result columns\n    condition: keywords\nfalsepositives:\n    - Application bugs\nlevel: high\n", "git_filepath": "/application/app_sqlinjection_errors.yml", "hash": "3bce53860ef6c21e6ee41c60c8935ea2a193a43bd96d14d9bd3ffd9f5c628dd9", "level": "high", "is_verified": false, "downloads": 0}, "p7Mv42IB8Wx35J1-scwz": {"status": "", "category": 3, "updated": "2018-04-20T13:12:56.368783", "user_id": null, "views": 3, "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Buffer Overflow Attempts", "released": "2018-04-20T13:12:56.368780", "sigma_text": "title: Buffer Overflow Attempts\ndescription: Detects buffer overflow attempts in Linux system log files\nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/attack_rules.xml\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        - 'attempt to execute code on stack by'\n        - 'FTP LOGIN FROM .* 0bin0sh'\n        - 'rpc.statd[\\d+]: gethostbyname error for'\n        - 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'\n    condition: keywords\nfalsepositives:\n    - Unkown\nlevel: high\n", "git_filepath": "/linux/lnx_buffer_overflows.yml", "title": "sigma: Buffer Overflow Attempts", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "725ff39689532bf2eac44ffd9a0f205a9fcd76f37c4564b59d004350f3adb7eb", "level": "high"}, "LLMx42IB8Wx35J1-WM1M": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:44.682455", "user_id": null, "views": 7, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Hack Tool User Agent", "released": "2018-04-20T13:14:44.682452", "sigma_text": "title: Hack Tool User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings user by hack tools in proxy logs\nreferences:\n    - https://github.com/fastly/waf_testbed/blob/master/templates/default/scanners-user-agents.data.erb\n    - http://rules.emergingthreats.net/open/snort-2.9.0/rules/emerging-user_agents.rules\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Vulnerbility scanner and brute force tools\n        - '*(hydra)*'\n        - '* arachni/*'\n        - '* BFAC *'\n        - '* brutus *'\n        - '* cgichk *'\n        - '*core-project/1.0*'\n        - '* crimscanner/*'\n        - '*datacha0s*'\n        - '*dirbuster*'\n        - '*domino hunter*'\n        - '*dotdotpwn*'\n        - 'FHScan Core'\n        - '*floodgate*'\n        - '*get-minimal*'\n        - '*gootkit auto-rooter scanner*'\n        - '*grendel-scan*'\n        - '* inspath *'\n        - '*internet ninja*'\n        - '*jaascois*'\n        - '* zmeu *'\n        - '*masscan*'\n        - '* metis *'\n        - '*morfeus fucking scanner*'\n        - '*n-stealth*'\n        - '*nsauditor*'\n        - '*pmafind*'\n        - '*security scan*'\n        - '*springenwerk*'\n        - '*teh forest lobster*'\n        - '*toata dragostea*'\n        - '* vega/*'\n        - '*voideye*'\n        - '*webshag*'\n        - '*webvulnscan*'\n        - '* whcc/*'\n        # SQL Injection\n        - '* Havij'\n        - '*absinthe*'\n        - '*bsqlbf*'\n        - '*mysqloit*'\n        - '*pangolin*'\n        - '*sql power injector*'\n        - '*sqlmap*'\n        - '*sqlninja*'\n        - '*uil2pn*'\n        # Hack tool\n        - 'ruler'  # https://www.crowdstrike.com/blog/using-outlook-forms-lateral-movement-persistence/\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/proxy/proxy_ua_hacktool.yml", "title": "sigma: Hack Tool User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 3, "hash": "01d05c35a6d08fa744ad0239b20b29a713fc9dabca4841909d73049b1e93817b", "level": "high"}, "3rMw42IB8Wx35J1-X8zx": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:41.104015", "user_id": null, "title": "sigma: PowerShell PSAttack", "permission_id": 3, "author": "Sean Metcalf (source), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: PowerShell PSAttack", "released": "2018-04-20T13:13:41.104012", "sigma_text": "title: PowerShell PSAttack \nstatus: experimental\ndescription: Detects the use of PSAttack PowerShell hack tool. Modified by SOC Prime, replaced condition \"all of them\" with \"selection and keyword\"\nreferences:\n    - https://adsecurity.org/?p=2921\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    selection:\n        EventID: 4103\n    keyword: \n        - 'PS ATTACK!!!'\n    condition: selection and keyword\nfalsepositives:\n    - Pentesters\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_psattack.yml", "hash": "0c38a01e79a9f1e681d601d6b4653950d474a87edc0b6d52d8cb4a01126815c6", "author_keyword": "Sean Metcalf (source), Florian Roth (rule)", "is_verified": false, "downloads": 0, "level": "high"}, "D7Mw42IB8Wx35J1--83W": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:21.012382", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: DNS ServerLevelPluginDll Install", "released": "2018-04-20T13:14:21.012379", "sigma_text": "title: DNS ServerLevelPluginDll Install\nstatus: experimental\ndescription: Detects the installation of a plugin DLL via ServerLevelPluginDll parameter in Registry, which can be used to execute code in context of the DNS server (restart required). Modified by SOC Prime, replaced condition \"1 of them\" with \"selection and keyword\"\nreferences:\n    - https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83\ndate: 2017/05/08\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    dnsadmin:\n        EventID: 1\n        CommandLine: 'dnscmd.exe /config /serverlevelplugindll *'\n    dnsregmod:\n        EventID: 13\n        TargetObject: '*\\services\\DNS\\Parameters\\ServerLevelPluginDll'\n    condition: dnsadmin or dnsregmod\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - Image\n    - User\n    - TargetObject\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_dns_serverlevelplugindll.yml", "title": "sigma: DNS ServerLevelPluginDll Install", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "8d46d24bf9e769fe83c5491e0ca3ccae0448098c4207d578e5cf3356144a32ec", "level": "high"}, "G7Mx42IB8Wx35J1-Ic2W": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:30.676130", "user_id": null, "views": 10, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: PowerShell Download from URL", "released": "2018-04-20T13:14:30.676127", "sigma_text": "title: PowerShell Download from URL\nstatus: experimental\ndescription: Detetcs a Powershell process that contains download commands in its command line string\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\powershell.exe'\n        CommandLine: \n            - '*new-object system.net.webclient).downloadstring(*'\n            - '*new-object system.net.webclient).downloadfile(*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_powershell_download.yml", "title": "sigma: PowerShell Download from URL", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "c7767709ffb043c79edb01c5f140f4a063f47135b899521941f3c17ba27f8c8d", "level": "medium"}, "PgLhkGMBqfpvXJhTegzn": {"status": "testing", "category": "", "updated": "2018-06-04T09:03:03Z", "user_id": "3518", "views": 125, "downloads": 13, "author": "Eugene Nechiporenko, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: VPNFilter Destructive Malware detection (domain/IP)", "released": "2018-05-24T06:41:26Z", "sigma_text": "title: VPNFilter Destructive Malware detection (domain/IP)\ndescription: This rule detects VPNFilter Destructive Malware  activity (domain/IP)\nauthor: Eugene Nechiporenko, SOC Prime\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection1:\n    URL:\n    - photobucket.com/user/nikkireed11/library\n    - photobucket.com/user/nikkireed11/library\n    - photobucket.com/user/kmila302/library\n    - photobucket.com/user/lisabraun87/library\n    - photobucket.com/user/eva_green1/library\n    - photobucket.com/user/monicabelci4/library\n    - photobucket.com/user/katyperry45/library\n    - photobucket.com/user/saragray1/library\n    - photobucket.com/user/millerfred/library\n    - photobucket.com/user/jeniferaniston1/library\n    - photobucket.com/user/amandaseyfried1/library\n    - photobucket.com/user/suwe8/library\n    - photobucket.com/user/bob7301/library\n    - toknowall.com\n  selection2:\n    SourceIP:\n    - 91.121.109.209\n    - 217.12.202.40\n    - 94.242.222.68\n    - 82.118.242.124\n    - 46.151.209.33\n    - 217.79.179.14\n    - 91.214.203.144\n    - 95.211.198.231\n    - 195.154.180.60\n    - 5.149.250.54\n    - 91.200.13.76\n    - 94.185.80.82\n    - 62.210.180.229\n    - 91.200.13.76\n    - 23.111.177.114\n    - 138.186.2.250\n    - 250.2.186.138\n    - 178.78.13.69\n    - 178.78.6.224\n    - 187.85.58.107\n    - 192.157.214.6\n    - 77.45.243.188\n    - 88.213.189.253\n    - 9.110.0.5\n  selection3:\n    DestinationIP:\n    - 91.121.109.209\n    - 217.12.202.40\n    - 94.242.222.68\n    - 82.118.242.124\n    - 46.151.209.33\n    - 217.79.179.14\n    - 91.214.203.144\n    - 95.211.198.231\n    - 195.154.180.60\n    - 5.149.250.54\n    - 91.200.13.76\n    - 94.185.80.82\n    - 62.210.180.229\n    - 91.200.13.76\n    - 23.111.177.114\n    - 138.186.2.250\n    - 250.2.186.138\n    - 178.78.13.69\n    - 178.78.6.224\n    - 187.85.58.107\n    - 192.157.214.6\n    - 77.45.243.188\n    - 88.213.189.253\n    - 9.110.0.5\n  keywords:\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\n  - tljmmy4vmkqbdof4.onion/bin32/update.php\n  - zuh3vcyskd4gipkm.onion/bin32/update.php\n  - 6b57dcnonk2edf5a.onion/bin32/update.php\n  condition: selection1 or selection2 or selection3 or keywords\nfields:\n- DestinationIp\n- URL\n- UserAgent\n- SourceIp\nfalsepositives:\n- Unknown\nlevel: critical\ndate: 2018/05/24\nreference:\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\n- https://blogs.cisco.com/security/talos/vpnfilter\n- https://jask.com/from-russia-with-love/\nmitre-attack:\n  Command and Control:\n  - Remote File Copy\n  - Standard Application Layer Protocol\n  - Web Service", "title": "sigma: VPNFilter Destructive Malware detection (domain/IP)", "author_keyword": "Eugene Nechiporenko, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "4b02a87b5dccc5b41cc2cda2ecbb37795705192b2703e310ef698c7cdd3ce442", "level": "critical"}, "ijwdG2YBatiiaHt9ZyTx": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:11.115244", "author_keyword": "Florian Roth", "user_id": null, "title": "Cobalt Strike DNS Beaconing", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Cobalt Strike DNS Beaconing", "released": "2018-09-27T12:58:11.115241", "sigma_text": "title: Cobalt Strike DNS Beaconing\nstatus: experimental\ndescription: Detects suspicious DNS queries known from Cobalt Strike beacons\nreferences:\n    - https://www.icebrg.io/blog/footprints-of-fin7-tracking-actor-patterns\nauthor: Florian Roth\ndate: 2018/05/10\nlogsource:\n    category: dns\ndetection:\n    selection:\n        query:\n            - 'aaa.stage.*' \n            - 'post.1*'\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/network/net_mal_dns_cobaltstrike.yml", "hash": "bfa739b787efbac5537f2383772dcac6a9edfd4be171c812aa6a8defb8e21def", "level": "high", "is_verified": false, "downloads": 0}, "0gI632MBqfpvXJhT2QxA": {"status": "testing", "category": "", "updated": "2018-06-08T11:49:25Z", "user_id": "80", "views": 16, "downloads": 2, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: LokiBot Trojan Detector.", "released": "2018-06-08T11:49:25Z", "sigma_text": "title: LokiBot Trojan Detector.\ndescription: LokiBot Trojan Detector.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n- https://www.threatfabric.com/blogs/lokibot_the_first_hybrid_android_malware.html\n- https://exchange.xforce.ibmcloud.com/botnet/lokibot\ndate: 2018/03/08\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection1:\n    EventID: \"1\"\n    CommandLine:\n    - GET /bobby/\n    - POST /bobby/Panel/\n  selection2:\n    file_hash:\n    - 3C4BE617FDA78DA05B38F4EE52121E99\n    - 7FB5A88768D7ECE242DBD4B30EDEFF0C\n    - 14A4DFFE0105A7DEF2A1EFF32899A9AC\n    - E69245E9685CB204105E69C424F304CC\n    - 75CCD03BB4934490A9F599A15381F43D\n    - 68BEFE15006189CE8215371935F8E720\n    - 05869152534B238D25051F7718FDB382\n    - 3DFA31D85482009479FEAFD5AF7E818A\n  condition: selection1 or selection2\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Execution:\n  - User Execution\n  - Command-Line Interface", "title": "sigma: LokiBot Trojan Detector.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "aad61afcbf3992cde9bcbd4d08bb58c8fd09530d14881b373eb7bfb5f224307d", "level": "high"}, "3bMw42IB8Wx35J1-XMzP": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:40.301987", "user_id": null, "views": 1, "permission_id": 3, "author": "John Lambert (idea), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: PowerShell Credential Prompt", "released": "2018-04-20T13:13:40.301984", "sigma_text": "title: PowerShell Credential Prompt\nstatus: experimental\ndescription: Detects PowerShell calling a credential prompt. Modified by SOC Prime, replaced condition \"all of them\" with \"selection and keyword\"\nreferences:\n    - https://twitter.com/JohnLaTwC/status/850381440629981184\n    - https://t.co/ezOTGy1a1G\nauthor: John Lambert (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'Script block logging must be enabled'\ndetection:\n    selection:\n        EventID: 4104\n    keyword:\n        - 'PromptForCredential'\n    condition: selection and keyword\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_prompt_credentials.yml", "title": "sigma: PowerShell Credential Prompt", "author_keyword": "John Lambert (idea), Florian Roth (rule)", "is_verified": true, "downloads": 1, "hash": "e872d548e5acacb3dfef811532439f9f339ab8b168528667949cb4fc7751ce07", "level": "high"}, "v7Mv42IB8Wx35J1-_swc": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:16.058496", "user_id": null, "views": "4", "permission_id": 3, "author": "Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)", "mitre_attack": null, "title_keyword": "sigma: Pass the Hash Activity", "released": "2018-04-20T13:13:16.058493", "sigma_text": "title: Pass the Hash Activity\nstatus: experimental\ndescription: 'Detects the attack technique pass the hash which is used to move laterally inside the network'\nreferences:\n    - https://github.com/iadgov/Event-Forwarding-Guidance/tree/master/Events\nauthor: Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)\nlogsource:\n    product: windows\n    service: security\n    description: The successful use of PtH for lateral movement between workstations would trigger event ID 4624, a failed logon attempt would trigger an event ID 4625\ndetection:\n    selection:\n        - EventID: 4624\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n        - EventID: 4625\n          LogonType: '3'\n          LogonProcessName: 'NtLmSsp'\n          WorkstationName: '%Workstations%'\n          ComputerName: '%Workstations%'\n    filter:\n        AccountName: 'ANONYMOUS LOGON'\n    condition: selection and not filter\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: medium\n", "git_filepath": "/windows/builtin/win_pass_the_hash.yml", "title": "sigma: Pass the Hash Activity", "author_keyword": "Ilias el Matani (rule), The Information Assurance Directorate at the NSA (method)", "is_verified": true, "downloads": 0, "hash": "d9b9f81b4cf51d900d21bfe78f50d07c16058a1df58bbf9edb37da60f1d2678a", "level": "medium"}, "qrMv42IB8Wx35J1-usza": {"status": "experimental", "category": 3, "updated": "2018-04-20T13:12:58.841071", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Named Error", "released": "2018-04-20T13:12:58.841068", "sigma_text": "title: Suspicious Named Error\nstatus: experimental\ndescription: Detects suspicious DNS error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/named_rules.xml\nauthor: Florian Roth\ndate: 2018/02/20\nlogsource:\n    product: linux\n    service: syslog\ndetection:\n    keywords:\n        - '* dropping source port zero packet from *'\n        - '* denied AXFR from *'\n        - '* exiting (due to fatal error)*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/linux/lnx_susp_named.yml", "title": "sigma: Suspicious Named Error", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "849def7473a8730ca7ed269763487c24babf2f8dbc0ce4ba5dc88105d7163dad", "level": "high"}, "sbMv42IB8Wx35J1-0cw0": {"status": "", "category": 1, "updated": "2018-04-20T13:13:04.563539", "user_id": null, "views": 1, "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Django framework exceptions", "released": "2018-04-20T13:13:04.563536", "sigma_text": "title: Django framework exceptions\ndescription: Detects suspicious Django web application framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.djangoproject.com/en/1.11/ref/exceptions/\n    - https://docs.djangoproject.com/en/1.11/topics/logging/#django-security\nlogsource:\n    category: application\n    product: django\ndetection:\n    keywords:\n        - SuspiciousOperation\n        # Subclasses of SuspiciousOperation\n        - DisallowedHost\n        - DisallowedModelAdminLookup\n        - DisallowedModelAdminToField\n        - DisallowedRedirect\n        - InvalidSessionKey\n        - RequestDataTooBig\n        - SuspiciousFileOperation\n        - SuspiciousMultipartForm\n        - SuspiciousSession\n        - TooManyFieldsSent\n        # Further security-related exceptions\n        - PermissionDenied\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_django_exceptions.yml", "title": "sigma: Django framework exceptions", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "b63d176cddd09eba823355eb2ee8dbdebe25492b29f9c0ccceab31527a93d0c4", "level": "medium"}, "uDwdG2YBatiiaHt9jSQw": {"status": "", "category": null, "updated": "2018-09-27T12:58:20.649697", "author_keyword": "@neu5ron", "user_id": null, "title": "Weak Encryption Enabled and Kerberoast", "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "Weak Encryption Enabled and Kerberoast", "released": "2018-09-27T12:58:20.649694", "sigma_text": "title: Weak Encryption Enabled and Kerberoast\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\nreferences:\n    - https://adsecurity.org/?p=2053\n    - https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\ndetection:\n    selection:\n        EventID: 4738\n    keywords:\n        - 'DES'\n        - 'Preauth'\n        - 'Encrypted'\n    filters:\n        - 'Enabled'\n    condition: selection and keywords and filters\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_enable_weak_encryption.yml", "hash": "1521c23a2b8bba15fd02009bac26b77bbf4c67c9a70a121ac47536dcb911ba44", "level": "high", "is_verified": false, "downloads": 0}, "szwdG2YBatiiaHt9iSRP": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:19.655991", "author_keyword": "Florian Roth (rule), Jack Croock (method)", "user_id": null, "title": "Reconnaissance Activity", "permission_id": 3, "author": "Florian Roth (rule), Jack Croock (method)", "mitre_attack": null, "title_keyword": "Reconnaissance Activity", "released": "2018-09-27T12:58:19.655989", "sigma_text": "title: Reconnaissance Activity\nstatus: experimental\ndescription: 'Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"'\nreferences:\n    - https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\nauthor: Florian Roth (rule), Jack Croock (method)\ntags:\n    - attack.discovery\n    - attack.t1087\n    - attack.t1069\n    - attack.s0039\nlogsource:\n    product: windows\n    service: security\n    description: The volume of Event ID 4661 is high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems\ndetection:\n    selection:\n        - EventID: 4661\n          ObjectType: 'SAM_USER'\n          ObjectName: 'S-1-5-21-*-500'\n          AccessMask: '0x2d'\n        - EventID: 4661\n          ObjectType: 'SAM_GROUP'\n          ObjectName: 'S-1-5-21-*-512'\n          AccessMask: '0x2d'\n    condition: selection\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_net_recon_activity.yml", "hash": "4c6b331ab4b8d43ee4d6455103a0ba4cbd05b3ce7af4a2a369af7c0ea3f56e07", "level": "high", "is_verified": false, "downloads": 0}, "pLMv42IB8Wx35J1-p8y8": {"status": "", "category": 3, "updated": "2018-04-20T13:12:53.946631", "user_id": null, "views": "1", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Multiple Failed Logins with Different Accounts from Single Source System", "released": "2018-04-20T13:12:53.946628", "sigma_text": "title: Multiple Failed Logins with Different Accounts from Single Source System\ndescription: Detects suspicious failed logins with different user accounts from a single source system\nlogsource:\n    product: linux\n    service: auth\ndetection:\n    selection:\n        pam_message: \"authentication failure\"\n        pam_user: not null\n        pam_rhost: not null\n    timeframe: 24h \n    condition: selection | count(pam_user) by pam_rhost > 3\nfalsepositives:\n    - Terminal servers\n    - Jump servers\n    - Workstations with frequently changing users \nlevel: medium\n", "git_filepath": "/linux/lnx_susp_failed_logons_single_source.yml", "title": "sigma: Multiple Failed Logins with Different Accounts from Single Source System", "author_keyword": null, "is_verified": false, "downloads": 0, "hash": "d60ee696488c98a137a13df338b1644923e1f6c4d25d9f81b813385cfdf7d887", "level": "medium"}, "MrMx42IB8Wx35J1-a80Z": {"status": "", "category": 6, "updated": "2018-04-20T13:14:49.495436", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Apache Segmentation Fault", "released": "2018-04-20T13:14:49.495433", "sigma_text": "title: Apache Segmentation Fault\ndescription: Detects a segmentation fault error message caused by a creashing apacke worker process \nauthor: Florian Roth\nreferences:\n    - http://www.securityfocus.com/infocus/1633\nlogsource:\n    product: apache\ndetection:\n    keywords:\n        - 'exit signal Segmentation Fault'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/web/web_apache_segfault.yml", "title": "sigma: Apache Segmentation Fault", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "7b91b70b26a6849c372a058ffb811f124b545e6c2a150c32b4ba1633b221bff7", "level": "high"}, "pDwdG2YBatiiaHt9fCTN": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:16.454905", "author_keyword": "Roberto Rodriguez (source), Dominik Schaudel (rule)", "user_id": null, "title": "Successful Overpass the Hash Attempt", "permission_id": 3, "author": "Roberto Rodriguez (source), Dominik Schaudel (rule)", "mitre_attack": null, "title_keyword": "Successful Overpass the Hash Attempt", "released": "2018-09-27T12:58:16.454903", "sigma_text": "title: Successful Overpass the Hash Attempt\nstatus: experimental\ndescription: Detects successful logon with logon type 9 (NewCredentials) which matches the Overpass the Hash behavior of e.g Mimikatz's sekurlsa::pth module.\nreferences: \n    - https://cyberwardog.blogspot.de/2017/04/chronicles-of-threat-hunter-hunting-for.html\nauthor: Roberto Rodriguez (source), Dominik Schaudel (rule)\ndate: 2018/02/12\ntags:\n    - attack.lateral_movement\n    - attack.t1075\n    - attack.s0002\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4624\n        LogonType: 9\n        LogonProcessName: seclogo\n        AuthenticationPackageName: Negotiate\n    condition: selection\nfalsepositives:\n    - Runas command-line tool using /netonly parameter\nlevel: high\n", "git_filepath": "/windows/builtin/win_overpass_the_hash.yml", "hash": "115d68531154218c30cb6f5f918c53495ab7d9f5f30d2470e20ed7f55258d01a", "level": "high", "is_verified": false, "downloads": 0}, "5rMw42IB8Wx35J1-ecyw": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:47.694640", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious PowerShell Invocation based on Parent Process", "released": "2018-04-20T13:13:47.694637", "sigma_text": "title: Suspicious PowerShell Invocation based on Parent Process\nstatus: experimental\ndescription: Detects suspicious powershell invocations from interpreters or unusual programs\nauthor: Florian Roth\nreferences:\n    - https://www.carbonblack.com/2017/03/15/attackers-leverage-excel-powershell-dns-latest-non-malware-attack/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n        Image:\n            - '*\\powershell.exe'\n    falsepositive:\n        CurrentDirectory: '*\\Health Service State\\*'\n    condition: selection and not falsepositive\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Microsoft Operations Manager (MOM)\n    - Other scripts\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_powershell_parent_combo.yml", "title": "sigma: Suspicious PowerShell Invocation based on Parent Process", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "b54ef9d9ab21e28c6eec303576de76114581083f87c00c11d33d0849e0dd8a70", "level": "medium"}, "9LMw42IB8Wx35J1-pcyP": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:58.925583", "user_id": null, "views": 2, "permission_id": 3, "author": "Michael Haag", "mitre_attack": null, "title_keyword": "sigma: MSHTA Spawning Windows Shell", "released": "2018-04-20T13:13:58.925580", "sigma_text": "title: MSHTA Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from MSHTA.\nreferences:\n    - https://www.trustedsec.com/july-2015/malicious-htas/\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mshta.exe'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\reg.exe'\n            - '*\\regsvr32.exe'\n            - '*\\BITSADMIN*'\n    filter:\n        CommandLine:\n            - '*/HP/HP*'\n            - '*\\HP\\HP*'\n    condition: selection and not filter\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Printer software / driver installations\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_mshta_spawn_shell.yml", "title": "sigma: MSHTA Spawning Windows Shell", "author_keyword": "Michael Haag", "is_verified": false, "downloads": 0, "hash": "2fd45ca197e3ac906efca3e679cb1d694b4897918ce29aefcb364515b65affd0", "level": "high"}, "cjxvAmMB_9rlszZ2vM9C": {"status": "testing", "category": "", "updated": "2018-04-30T13:13:45Z", "user_id": "80", "views": 54, "downloads": 1, "author": "Alexandr Yampolskiy, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: OrangeWorm Kwampirs service installation.", "released": "2018-04-26T14:51:07Z", "sigma_text": "title: OrangeWorm Kwampirs service installation.\ndescription: Kwampirs service creation detection. test\nreferences:\n- https://www.symantec.com/blogs/threat-intelligence/orangeworm-targets-healthcare-us-europe-asia\nstatus: testing\nlogsource:\n  product: windows\n  service: system\ndetection:\n  selection:\n    EventID: \"7045\"\n    ServiceName:\n    - WmiApSrvEx\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: low\nauthor: Alexandr Yampolskiy, SOC Prime\nmitre-attack:\n  Persistence:\n  - New Service", "title": "sigma: OrangeWorm Kwampirs service installation.", "author_keyword": "Alexandr Yampolskiy, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "72af8067c3014fed0646fee852598d0613b5d16cfc89452f5667de4e119f5ab9", "level": "low"}, "GbMx42IB8Wx35J1-G81h": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:29.087300", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Rundll32 Internet Connection", "released": "2018-04-20T13:14:29.087297", "sigma_text": "title: Rundll32 Internet Connection\nstatus: experimental\ndescription: Detects a rundll32 that communicates with piblic IP addresses\nreferences:\n    - https://www.hybrid-analysis.com/sample/759fb4c0091a78c5ee035715afe3084686a8493f39014aea72dae36869de9ff6?environmentId=100\nauthor: Florian Roth\ndate: 2017/11/04\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        Image: '*\\rundll32.exe'\n    filter:\n        DestinationIp: \n            - '10.*'\n            - '192.168.*'\n            - '172.*'\n    condition: selection and not filter\nfalsepositives:\n    - Communication to other corporate systems that use IP addresses from public address spaces\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_rundll32_net_connections.yml", "title": "sigma: Rundll32 Internet Connection", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "59b186e67c01beacb3c87b7ddf21ca34c28cbc9290e2a7dd7956c9604135b7e5", "level": "medium"}, "rDwdG2YBatiiaHt9hCQs": {"status": "", "category": null, "updated": "2018-09-27T12:58:18.341955", "author_keyword": "@neu5ron", "user_id": null, "title": "Enabled User Right in AD to Control User Objects", "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "Enabled User Right in AD to Control User Objects", "released": "2018-09-27T12:58:18.341953", "sigma_text": "title: Enabled User Right in AD to Control User Objects\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects.\ntags:\n    - attack.privilege_escalation\n    - attack.t1078\nreferences:\n    - https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\ndetection:\n    selection:\n        EventID: 4704\n    keywords:\n        - 'SeEnableDelegationPrivilege'\n    condition: all of them\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_active_directory_user_control.yml", "hash": "9c436cd0aa4c479cee6192fe6be057e8dbbd339c29e5cafafa4552603f33ebf0", "level": "high", "is_verified": false, "downloads": 0}, "6rMw42IB8Wx35J1-hswv": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:50.893687", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: System File Execution Location Anomaly", "released": "2018-04-20T13:13:50.893684", "sigma_text": "title: System File Execution Location Anomaly\nstatus: experimental\ndescription: Detects a Windows program executable started in a suspicious folder\nreferences:\n    - https://twitter.com/GelosSnake/status/934900723426439170\nauthor: Florian Roth\ndate: 2017/11/27\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\svchost.exe'\n            - '*\\rundll32.exe'\n            - '*\\services.exe'\n            - '*\\powershell.exe'\n            - '*\\regsvr32.exe'\n            - '*\\spoolsv.exe'\n            - '*\\lsass.exe'\n            - '*\\smss.exe'\n            - '*\\csrss.exe'\n            - '*\\conhost.exe'\n    filter:\n        Image: \n            - '*\\System32\\*'\n            - '*\\SysWow64\\*'\n    condition: selection and not filter\nfalsepositives:\n    - Exotic software\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_system_exe_anomaly.yml", "title": "sigma: System File Execution Location Anomaly", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 2, "hash": "8cc7ed0a82f344040125aedac8f6f4ecf81c59bb166cfec179bfd8d05aeef99c", "level": "high"}, "wbMw42IB8Wx35J1-BMxi": {"status": "", "category": 11, "updated": "2018-04-20T13:13:17.664383", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Mimikatz Use", "released": "2018-04-20T13:13:17.664363", "sigma_text": "title: Mimikatz Use\ndescription: This method detects mimikatz keywords in different Eventlogs (some of them only appear in older Mimikatz version that are however still used by different threat groups)\nauthor: Florian Roth\nlogsource:\n    product: windows\ndetection:\n    keywords:\n        - mimikatz\n        - mimilib\n        - <3 eo.oe\n        - eo.oe.kiwi\n        - privilege::debug\n        - sekurlsa::logonpasswords\n        - lsadump::sam\n        - mimidrv.sys\n    condition: keywords\nfalsepositives:\n    - Naughty administrators\n    - Penetration test\nlevel: critical\n", "git_filepath": "/windows/builtin/win_alert_mimikatz_keywords.yml", "title": "sigma: Mimikatz Use", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 2, "hash": "2d890e1d6bab9b9e4022b70b417ff61784b479174bd5b9d49d71278a3d0f086b", "level": "critical"}, "JLMx42IB8Wx35J1-Pc3W": {"status": "experimental", "category": 12, "updated": "2018-04-20T13:14:37.908793", "user_id": null, "views": 9, "permission_id": 3, "author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "mitre_attack": null, "title_keyword": "sigma: WannaCry Ransomware via Sysmon", "released": "2018-04-20T13:14:37.908790", "sigma_text": "title: WannaCry Ransomware via Sysmon\nstatus: experimental\ndescription: Detects WannaCry ransomware activity via Sysmon. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2\"\nreferences:\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection) \nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection1:\n        EventID: 1\n        Image:\n            - '*\\tasksche.exe'\n            - '*\\mssecsvc.exe'\n            - '*\\taskdl.exe'\n            - '*\\@WanaDecryptor@*'\n            - '*\\taskhsvc.exe'\n            - '*\\taskse.exe'\n            - '*\\111.exe'\n            - '*\\lhdfrgui.exe'\n            - '*\\diskpart.exe'  # Rare, but can be false positive\n            - '*\\linuxnew.exe'\n            - '*\\wannacry.exe'\n    selection2:\n        EventID: 1\n        CommandLine:\n            - '*vssadmin delete shadows*'\n            - '*icacls * /grant Everyone:F /T /C /Q*'\n            - '*bcdedit /set {default} recoveryenabled no*'\n            - '*wbadmin delete catalog -quiet*'\n            - '*@Please_Read_Me@.txt*'\n    condition: selection1 or selection2\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Diskpart.exe usage to manage partitions on the local hard drive\nlevel: critical\n", "git_filepath": "/windows/malware/sysmon_malware_wannacry.yml", "title": "sigma: WannaCry Ransomware via Sysmon", "author_keyword": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "is_verified": true, "downloads": 0, "hash": "e78db4fa63f828469687b2d8666ed59e1a995a3f1a006755e4874b1b44c09f56", "level": "critical"}, "8rMw42IB8Wx35J1-n8xA": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:57.310618", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Program Location with Network Connections", "released": "2018-04-20T13:13:57.310615", "sigma_text": "title: Suspicious Program Location with Network Connections\nstatus: experimental\ndescription: Detects programs with network connections running in suspicious files system locations\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\nauthor: Florian Roth\ndate: 2017/03/19\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 3 Network Connection events'\ndetection:\n    selection:\n        EventID: 3\n        Image: \n            - '*\\ProgramData\\*'\n            - '*\\$Recycle.bin'\n            - '*\\Users\\All Users\\*'\n            - '*\\Users\\Default\\*'\n            - '*\\Users\\Public\\*'\n            - 'C:\\Perflogs\\*'\n            - '*\\config\\systemprofile\\*'\n            - '*\\Windows\\Fonts\\*'\n            - '*\\Windows\\IME\\*'\n            - '*\\Windows\\addins\\*'\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high", "git_filepath": "/windows/sysmon/sysmon_susp_prog_location_network_connection.yml", "title": "sigma: Suspicious Program Location with Network Connections", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "7edf4f98e03538876919a35e953c1516140e0976dfc532ec5c3e7009b3c19d2c", "level": "high"}, "tDwdG2YBatiiaHt9iiQb": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:19.861328", "author_keyword": null, "user_id": null, "title": "Suspicious Kerberos RC4 Ticket Encryption", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "Suspicious Kerberos RC4 Ticket Encryption", "released": "2018-09-27T12:58:19.861325", "sigma_text": "title: Suspicious Kerberos RC4 Ticket Encryption\nstatus: experimental\nreferences:\n    - https://adsecurity.org/?p=3458\n    - https://www.trimarcsecurity.com/single-post/TrimarcResearch/Detecting-Kerberoasting-Activity\ntags:\n    - attack.credential_access\n    - attack.t1208\ndescription: Detects service ticket requests using RC4 encryption type\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4769\n        TicketOptions: '0x40810000'\n        TicketEncryptionType: '0x17'\n    reduction:\n        - ServiceName: '$*'\n    condition: selection and not reduction\nfalsepositives:\n    - Service accounts used on legacy systems (e.g. NetApp)\n    - Windows Domains with DFL 2003 and legacy systems\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_rc4_kerberos.yml", "hash": "e6d308fe9568559c81315e918037c33747fe18ce42925d1845df0cc218f15466", "level": "medium", "is_verified": false, "downloads": 0}, "hzwdG2YBatiiaHt9ZSR5": {"status": "", "category": null, "updated": "2018-09-27T12:58:10.483350", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious VSFTPD Error Messages", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious VSFTPD Error Messages", "released": "2018-09-27T12:58:10.483347", "sigma_text": "title: Suspicious VSFTPD Error Messages\ndescription: Detects suspicious VSFTPD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/dagwieers/vsftpd/\nauthor: Florian Roth\ndate: 2017/07/05\nlogsource:\n    product: linux\n    service: vsftpd\ndetection:\n    keywords:\n        - 'Connection refused: too many sessions for this address.'\n        - 'Connection refused: tcp_wrappers denial.'\n        - 'Bad HTTP verb.'\n        - 'port and pasv both active'\n        - 'pasv and port both active'\n        - 'Transfer done (but failed to open directory).'\n        - 'Could not set file modification time.'\n        - 'bug: pid active in ptrace_sandbox_free'\n        - 'PTRACE_SETOPTIONS failure'\n        - 'weird status:'\n        - \"couldn't handle sandbox event\"\n        - 'syscall * out of bounds'\n        - 'syscall not permitted:'\n        - 'syscall validate failed:'\n        - 'Input line too long.'\n        - 'poor buffer accounting in str_netfd_alloc'\n        - 'vsf_sysutil_read_loop'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_susp_vsftp.yml", "hash": "f032d1128d52f2af5f2a11d18e75401074f6ff22482c57c84d76e5b8125602b4", "level": "medium", "is_verified": false, "downloads": 0}, "bALbtWMBqfpvXJhTMwzq": {"status": "testing", "category": "", "updated": "2018-06-01T08:40:57Z", "user_id": "80", "views": 90, "downloads": 7, "author": "Alexandr Yamposlkyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: HIDDEN COBRA RAT/Worm.", "released": "2018-05-31T11:00:31Z", "sigma_text": "title: HIDDEN COBRA RAT/Worm.\ndescription: HIDDEN COBRA RAT/Worm Detector.\nreferences:\n- https://www.us-cert.gov/ncas/analysis-reports/AR18-149A\nauthor: Alexandr Yamposlkyi, SOC Prime\nstatus: testing\ndate: 2018/06/29\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection1:\n    EventID: \"1\"\n    file_hash:\n    - 4731cbaee7aca37b596e38690160a749\n    - 80fac6361184a3e24b33f6acb8688a6b7276b0f2\n    - 077d9e0e12357d27f7f0c336239e961a7049971446f7a3f10268d9439ef67885\n    - 4613f51087f01715bf9132c704aea2c2\n    - 6b1ddf0e63e04146d68cd33b0e18e668b29035c4\n    - a1c483b0ee740291b91b11e18dd05f0a460127acfc19d47b446d11cd0e26d717\n    - e86c2f4fc88918246bf697b6a404c3ea\n    - 9b7609349a4b9128b9db8f11ac1c77728258862c\n    - ea46ed5aed900cd9f01156a1cd446cbb3e10191f9f980e9f710ea1c20440c781\n    - 298775b04a166ff4b8fbd3609e716945\n    - 2e0f666831f64d7383a11b444e2c16b38231f481\n    - fe7d35d19af5f5ae2939457a06868754b8bdd022e1ff5bdbe4e7c135c48f9a16\n  selection2:\n    EventID: \"1\"\n    CommandLine:\n    - cmd.exe /q /c net share adnim$=%SystemRoot%\n    - cmd.exe /q /c net share adnim$=%%SystemRoot%% /GRANT:%s,FULL\n    - cmd.exe /q /c net share adnim$ /delete\n    - cmd.exe /q /c net share adnim$=%SystemRoot% /GRANT:Administrator,FULL\n    - cmd.exe /q /c net share adnim$=%SystemRoot%\n    - cmd.exe /q /c net share adnim$=%%SystemRoot%% /GRANT:%s,FULL\n  condition: selection1 or selection2\nfields:\n- Image\n- CommandLine\n- TargetObject\n- Hashes\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Defense Evasion:\n  - Indicator Removal on Host\n  Execution:\n  - Command-Line Interface", "title": "sigma: HIDDEN COBRA RAT/Worm.", "author_keyword": "Alexandr Yamposlkyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "5ec262af7fe5c9f9cfe8a145cb97df0cad13c679e41a78fa1524ce5697cd5bba", "level": "high"}, "rjwdG2YBatiiaHt9hSRu": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:18.664011", "author_keyword": "Markus Neis", "user_id": null, "title": "LSASS Access Detected via Attack Surface Reduction", "permission_id": 3, "author": "Markus Neis", "mitre_attack": null, "title_keyword": "LSASS Access Detected via Attack Surface Reduction", "released": "2018-09-27T12:58:18.664008", "sigma_text": "title: LSASS Access Detected via Attack Surface Reduction\r\ndescription: Detects Access to LSASS Process\r\nstatus: experimental\r\nreferences:\r\n    - https://docs.microsoft.com/en-us/windows/security/threat-protection/windows-defender-exploit-guard/attack-surface-reduction-exploit-guard?WT.mc_id=twitter\r\nauthor: Markus Neis\r\ndate: 2018/08/26\r\ntags:\r\n    - attack.credential_access\r\n    - attack.t1003\r\n# Defender Attack Surface Reduction\r\nlogsource:\r\n    product: windows_defender\r\n    description: 'Requirements:Enabled Block credential stealing from the Windows local security authority subsystem (lsass.exe) from Attack Surface Reduction (GUID: 9e6c4e1f-7d60-472f-ba1a-a39ef669e4b2)'\r\ndetection:\r\n    selection:\r\n        EventID: 1121\r\n        Path: '*\\lsass.exe'\r\n    condition: selection\r\nfalsepositives:\r\n    - Google Chrome GoogleUpdate.exe\r\n    - Some Taskmgr.exe related activity\r\nlevel: high\r\n", "git_filepath": "/windows/builtin/win_alert_LSASS_access.yml", "hash": "71cc5cbc7000a797c92ac48cbe248a024c6bb219149feea45ecc23d6f3664172", "level": "high", "is_verified": false, "downloads": 0}, "2LMw42IB8Wx35J1-Tcxm": {"status": "stable", "category": 11, "updated": "2018-04-20T13:13:36.356501", "user_id": null, "title": "sigma: Password Change on Directory Service Restore Mode (DSRM) Account", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: Password Change on Directory Service Restore Mode (DSRM) Account", "released": "2018-04-20T13:13:36.356498", "sigma_text": "title: Password Change on Directory Service Restore Mode (DSRM) Account\nstatus: stable\ndescription: The Directory Service Restore Mode (DSRM) account is a local administrator account on Domain Controllers. Attackers may change the password to gain persistence.\nreferences:\n    - https://adsecurity.org/?p=1714\nauthor: Thomas Patzke\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4794\n    condition: selection\nfalsepositives:\n    - Initial installation of a domain controller\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_dsrm_password_change.yml", "hash": "1741f5d480a73694de4fd453b0f1719ab88ae9d9e5048b842b713ec8c9e6666a", "author_keyword": "Thomas Patzke", "is_verified": false, "downloads": 0, "level": "high"}, "IrMx42IB8Wx35J1-N82A": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:36.286666", "user_id": null, "views": 2, "permission_id": 3, "author": "John Lambert (tech), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Malware Shellcode in Verclsid Target Process", "released": "2018-04-20T13:14:36.286663", "sigma_text": "title: Malware Shellcode in Verclsid Target Process\nstatus: experimental\ndescription: Detetcs a process access to verclsid.exe that injects shellcode from a Microsoft Office application / VBA macro. Modified by SOC Prime, replaced condition \"selection and 1 of combination*\" with \"selection and (combination1 or combination2)\"\nreferences:\n    - https://twitter.com/JohnLaTwC/status/837743453039534080\nauthor: John Lambert (tech), Florian Roth (rule)\ndate: 2017/03/04\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 10\n        TargetImage: '*\\verclsid.exe'\n        GrantedAccess: '0x1FFFFF'\n    combination1:\n        CallTrace: '*|UNKNOWN(*VBE7.DLL*'\n    combination2:\n        SourceImage: '*\\Microsoft Office\\*'\n        CallTrace: '*|UNKNOWN*'\n    condition: selection and (combination1 or combination2)\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_malware_verclsid_shellcode.yml", "title": "sigma: Malware Shellcode in Verclsid Target Process", "author_keyword": "John Lambert (tech), Florian Roth (rule)", "is_verified": true, "downloads": 0, "hash": "c9c170a1d3ebc22a62023cbefa1c7fa007e34aa240ba1e3e9abf59428a81632b", "level": "high"}, "vLMv42IB8Wx35J1-9MzC": {"status": "", "category": 11, "updated": "2018-04-20T13:13:13.664418", "user_id": null, "title": "sigma: Enabled User Right in AD to Control User Objects", "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "sigma: Enabled User Right in AD to Control User Objects", "released": "2018-04-20T13:13:13.664415", "sigma_text": "title: Enabled User Right in AD to Control User Objects\ndescription: Detects scenario where if a user is assigned the SeEnableDelegationPrivilege right in Active Directory it would allow control of other AD user objects. Modified by SOC Prime, replaced condition \"all of them\" with \"selection and keywords\"\nreferences:\n    - https://www.harmj0y.net/blog/activedirectory/the-most-dangerous-user-right-you-probably-have-never-heard-of/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Policy Change > Audit Authorization Policy Change, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Authorization Policy Change'\ndetection:\n    selection:\n        EventID: 4707\n    keywords:\n        - 'SeEnableDelegationPrivilege'\n    condition: selection and keywords\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_active_directory_user_control.yml", "hash": "5fc41661616fb98d29447cfe1c7d2c9a91c6c57932c74ddb147c1ef7d93b796a", "author_keyword": "@neu5ron", "is_verified": false, "downloads": 0, "level": "high"}, "zLMw42IB8Wx35J1-J8yz": {"status": "", "category": 11, "updated": "2018-04-20T13:13:26.705795", "user_id": null, "views": "4", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Eventlog Cleared", "released": "2018-04-20T13:13:26.705792", "sigma_text": "title: Eventlog Cleared\ndescription: One of the Windows Eventlogs has been cleared\nreferences:\n    - https://twitter.com/deviouspolack/status/832535435960209408\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_eventlog_cleared.yml", "title": "sigma: Eventlog Cleared", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "7642b7d2c45fdd640fa86e433932f317a3bad37bd3ad0762c6dc83def183e552", "level": "medium"}, "tLMv42IB8Wx35J1-28za": {"status": "", "category": 11, "updated": "2018-04-20T13:13:07.288798", "user_id": null, "views": "6", "permission_id": 3, "author": "Dimitrios Slamaris", "mitre_attack": null, "title_keyword": "sigma: Possible Remote Password Change Through SAMR", "released": "2018-04-20T13:13:07.288795", "sigma_text": "title: Possible Remote Password Change Through SAMR \ndescription: Detects a possible remote NTLM hash change through SAMR API SamiChangePasswordUser() or SamSetInformationUser(). \"Audit User Account Management\" in \"Advanced Audit Policy Configuration\" has to be enabled in your local security policy / GPO to see this events.\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: security\ndetection:\n    samrpipe:\n              EventID: 5145\n              RelativeTargetName: samr\n    passwordchanged:\n              EventID: 4738\n              PasswordLastSet: (any) \n    timeframe: 15s \n    condition: samrpipe | near passwordchanged\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_samr_pwset.yml", "title": "sigma: Possible Remote Password Change Through SAMR", "author_keyword": "Dimitrios Slamaris", "is_verified": true, "downloads": 0, "hash": "0d9a281669aad78ded659f0d04634ab8a9c2c408decef5593f624ca3c5a41643", "level": "medium"}, "ljwdG2YBatiiaHt9cSSX": {"status": "", "category": null, "updated": "2018-09-27T12:58:13.584846", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Python SQL Exceptions", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Python SQL Exceptions", "released": "2018-09-27T12:58:13.584836", "sigma_text": "title: Python SQL Exceptions\ndescription: Generic rule for SQL exceptions in Python according to PEP 249\nauthor: Thomas Patzke\nreferences:\n    - https://www.python.org/dev/peps/pep-0249/#exceptions\nlogsource:\n    category: application\n    product: python\ndetection:\n    exceptions:\n        - DataError\n        - IntegrityError\n        - ProgrammingError\n        - OperationalError\n    condition: exceptions\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/app_python_sql_exceptions.yml", "hash": "728818f710d6f0a4e5639fa6e9fa8a238157a574f63bb9ce1dcb502b30d5575b", "level": "medium", "is_verified": false, "downloads": 0}, "wLMw42IB8Wx35J1-AcxM": {"status": "stable", "category": 11, "updated": "2018-04-20T13:13:16.874466", "user_id": null, "views": "9", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: User Added to Local Administrators", "released": "2018-04-20T13:13:16.874462", "sigma_text": "title: User Added to Local Administrators\ndescription: This rule triggers on user accounts that are added to the local Administrators group, which could be legitimate activity or a sign of privilege escalation activity \nstatus: stable\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID: 4732\n        GroupName: Administrators\n    filter:\n        SubjectUserName: '*$'\n    condition: selection and not filter\nfalsepositives: \n    - Legitimate administrative activity\nlevel: low\n", "git_filepath": "/windows/builtin/win_user_added_to_local_administrators.yml", "title": "sigma: User Added to Local Administrators", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 7, "hash": "9dac896d6ab0662fee5570a48f5340aa82458af5df83b4f3a053b4e4d6df0319", "level": "low"}, "RwJGkWMBqfpvXJhTmgyg": {"status": "testing", "category": "", "updated": "2018-05-24T08:54:57Z", "user_id": "80", "views": 53, "downloads": 6, "author": "Alexandr Yamposlkyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: VPNFilter Malware Detector (Hashes).", "released": "2018-05-24T08:31:53Z", "sigma_text": "title: VPNFilter Malware Detector (Hashes).\ndescription: VPNFilter Malware Hashes Detector.\nreferences:\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\nauthor: Alexandr Yamposlkyi, SOC Prime\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    file_hash:\n    - 50ac4fcd3fbc8abcaa766449841b3a0a684b3e217fc40935f1ac22c34c58a9ec\n    - 0e0094d9bd396a6594da8e21911a3982cd737b445f591581560d766755097d92\n    - 9683b04123d7e9fe4c8c26c69b09c2233f7e1440f828837422ce330040782d17\n    - d6097e942dd0fdc1fb28ec1814780e6ecc169ec6d24f9954e71954eedbc4c70e\n    - 4b03288e9e44d214426a02327223b5e516b1ea29ce72fa25a2fcef9aa65c4b0b\n    - 9eb6c779dbad1b717caa462d8e040852759436ed79cc2172692339bc62432387\n    - 37e29b0ea7a9b97597385a12f525e13c3a7d02ba4161a6946f2a7d978cc045b4\n    - 776cb9a7a9f5afbaffdd4dbd052c6420030b2c7c3058c1455e0a79df0e6f7a1d\n    - 8a20dc9538d639623878a3d3d18d88da8b635ea52e5e2d0c2cce4a8c5a703db1\n    - 0649fda8888d701eb2f91e6e0a05a2e2be714f564497c44a3813082ef8ff250b\n    - f8286e29faa67ec765ae0244862f6b7914fcdde10423f96595cb84ad5cc6b344\n    - afd281639e26a717aead65b1886f98d6d6c258736016023b4e59de30b7348719\n  condition: selection\nfields:\n- Image\n- User\n- TargetObject\n- Hashes\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Persistence:\n  - Component Firmware\n  - Component Object Model Hijacking\n  - External Remote Services", "title": "sigma: VPNFilter Malware Detector (Hashes).", "author_keyword": "Alexandr Yamposlkyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "13bc264a8ef255227c2f04d075aa269410cae893e77e61a8c0dfcddb1c5660d2", "level": "high"}, "qTwdG2YBatiiaHt9gCTi": {"status": "", "category": null, "updated": "2018-09-27T12:58:17.499871", "author_keyword": "Florian Roth", "user_id": null, "title": "Kerberos Manipulation", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Kerberos Manipulation", "released": "2018-09-27T12:58:17.499868", "sigma_text": "title: Kerberos Manipulation\ndescription: This method triggers on rare Kerberos Failure Codes caused by manipulations of Kerberos messages\nauthor: Florian Roth\ntags:\n    - attack.credential_access\n    - attack.t1212\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n          - 675\n          - 4768\n          - 4769\n          - 4771\n        FailureCode:\n          - '0x9'\n          - '0xA'\n          - '0xB'\n          - '0xF'\n          - '0x10'\n          - '0x11'\n          - '0x13'\n          - '0x14'\n          - '0x1A'\n          - '0x1F'\n          - '0x21'\n          - '0x22'\n          - '0x23'\n          - '0x24'\n          - '0x26'\n          - '0x27'\n          - '0x28'\n          - '0x29'\n          - '0x2C'\n          - '0x2D'\n          - '0x2E'\n          - '0x2F'\n          - '0x31'\n          - '0x32'\n          - '0x3E'\n          - '0x3F'\n          - '0x40'\n          - '0x41'\n          - '0x43'\n          - '0x44'\n    condition: selection\nfalsepositives:\n    - Faulty legacy applications\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_kerberos_manipulation.yml", "hash": "e7d594a5f230e22682b7c684d9e87eb246428232ed597a3180b00a323db16368", "level": "high", "is_verified": false, "downloads": 0}, "7LMw42IB8Wx35J1-jMxx": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:52.495577", "user_id": null, "views": 3, "permission_id": 3, "author": "Michael Haag, Mark Woan (improvements)", "mitre_attack": null, "title_keyword": "sigma: Net.exe Execution", "released": "2018-04-20T13:13:52.495574", "sigma_text": "title: Net.exe Execution\nstatus: experimental\ndescription: Detects execution of Net.exe, whether suspicious or benign.\nreferences:\n    - https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/\nauthor: Michael Haag, Mark Woan (improvements)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\net.exe'\n            - '*\\net1.exe'\n        CommandLine:\n            - '* group*'\n            - '* localgroup*'\n            - '* user*'\n            - '* view*'\n            - '* share'\n            - '* accounts*'\n            - '* use*'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Will need to be tuned. If using Splunk, I recommend | stats count by Computer,CommandLine following the search for easy hunting by computer/CommandLine.\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_net_execution.yml", "title": "sigma: Net.exe Execution", "author_keyword": "Michael Haag, Mark Woan (improvements)", "is_verified": false, "downloads": 1, "hash": "02c81cd5c96afb5e7e21b07962a83e53267c470333485d8186f0aec41d6d2da0", "level": "medium"}, "yLMw42IB8Wx35J1-Gsxj": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:23.297505", "user_id": null, "views": "2", "permission_id": 3, "author": "Florian Roth (rule), Jack Croock (method)", "mitre_attack": null, "title_keyword": "sigma: Reconnaissance Activity", "released": "2018-04-20T13:13:23.297502", "sigma_text": "title: Reconnaissance Activity\nstatus: experimental\ndescription: 'Detects activity as \"net user administrator /domain\" and \"net group domain admins /domain\"' \nreferences:\n    - https://findingbad.blogspot.de/2017/01/hunting-what-does-it-look-like.html\nauthor: Florian Roth (rule), Jack Croock (method)\nlogsource:\n    product: windows\n    service: security\n    description: The volume of Event ID 4661 ist high on Domain Controllers and therefore \"Audit SAM\" and \"Audit Kernel Object\" advanced audit policy settings are not configured in the recommandations for server systems\ndetection:\n    selection:\n        - EventID: 4661\n          ObjectType: 'SAM_USER'\n          ObjectName: 'S-1-5-21-*-500'\n          AccessMask: '0x2d'\n        - EventID: 4661\n          ObjectType: 'SAM_GROUP'\n          ObjectName: 'S-1-5-21-*-512'\n          AccessMask: '0x2d'\n    condition: selection\nfalsepositives:\n    - Administrator activity\n    - Penetration tests\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_net_recon_activity.yml", "title": "sigma: Reconnaissance Activity", "author_keyword": "Florian Roth (rule), Jack Croock (method)", "is_verified": false, "downloads": 0, "hash": "22ae86745ba374928585e589f20035b16bafa97c1df8c305ce170436ecd31b57", "level": "high"}, "fjwmP2MB_9rlszZ2_s_g": {"status": "testing", "category": "", "updated": "2018-05-16T13:08:52Z", "user_id": "80", "views": 103, "downloads": 1, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Sofacy - APT C2 Domain Communication.", "released": "2018-05-08T09:48:30Z", "sigma_text": "title: Sofacy - APT C2 Domain Communication.\ndescription: Sofacy, \"Fancy\" Bear, \"Pawn\" Storm, \"APT\"-28 domain communication detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences:\n- https://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\n- https://securingtomorrow.mcafee.com/mcafee-labs/apt28-threat-group-adopts-dde-technique-nyc-attack-theme-in-latest-campaign\n- https://blog.trendmicro.com/trendlabs-security-intelligence/update-pawn-storm-new-targets-politically-motivated-campaigns\n- https://researchcenter.paloaltonetworks.com/2018/02/unit42-sofacy-attacks-multiple-government-entities\ndate: 2017/11/07\nstatus: testing\nlogsource:\n  product: proxy\ndetection:\n  selection:\n    r-dns:\n    - myinvestgroup.com\n    - netmediaresources.com\n    - webviewres.net\n    - adfs.senate.group\n    - adfs-senate.email\n    - adfs-senate.services\n    - adfs.senate.qov.info\n    - chmail.ir.udelivered.tk\n    - webmail-ibsf.org\n    - fil-luge.com\n    - biathlovvorld.com\n    - mail-ibu.eu\n    - fisski.ca\n    - iihf.eu\n    - Cdnverify.net\n    - osce-press.com\n    - electronicfrontierfoundation.org\n    - baltichost.org\n    - checkmalware.org\n    - kavkazcentr.info\n    - login-osce.org\n    - malwarecheck.info\n    - n0vinite.com\n    - nato.nshq.in\n    - natoexhibitionff14.com\n    - novinitie.com\n    - poczta.mon.q0v.pl\n    - q0v.pl\n    - qov.hu.com\n    - rnil.am\n    - scanmalware.info\n    - smigroup-online.co.uk\n    - standartnevvs.com\n    - updatecenter.name\n    - securitypractic.com\n    - drivers-update.info\n    - nato-press.com\n  condition: selection\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: Sofacy - APT C2 Domain Communication.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "069cd3164b63ebf3b5fd1b02c1ff6df33398aaadf2d5a30a303593ac456c72f5", "level": "medium"}, "ELMw42IB8Wx35J1-_s3q": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:21.800749", "user_id": null, "views": 3, "permission_id": 3, "author": "Michael Haag (idea), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Microsoft Binary Github Communication", "released": "2018-04-20T13:14:21.800746", "sigma_text": "title: Microsoft Binary Github Communication\nstatus: experimental\ndescription: Detects an executable in the Windows folder accessing github.com\nreferences:\n    - https://twitter.com/M_haggis/status/900741347035889665\nauthor: Michael Haag (idea), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 3\n        DestinationHostname: '*.github.com'\n        Image: 'C:\\Windows\\*'\n    condition: selection\nfalsepositives:\n    - 'Unknown'\n    - '@subTee in your network'\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_win_binary_github_com.yml", "title": "sigma: Microsoft Binary Github Communication", "author_keyword": "Michael Haag (idea), Florian Roth (rule)", "is_verified": false, "downloads": 0, "hash": "0f3f74756ace9f7a619502e2e773908b7cc5d8c29bf18813a9be341e5ca18152", "level": "high"}, "orMv42IB8Wx35J1-nsz7": {"status": "", "category": 10, "updated": "2018-04-20T13:12:51.704549", "user_id": null, "title": "sigma: Multiple Modsecurity Blocks", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Multiple Modsecurity Blocks", "released": "2018-04-20T13:12:51.704546", "sigma_text": "title: Multiple Modsecurity Blocks\ndescription: Detects multiple blocks by the mod_security module (Web Application Firewall) \nlogsource:\n    product: linux\n    service: modsecurity\ndetection:\n    selection:\n        - 'mod_security: Access denied'\n        - 'ModSecurity: Access denied'\n        - 'mod_security-message: Access denied'\n    timeframe: 120m \n    condition: selection | count() > 6\nfalsepositives:\n    - Vulnerability scanners\n    - Frequent attacks if system faces Internet\nlevel: medium\n", "git_filepath": "/linux/modsecurity/modsec_mulitple_blocks.yml", "hash": "c5cf7aabef064bce0c70368a8755b1b63ae4ca5949a718b08f423d494f38b4ce", "author_keyword": null, "is_verified": false, "downloads": 0, "level": "medium"}, "FrMx42IB8Wx35J1-Ec3U": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:26.639713", "user_id": null, "views": 3, "permission_id": 3, "author": "Florian Roth (rule), Daniel Bohannon (idea)", "mitre_attack": null, "title_keyword": "sigma: Suspicious PowerShell Parameter Substring", "released": "2018-04-20T13:14:26.639710", "sigma_text": "title: Suspicious PowerShell Parameter Substring\nstatus: experimental\ndescription: Detects suspicious PowerShell invocation with a parameter substring. Modified by SOC Prime, replaced condition \"all of them\" with \"keywords and substrings\"\nreferences:\n    - http://www.danielbohannon.com/blog-1/2017/3/12/powershell-execution-argument-obfuscation-how-it-can-make-detection-easier\nauthor: Florian Roth (rule), Daniel Bohannon (idea)\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    keywords:\n        Image: '*\\powershell.exe'\n    substrings:\n        - ' -windowstyle h '\n        - ' -windowstyl h'\n        - ' -windowsty h'\n        - ' -windowst h'\n        - ' -windows h'\n        - ' -windo h'\n        - ' -wind h'\n        - ' -win h'\n        - ' -wi h'\n        - ' -win h '\n        - ' -win hi '\n        - ' -win hid '\n        - ' -win hidd '\n        - ' -win hidde '\n        - ' -NoPr '\n        - ' -NoPro '\n        - ' -NoProf '\n        - ' -NoProfi '\n        - ' -NoProfil ' \n        - ' -nonin '\n        - ' -nonint '\n        - ' -noninte '\n        - ' -noninter '\n        - ' -nonintera '\n        - ' -noninterac '\n        - ' -noninteract '\n        - ' -noninteracti '\n        - ' -noninteractiv '\n        - ' -ec '\n        - ' -encodedComman '\n        - ' -encodedComma '\n        - ' -encodedComm '\n        - ' -encodedCom '\n        - ' -encodedCo '\n        - ' -encodedC '\n        - ' -encoded '\n        - ' -encode '\n        - ' -encod '\n        - ' -enco '\n        - ' -en '\n    condition: keywords and substrings\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_powershell_suspicious_parameter_variation.yml", "title": "sigma: Suspicious PowerShell Parameter Substring", "author_keyword": "Florian Roth (rule), Daniel Bohannon (idea)", "is_verified": true, "downloads": 0, "hash": "5b954fa8c5a418c6a9e7c8738d70425cb37d661d54b6c0c41bd260e7e1b93d18", "level": "high"}, "x7Mw42IB8Wx35J1-F8wz": {"status": "", "category": 11, "updated": "2018-04-20T13:13:22.481629", "user_id": null, "views": 2, "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "sigma: Active Directory User Backdoors", "released": "2018-04-20T13:13:22.481626", "sigma_text": "title: Active Directory User Backdoors\ndescription: Detects scenarios where one can control another users account without having to use their credentials via msDS-AllowedToDelegateTo and or service principal names (SPN). Modified by SOC Prime, replaced condition \"1 of them\" with \"selection1 or selection2 or selection3\"\nreferences:\n    - https://msdn.microsoft.com/en-us/library/cc220234.aspx\n    - https://adsecurity.org/?p=3466\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description1: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\n    description2: 'Requirements: Audit Policy : DS Access > Audit Directory Service Changes, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\DS Access\\Audit Directory Service Changes'\ndetection:\n    selection1:\n        EventID: 4738\n        AllowedToDelegateTo: '*'\n    selection2:\n        EventID: 5136\n        AttributeLDAPDisplayName: 'msDS-AllowedToDelegateTo'\n    selection3:\n        EventID: 5136\n        ObjectClass: 'user'\n        AttributeLDAPDisplayName: 'servicePrincipalName'\n    condition: selection1 or selection2 or selection3\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_ad_user_backdoors.yml", "title": "sigma: Active Directory User Backdoors", "author_keyword": "@neu5ron", "is_verified": true, "downloads": 0, "hash": "35d84b7920700ff915b6aab1992d5802da3a5782c8c81deec15eb228763c7d08", "level": "high"}, "uLMv42IB8Wx35J1-6Mxc": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:10.491829", "user_id": null, "views": 2, "permission_id": 3, "author": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "mitre_attack": null, "title_keyword": "sigma: Backup Catalog Deleted", "released": "2018-04-20T13:13:10.491826", "sigma_text": "title: Backup Catalog Deleted\nstatus: experimental\ndescription: Detects backup catalog deletions\nreferences:\n    - https://technet.microsoft.com/en-us/library/cc742154(v=ws.11).aspx\n    - https://www.hybrid-analysis.com/sample/ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa?environmentId=100\nauthor: Florian Roth (rule), Tom U. @c_APT_ure (collection) \nlogsource:\n    product: windows\n    service: application\ndetection:\n    selection:\n        EventID: 524\n        Source: Backup\n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_backup_delete.yml", "title": "sigma: Backup Catalog Deleted", "author_keyword": "Florian Roth (rule), Tom U. @c_APT_ure (collection)", "is_verified": false, "downloads": 0, "hash": "345eff251371a33aa628f19802dde7ec7ccad343b309ccda1baf5146f65a2509", "level": "medium"}, "_7Mw42IB8Wx35J1-ycwS": {"status": "", "category": 15, "updated": "2018-04-20T13:14:08.015587", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth, @twjackomo", "mitre_attack": null, "title_keyword": "sigma: Sticky Key Like Backdoor Usage", "released": "2018-04-20T13:14:08.015584", "sigma_text": "title: Sticky Key Like Backdoor Usage\ndescription: Detects the usage and installation of a backdoor that uses an option to register a malicious debugger for built-in tools that are accessible in the login screen. Modified by SOC Prime, replaced condition \"1 of them\" with \"selection_process or selection_registry\"\nreferences:\n    - https://blogs.technet.microsoft.com/jonathantrull/2016/10/03/detecting-sticky-key-backdoors/\nauthor: Florian Roth, @twjackomo\ndate: 2018/03/15\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection_process:\n        EventID: 1\n        ParentImage:\n            - '*\\winlogon.exe'\n        CommandLine:\n            - '*\\cmd.exe sethc.exe *'\n            - '*\\cmd.exe utilman.exe *'\n            - '*\\cmd.exe osk.exe *'\n            - '*\\cmd.exe Magnify.exe *'\n            - '*\\cmd.exe Narrator.exe *'\n            - '*\\cmd.exe DisplaySwitch.exe *'\n    selection_registry:\n        EventID: 13\n        TargetObject: \n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\sethc.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\utilman.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\osk.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Magnify.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\Narrator.exe\\Debugger'\n            - '*\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Image File Execution Options\\DisplaySwitch.exe\\Debugger'\n        EventType: 'SetValue'\n    condition: selection_process or selection_registry\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_stickykey_like_backdoor.yml", "title": "sigma: Sticky Key Like Backdoor Usage", "author_keyword": "Florian Roth, @twjackomo", "is_verified": true, "downloads": 1, "hash": "5773462e33883f11e5a8f5fc9bb468fcf14da5ecdb839f8ae86fbc52f1aa6f3e", "level": "critical"}, "L7Mx42IB8Wx35J1-Yc2t": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:47.083366", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: APT User Agent", "released": "2018-04-20T13:14:47.083362", "sigma_text": "title: APT User Agent\nstatus: experimental\ndescription: Detects suspicious user agent strings used in APT malware in proxy logs\nreferences:\n    - Internal Research\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n         # APT Related\n        - 'SJZJ (compatible; MSIE 6.0; Win32)'  # APT Backspace\n        - 'Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/20.0'  # APT GrizzlySteppe - ChopStick - US CERT https://goo.gl/1DTHwi\n        - 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC'  # Comment Crew Miniasp\n        - 'Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)'  # Comment Crew Miniasp\n        - 'webclient'  # Naikon APT\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/200'  # Naikon APT\n        - 'Mozilla/4.0 (compatible; MSI 6.0;'  # SnowGlobe Babar - yes, it is cut\n        - 'Mozilla/5.0 (Windows NT 6.3; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0'  # Sofacy - Xtunnel\n        - 'Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/'  # Sofacy - Xtunnel\n        - 'Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2'  # Sofacy - Xtunnel\n        - 'Mozilla/4.0'  # Derusbi backdoor ELF https://github.com/fideliscyber/indicators/tree/master/FTA-1021\n        - 'Netscape'  # Unit78020 Malware \n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7'  # Unit78020 Malware\n        - 'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.13) Firefox/3.6.13 GTB7.1'  # Winnti related\n        - 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)'  # Winnti related\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)'  # APT17\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)'  # Bronze Butler - Daserf\n        - 'Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)'  # Bronze Butler - Daserf\n        - 'Mozilla/4.0 (compatible; MSIE 8.0; Win32)'  # TSCookie https://app.any.run/tasks/0996b314-5133-491b-8d23-d431ffdec597\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Old browsers\nlevel: high\n", "git_filepath": "/proxy/proxy_ua_apt.yml", "title": "sigma: APT User Agent", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 1, "hash": "fd423e8ec3594a8125090ccb58983f4772c02977ba837d229ef63ea7bf698203", "level": "high"}, "_bMw42IB8Wx35J1-wszH": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:06.405464", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Command Line Execution with suspicious URL and AppData Strings", "released": "2018-04-20T13:14:06.405461", "sigma_text": "title: Command Line Execution with suspicious URL and AppData Strings\nstatus: experimental\ndescription: Detects a suspicious command line execution that includes an URL and AppData string in the command line parameters as used by several droppers (js/vbs > powershell)\nreferences:\n    - 'https://www.hybrid-analysis.com/sample/3a1f01206684410dbe8f1900bbeaaa543adfcd07368ba646b499fa5274b9edf6?environmentId=100'\n    - 'https://www.hybrid-analysis.com/sample/f16c729aad5c74f19784a24257236a8bbe27f7cdc4a89806031ec7f1bebbd475?environmentId=100'\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: \n            - 'cmd.exe /c *http://*%AppData%'\n            - 'cmd.exe /c *https://*%AppData%'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - High\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_cmd_http_appdata.yml", "title": "sigma: Command Line Execution with suspicious URL and AppData Strings", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "ee8980e63cc6f6e36a6c38ce73331635fb8f20cf6f436cf21155274a44d423f1", "level": "medium"}, "47Mw42IB8Wx35J1-cMwy": {"status": "experimental", "category": 14, "updated": "2018-04-20T13:13:45.265057", "user_id": null, "views": 16, "permission_id": 3, "author": "Sean Metcalf (source), Florian Roth (rule)", "mitre_attack": null, "title_keyword": "sigma: Malicious PowerShell Commandlets", "released": "2018-04-20T13:13:45.265054", "sigma_text": "title: Malicious PowerShell Commandlets\nstatus: experimental\ndescription: Detects Commandlet names from well-known PowerShell exploitation frameworks\nreferences:\n    - https://adsecurity.org/?p=2921\nauthor: Sean Metcalf (source), Florian Roth (rule)\nlogsource:\n    product: windows\n    service: powershell\n    description: 'It is recommanded to use the new \"Script Block Logging\" of PowerShell v5 https://adsecurity.org/?p=2277'\ndetection:\n    keywords:\n        - AdjustTokenPrivileges\n        - IMAGE_NT_OPTIONAL_HDR64_MAGIC\n        - Management.Automation.RuntimeException\n        - Microsoft.Win32.UnsafeNativeMethods\n        - ReadProcessMemory.Invoke\n        - Runtime.InteropServices\n        - SE_PRIVILEGE_ENABLED\n        - System.Security.Cryptography\n        - System.Runtime.InteropServices\n        - LSA_UNICODE_STRING\n        - MiniDumpWriteDump\n        - PAGE_EXECUTE_READ\n        - Net.Sockets.SocketFlags\n        - Reflection.Assembly\n        - SECURITY_DELEGATION\n        - TOKEN_ADJUST_PRIVILEGES\n        - TOKEN_ALL_ACCESS\n        - TOKEN_ASSIGN_PRIMARY\n        - TOKEN_DUPLICATE\n        - TOKEN_ELEVATION\n        - TOKEN_IMPERSONATE\n        - TOKEN_INFORMATION_CLASS\n        - TOKEN_PRIVILEGES\n        - TOKEN_QUERY\n        - Metasploit\n        - Mimikatz\n    condition: keywords\nfalsepositives:\n    - Penetration tests\nlevel: high\n", "git_filepath": "/windows/powershell/powershell_malicious_keywords.yml", "title": "sigma: Malicious PowerShell Commandlets", "author_keyword": "Sean Metcalf (source), Florian Roth (rule)", "is_verified": true, "downloads": 2, "hash": "95b54a96d8b4c99af62b815c8b271216ac4eac0a976257ddf5a0baca1cdfe9f7", "level": "high"}, "trMv42IB8Wx35J1-4cz4": {"status": "", "category": 11, "updated": "2018-04-20T13:13:08.854194", "user_id": null, "views": "3", "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "sigma: Disabling Windows Event Auditing", "released": "2018-04-20T13:13:08.854191", "sigma_text": "title: Disabling Windows Event Auditing\ndescription: >\n    Detects scenarios where system auditing (ie: windows event log auditing) is disabled. This may be used in a scenario\n    where an entity would want to bypass local logging to evade detection when windows event logging is enabled and\n    reviewed. Also, it is recommended to turn off \"Local Group Policy Object Processing\" via GPO, which will make sure\n    that Active Directory GPOs take precedence over local/edited computer policies via something such as \"gpedit.msc\".\n    Please note, that disabling \"Local Group Policy Object Processing\" may cause an issue in scenarios of one off\n    specific GPO modifications -- however it is recommended to perform these modifications in Active Directory anyways.\nreferences:\n    - https://bit.ly/WinLogsZero2Hero\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Computer Management > Audit Policy Configuration, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Policy Change\\Audit Audit Policy Change'\ndetection:\n    selection:\n        EventID: 4719\n        AuditPolicyChanges: 'removed'\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_disable_event_logging.yml", "title": "sigma: Disabling Windows Event Auditing", "author_keyword": "@neu5ron", "is_verified": true, "downloads": 0, "hash": "bc19a3cf25d0dc93df224fc6181cc11588ade05bd3cf6f1e126f220565598b95", "level": "high"}, "u7Mv42IB8Wx35J1-8cyi": {"status": "", "category": 11, "updated": "2018-04-20T13:13:12.864836", "user_id": null, "title": "sigma: Interactive Logon to Server Systems", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Interactive Logon to Server Systems", "released": "2018-04-20T13:13:12.864832", "sigma_text": "title: Interactive Logon to Server Systems\ndescription: Detects interactive console logons to \nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 528\n            - 529\n            - 4624\n            - 4625\n        LogonType: 2\n        ComputerName:\n            - '%ServerSystems%'\n            - '%DomainControllers%'\n    filter:\n        LogonProcessName: Advapi\n        ComputerName: '%Workstations%'\n    condition: selection and not filter\nfalsepositives:\n    - Administrative activity via KVM or ILO board\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_interactive_logons.yml", "hash": "4af7b0b9571ce0496c022fd2795fe56781a6de0966ca093ce11692929fd68d1c", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "medium"}, "0LMw42IB8Wx35J1-NMwT": {"status": "", "category": 11, "updated": "2018-04-20T13:13:29.873837", "user_id": null, "views": 7, "permission_id": 3, "author": "@neu5ron", "mitre_attack": null, "title_keyword": "sigma: Weak Encryption Enabled and Kerberoast", "released": "2018-04-20T13:13:29.873834", "sigma_text": "title: Weak Encryption Enabled and Kerberoast\ndescription: Detects scenario where weak encryption is enabled for a user profile which could be used for hash/password cracking.\nreferences:\n    - https://adsecurity.org/?p=2053\n    - https://www.harmj0y.net/blog/activedirectory/roasting-as-reps/\nauthor: '@neu5ron'\nlogsource:\n    product: windows\n    service: security\n    description: 'Requirements: Audit Policy : Account Management > Audit User Account Management, Group Policy : Computer Configuration\\Windows Settings\\Security Settings\\Advanced Audit Policy Configuration\\Audit Policies\\Account Management\\Audit User Account Management'\ndetection:\n    selection:\n        EventID: 4738\n    keywords:\n        - 'DES'\n        - 'Preauth'\n        - 'Encrypted'\n    filters:\n        - 'Enabled'\n    condition: selection and keywords and filters\nfalsepositives: \n    - Unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_alert_enable_weak_encryption.yml", "title": "sigma: Weak Encryption Enabled and Kerberoast", "author_keyword": "@neu5ron", "is_verified": true, "downloads": 1, "hash": "1521c23a2b8bba15fd02009bac26b77bbf4c67c9a70a121ac47536dcb911ba44", "level": "high"}, "mDwdG2YBatiiaHt9cyRL": {"status": "", "category": null, "updated": "2018-09-27T12:58:14.020651", "author_keyword": "Florian Roth", "user_id": null, "title": "ZxShell Malware", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "ZxShell Malware", "released": "2018-09-27T12:58:14.020647", "sigma_text": "title: ZxShell Malware\ndescription: Detects a ZxShell start by the called and well-known function name   \nauthor: Florian Roth\nreferences:\n    - https://www.hybrid-analysis.com/sample/5d2a4cde9fa7c2fdbf39b2e2ffd23378d0c50701a3095d1e91e3cf922d7b0b16?environmentId=100\ntags:\n    - attack.g0001\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Command: \n            - 'rundll32.exe *,zxFunction*'\n            - 'rundll32.exe *,RemoteDiskXXXXX'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unlikely\nlevel: critical\n", "git_filepath": "/apt/apt_zxshell.yml", "hash": "34f89e7e42a4815e8065b651433e0b52da976a3109c56a6dcc52a94002f361b9", "level": "critical", "is_verified": false, "downloads": 0}, "H7Mx42IB8Wx35J1-Ls0q": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:33.896742", "user_id": null, "views": 9, "permission_id": 3, "author": "Michael Haag", "mitre_attack": null, "title_keyword": "sigma: Bitsadmin Download", "released": "2018-04-20T13:14:33.896739", "sigma_text": "title: Bitsadmin Download\nstatus: experimental\ndescription: Detects usage of bitsadmin downloading a file\nreferences:\n    - https://blog.netspi.com/15-ways-to-download-a-file/#bitsadmin\n    - https://isc.sans.edu/diary/22264\nauthor: Michael Haag\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image:\n            - '*\\bitsadmin.exe'\n        CommandLine:\n            - '/transfer'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Some legitimate apps use this, but limited.\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_bitsadmin_download.yml", "title": "sigma: Bitsadmin Download", "author_keyword": "Michael Haag", "is_verified": true, "downloads": 0, "hash": "d3b749d329fa597cb410e0417291fcf8f97fb2f0fe9fe785417c1300090bfd24", "level": "medium"}, "CbMw42IB8Wx35J1-6M2F": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:16.067987", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Windows Shell Spawning Suspicious Program", "released": "2018-04-20T13:14:16.067984", "sigma_text": "title: Windows Shell Spawning Suspicious Program\nstatus: experimental\ndescription: Detects a suspicious child process of a Windows shell\nreferences:\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Florian Roth\ndate: 20018/04/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\mshta.exe'\n            - '*\\powershell.exe'\n            - '*\\cmd.exe'\n            - '*\\rundll32.exe'\n            - '*\\cscript.exe'\n            - '*\\wscript.exe'\n            - '*\\wmiprvse.exe'\n        Image:\n            - '*\\schtasks.exe'\n            - '*\\nslookup.exe'\n            - '*\\certutil.exe'\n            - '*\\bitsadmin.exe'\n            - '*\\mshta.exe'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative scripts\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_shell_spawn_susp_program.yml", "title": "sigma: Windows Shell Spawning Suspicious Program", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "e7805325b4bb82a2af6ca1b3c25ce9aba03d9007642deb2679d010ca31b601c2", "level": "medium"}, "8LMw42IB8Wx35J1-mMz5": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:55.704043", "user_id": null, "title": "sigma: Executables Started in Suspicious Folder", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Executables Started in Suspicious Folder", "released": "2018-04-20T13:13:55.704040", "sigma_text": "title: Executables Started in Suspicious Folder\nstatus: experimental\ndescription: Detects process starts of binaries from a suspicious folder\nauthor: Florian Roth\ndate: 2017/10/14\nreferences:\n   - https://github.com/mbevilacqua/appcompatprocessor/blob/master/AppCompatSearch.txt\n   - https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\nlogsource:\n   product: windows\n   service: sysmon\ndetection:\n   selection:\n      EventID: 1\n      Image:\n         - 'C:\\PerfLogs\\*'\n         - 'C:\\$Recycle.bin\\*'\n         - 'C:\\Intel\\Logs\\*'\n         - 'C:\\Users\\Default\\*'\n         - 'C:\\Users\\Public\\*'\n         - 'C:\\Users\\NetworkService\\*'\n         - 'C:\\Windows\\Fonts\\*'\n         - 'C:\\Windows\\Debug\\*'\n         - 'C:\\Windows\\Media\\*'\n         - 'C:\\Windows\\Help\\*'\n         - 'C:\\Windows\\addins\\*'\n         - 'C:\\Windows\\repair\\*'\n         - 'C:\\Windows\\security\\*'\n         - '*\\RSA\\MachineKeys\\*'\n         - 'C:\\Windows\\system32\\config\\systemprofile\\*'\n   condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_exec_folder.yml", "hash": "fbc6f5bb32bd99588686339bcd4c3aa3bf00b47429bd8565a68df41de149f6ea", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "level": "high"}, "iDwdG2YBatiiaHt9ZiRM": {"status": "", "category": null, "updated": "2018-09-27T12:58:10.693749", "author_keyword": "Florian Roth", "user_id": null, "title": "Suspicious SSHD Error", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Suspicious SSHD Error", "released": "2018-09-27T12:58:10.693747", "sigma_text": "title: Suspicious SSHD Error\ndescription: Detects suspicious SSH / SSHD error messages that indicate a fatal or suspicious error that could be caused by exploiting attempts \nreferences:\n    - https://github.com/openssh/openssh-portable/blob/master/ssherr.c\n    - https://github.com/ossec/ossec-hids/blob/master/etc/rules/sshd_rules.xml\nauthor: Florian Roth\ndate: 2017/06/30\nlogsource:\n    product: linux\n    service: sshd\ndetection:\n    keywords:\n        - '*unexpected internal error*'\n        - '*unknown or unsupported key type*'\n        - '*invalid certificate signing key*'\n        - '*invalid elliptic curve value*'\n        - '*incorrect signature*'\n        - '*error in libcrypto*'\n        - '*unexpected bytes remain after decoding*'\n        - '*fatal: buffer_get_string: bad string*'\n        - '*Local: crc32 compensation attack*'\n        - '*bad client public DH value*'\n        - '*Corrupted MAC on input*'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/linux/lnx_susp_ssh.yml", "hash": "5d7cbf03995553e77db9da9118dedb7a7d979b9905bb7b16e1ffab537150ecd1", "level": "medium", "is_verified": false, "downloads": 0}, "AbMw42IB8Wx35J1-z81M": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:09.610424", "user_id": null, "views": 6, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Malicious Named Pipe", "released": "2018-04-20T13:14:09.610420", "sigma_text": "title: Malicious Named Pipe\nstatus: experimental\ndescription: Detects the creation of a named pipe used by known APT malware\nreferences:\n    - Various sources\ndate: 2017/11/06\nauthor: Florian Roth\nlogsource:\n   product: windows\n   service: sysmon\n   description: 'Note that you have to configure logging for PipeEvents in Symson config'\ndetection:\n   selection:\n      EventID: \n         - 17\n         - 18\n      PipeName: \n         - '\\isapi_http'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg'  # Uroburos Malware Named Pipe\n         - '\\isapi_dg2'  # Uroburos Malware Named Pipe\n         - '\\sdlrpc'  # Cobra Trojan Named Pipe http://goo.gl/8rOZUX\n         - '\\ahexec'  # Sofacy group malware\n         - '\\winsession'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\lsassw'  # Wild Neutron APT malware https://goo.gl/pivRZJ\n         - '\\46a676ab7f179e511e30dd2dc41bd388'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\9f81f59bc58452127884ce513865ed20'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\e710f28d59aa529d6792ca6ff0ca1b34'  # Project Sauron https://goo.gl/eFoP4A\n         - '\\rpchlp_3'  # Project Sauron https://goo.gl/eFoP4A - Technical Analysis Input\n         - '\\NamePipe_MoreWindows'  # Cloud Hopper Annex B https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\n         - '\\pcheap_reuse'  # Pipe used by Equation Group malware 77486bb828dba77099785feda0ca1d4f33ad0d39b672190079c508b3feb21fb0\n         - '\\NamePipe_MoreWindows'  # US-CERT Alert - RedLeaves https://www.us-cert.gov/ncas/alerts/TA17-117A\n   condition: selection\nfalsepositives:\n   - Unkown\nlevel: critical\n", "git_filepath": "/windows/sysmon/sysmon_mal_namedpipes.yml", "title": "sigma: Malicious Named Pipe", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "71a019b6499e7d3178c17f36493b71b5799b9f608662ed23c3a902b24d8aaca7", "level": "critical"}, "LrMx42IB8Wx35J1-Xs2c": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:46.298625", "user_id": null, "views": 5, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Empty User Agent", "released": "2018-04-20T13:14:46.298623", "sigma_text": "title: Empty User Agent\nstatus: experimental\ndescription: Detects suspicious empty user agent strings in proxy logs\nreferences:\n    - https://twitter.com/Carlos_Perez/status/883455096645931008\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n      UserAgent:\n        # Empty string - as used by Powershell's (New-Object Net.WebClient).DownloadString \n        - ''\n    condition: selection\nfields:\n    - ClientIP\n    - URL\n    - UserAgent\nfalsepositives:\n    - Unknown\nlevel: medium\n", "git_filepath": "/proxy/proxy_empty_ua.yml", "title": "sigma: Empty User Agent", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "c3d5473a9395463306596a3c2a5049aeda2d45e5bdb5156ee33e6970714238d8", "level": "medium"}, "2rMw42IB8Wx35J1-U8yH": {"status": "experimental", "category": 13, "updated": "2018-04-20T13:13:37.925909", "user_id": null, "views": 5, "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "sigma: PsExec Tool Execution", "released": "2018-04-20T13:13:37.925906", "sigma_text": "title: PsExec Tool Execution\nstatus: experimental\ndescription: Detects PsExec service installation and execution events (service and Sysmon). Modified by SOC Prime, replaced condition \"1 of them\" with \"service_installation or service_execution or sysmon_processcreation\"\nauthor: Thomas Patzke\nreferences:\n    - https://www.jpcert.or.jp/english/pub/sr/ir_research.html\n    - https://jpcertcc.github.io/ToolAnalysisResultSheet\nlogsource:\n    product: windows\ndetection:\n    service_installation:\n        EventID: 7045\n        ServiceName: 'PSEXESVC'\n        ServiceFileName: '*\\PSEXESVC.exe'\n    service_execution:\n        EventID: 7036\n        ServiceName: 'PSEXESVC'\n    sysmon_processcreation:\n        EventID: 1\n        Image: '*\\PSEXESVC.exe'\n        User: 'NT AUTHORITY\\SYSTEM'\n    condition: service_installation or service_execution or sysmon_processcreation\nfields:\n    - EventID\n    - CommandLine\n    - ParentCommandLine\n    - ServiceName\n    - ServiceFileName\nfalsepositives:\n    - unknown\nlevel: low\n", "git_filepath": "/windows/other/win_tool_psexec.yml", "title": "sigma: PsExec Tool Execution", "author_keyword": "Thomas Patzke", "is_verified": true, "downloads": 0, "hash": "e302dbc05bc038dad751efd3d2c485fb613e0a07f5f89218ba9e08d22b36dd0e", "level": "low"}, "JrMx42IB8Wx35J1-RM0u": {"status": "experimental", "category": 5, "updated": "2018-04-20T13:14:39.532081", "user_id": null, "views": "3", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Download EXE from Suspicious TLD", "released": "2018-04-20T13:14:39.532078", "sigma_text": "title: Download EXE from Suspicious TLD\nstatus: experimental\ndescription: Detects executable downloads from suspicious remote systems\nauthor: Florian Roth\nlogsource:\n    category: proxy\ndetection:\n    selection:\n        c-uri-extension: \n            - 'exe'\n            - 'vbs'\n            - 'bat'\n            - 'rar'\n            - 'ps1'\n            - 'doc'\n            - 'docm'\n            - 'xls'\n            - 'xlsm'\n            - 'pptm'\n            - 'rtf'\n            - 'hta'\n            - 'dll'\n            - 'ws'\n            - 'wsf'\n            - 'sct'\n            - 'zip'\n            # If you want to add more extensions - see https://docs.google.com/spreadsheets/d/1TWS238xacAto-fLKh1n5uTsdijWdCEsGIM0Y0Hvmc5g/\n    filter:\n        r-dns: \n            - '*.com'\n            - '*.org'\n            - '*.net'\n            - '*.edu'\n            - '*.gov'\n            - '*.uk'\n            - '*.ca'\n            - '*.de'\n            - '*.jp'\n            - '*.fr'\n            - '*.au'\n            - '*.us'\n            - '*.ch'\n            - '*.it'\n            - '*.nl'\n            - '*.se'\n            - '*.no'\n            - '*.es'\n            # Extend this list as needed\n    condition: selection and not filter\nfields:\n    - ClientIP\n    - URL\nfalsepositives:\n    - All kind of software downloads\nlevel: low\n", "git_filepath": "/proxy/proxy_download_susp_tlds_whitelist.yml", "title": "sigma: Download EXE from Suspicious TLD", "author_keyword": "Florian Roth", "is_verified": false, "downloads": 0, "hash": "d47acbf1f4d2ffb60a3ccf8b5b45fcc2e9860176006e2a5b6d61d51faee9962f", "level": "low"}, "1LMw42IB8Wx35J1-QMzq": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:33.160754", "user_id": null, "views": "1", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Eventlog Cleared", "released": "2018-04-20T13:13:33.160751", "sigma_text": "title: Eventlog Cleared\nstatus: experimental\ndescription: Detects a cleared Windows Eventlog as e.g. caused by \"wevtutil cl\" command execution  \nauthor: Florian Roth\ndate: 2017/06/27\nreferences:\n    - https://www.hybrid-analysis.com/sample/027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745?environmentId=100\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 104\n        Source: Eventlog\n    condition: selection\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/builtin/win_eventlog_cleared.yml", "title": "sigma: Eventlog Cleared", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "b5152298d7d4ba41c81634470e6ff89927778cf329460abbac5fa00cc3893be9", "level": "high"}, "ojwdG2YBatiiaHt9eyQC": {"status": "", "category": null, "updated": "2018-09-27T12:58:15.996176", "author_keyword": "Florian Roth", "user_id": null, "title": "Equation Group Indicators", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Equation Group Indicators", "released": "2018-09-27T12:58:15.996173", "sigma_text": "title: Equation Group Indicators\ndescription: Detects suspicious shell commands used in various Equation Group scripts and tools\nreferences:\n    - https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\ntags:\n    - attack.execution\n    - attack.g0020\n    - attack.t1059\nauthor: Florian Roth\nlogsource:\n    product: linux\ndetection:\n    keywords:\n        # evolvingstrategy, elgingamble, estesfox\n        - 'chown root*chmod 4777 '\n        - 'cp /bin/sh .;chown'\n        # tmpwatch\n        - 'chmod 4777 /tmp/.scsi/dev/bin/gsh'\n        - 'chown root:root /tmp/.scsi/dev/bin/'\n        # estesfox\n        - 'chown root:root x;'\n        # ratload\n        - '/bin/telnet locip locport < /dev/console | /bin/sh'\n        - '/tmp/ratload'\n        # ewok\n        - 'ewok -t '\n        # xspy\n        - 'xspy -display '\n        # elatedmonkey\n        - 'cat > /dev/tcp/127.0.0.1/80 <<END'\n        # ftshell\n        - 'rm -f /current/tmp/ftshell.latest'\n        # ghost\n        - 'ghost_* -v '\n        # morerats client\n        - ' --wipe > /dev/null'\n        # noclient\n        - 'ping -c 2 *; grep * /proc/net/arp >/tmp/gx'\n        - 'iptables * OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;'\n        # auditcleaner\n        - '> /var/log/audit/audit.log; rm -f .'\n        - 'cp /var/log/audit/audit.log .tmp'\n        # reverse shell\n        - 'sh >/dev/tcp/* <&1 2>&1'\n        # packrat\n        - 'ncat -vv -l -p * <'\n        - 'nc -vv -l -p * <'\n        # empty bowl\n        - '< /dev/console | uudecode && uncompress'\n        - 'sendmail -osendmail;chmod +x sendmail'\n        # echowrecker\n        - '/usr/bin/wget -O /tmp/a http* && chmod 755 /tmp/cron'\n        # dubmoat\n        - 'chmod 666 /var/run/utmp~'\n        # poptop\n        - 'chmod 700 nscd crond'\n        # abopscript\n        - 'cp /etc/shadow /tmp/.'\n        # ys\n        - '</dev/console |uudecode > /dev/null 2>&1 && uncompress'\n        # jacktelnet\n        - 'chmod 700 jp&&netstat -an|grep'\n        # others\n        - 'uudecode > /dev/null 2>&1 && uncompress -f * && chmod 755'\n        - 'chmod 700 crond'\n        - 'wget http*; chmod +x /tmp/sendmail'\n        - 'chmod 700 fp sendmail pt'\n        - 'chmod 755 /usr/vmsys/bin/pipe'\n        - 'chmod -R 755 /usr/vmsys'\n        - 'chmod 755 $opbin/*tunnel'\n        - '< /dev/console | uudecode && uncompress'\n        - 'chmod 700 sendmail'\n        - 'chmod 0700 sendmail'\n        - '/usr/bin/wget http*sendmail;chmod +x sendmail;'\n        - '&& telnet * 2>&1 </dev/console'\n    condition: keywords\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_equationgroup_lnx.yml", "hash": "7b582832e51a5c50fb8f4fa1a7acdd14964bcefc436e453db61ec401afd604d3", "level": "high", "is_verified": false, "downloads": 0}, "lTwdG2YBatiiaHt9cCTC": {"status": "", "category": null, "updated": "2018-09-27T12:58:13.372436", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Spring framework exceptions", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Spring framework exceptions", "released": "2018-09-27T12:58:13.372433", "sigma_text": "title: Spring framework exceptions\ndescription: Detects suspicious Spring framework exceptions that could indicate exploitation attempts\nauthor: Thomas Patzke\nreferences:\n    - https://docs.spring.io/spring-security/site/docs/current/apidocs/overview-tree.html\nlogsource:\n    category: application\n    product: spring\ndetection:\n    keywords:\n        - AccessDeniedException\n        - CsrfException\n        - InvalidCsrfTokenException\n        - MissingCsrfTokenException\n        - CookieTheftException\n        - InvalidCookieException\n        - RequestRejectedException\n    condition: keywords\nfalsepositives:\n    - Application bugs\n    - Penetration testing\nlevel: medium\n", "git_filepath": "/application/appframework_spring_exceptions.yml", "hash": "19d5740e125674961f46163228bfc8c942ea9e6280f3975adc8459c7406284ce", "level": "medium", "is_verified": false, "downloads": 0}, "nTwdG2YBatiiaHt9dyQ6": {"status": "", "category": null, "updated": "2018-09-27T12:58:15.027377", "author_keyword": "Florian Roth", "user_id": null, "title": "Equation Group C2 Communication", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Equation Group C2 Communication", "released": "2018-09-27T12:58:15.027376", "sigma_text": "title: Equation Group C2 Communication\ndescription: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools\nreferences:\n    - 'https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation'\n    - 'https://medium.com/@msuiche/the-nsa-compromised-swift-network-50ec3000b195'\ntags:\n    - attack.command_and_control\n    - attack.g0020\nauthor: Florian Roth\nlogsource:\n    category: firewall\ndetection:\n    outgoing:\n        dst_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    incoming:\n        src_ip:\n            - '69.42.98.86'\n            - '89.185.234.145'\n    condition: 1 of them\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_equationgroup_c2.yml", "hash": "5861e2f5877bd8e408d8de3eb709c06539cf63753a238a9447cea6896211437d", "level": "high", "is_verified": false, "downloads": 0}, "mTwdG2YBatiiaHt9dCQO": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:14.215897", "author_keyword": "Florian Roth", "user_id": null, "title": "Fireball Archer Install", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Fireball Archer Install", "released": "2018-09-27T12:58:14.215895", "sigma_text": "title: Fireball Archer Install\nstatus: experimental\ndescription: Detects Archer malware invocation via rundll32\nauthor: Florian Roth\ndate: 2017/06/03\nreferences:\n    - https://www.virustotal.com/en/file/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022/analysis/\n    - https://www.hybrid-analysis.com/sample/9b4971349ae85aa09c0a69852ed3e626c954954a3927b3d1b6646f139b930022?environmentId=100\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine: '*\\rundll32.exe *,InstallArcherSvc'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/crime_fireball.yml", "hash": "ae054c30ecf260e694d9ac1c20884b19f6b5e89192bbd323476ecd0472ce3cff", "level": "high", "is_verified": false, "downloads": 0}, "8bMw42IB8Wx35J1-nMwg": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:56.509826", "user_id": null, "views": 5, "permission_id": 3, "author": "jmallette", "mitre_attack": null, "title_keyword": "sigma: cmdkey Cached Credentials Recon", "released": "2018-04-20T13:13:56.509823", "sigma_text": "title: cmdkey Cached Credentials Recon\nstatus: experimental\ndescription: Detects usage of cmdkey to look for cached credentials.\nreference: \n    - https://www.peew.pw/blog/2017/11/26/exploring-cmdkey-an-edge-case-for-privilege-escalation\n    - https://technet.microsoft.com/en-us/library/cc754243(v=ws.11).aspx\nauthor: jmallette\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        Image: '*\\cmdkey.exe'\n        CommandLine: '* /list *'\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\n    - User\nfalsepositives:\n    - Legitimate administrative tasks.\nlevel: low\n", "git_filepath": "/windows/sysmon/sysmon_cmdkey_recon.yml", "title": "sigma: cmdkey Cached Credentials Recon", "author_keyword": "jmallette", "is_verified": true, "downloads": 2, "hash": "ba749aa34be28c58d8cf7484ce2ae9b674b467c08fefbde533a868129c14d5fb", "level": "low"}, "97Mw42IB8Wx35J1-r8wA": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:01.342231", "user_id": null, "views": 4, "permission_id": 3, "author": "Florian Roth, Michael Haag", "mitre_attack": null, "title_keyword": "sigma: Activity Related to NTDS.dit Domain Hash Retrieval", "released": "2018-04-20T13:14:01.342228", "sigma_text": "title: Activity Related to NTDS.dit Domain Hash Retrieval\nstatus: experimental\ndescription: Detects suspicious commands that could be related to activity that uses volume shadow copy to steal and retrieve hashes from the NTDS.dit file remotely \nauthor: Florian Roth, Michael Haag\nreferences:\n    - https://www.swordshield.com/2015/07/getting-hashes-from-ntds-dit-file/\n    - https://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/\n    - https://www.trustwave.com/Resources/SpiderLabs-Blog/Tutorial-for-NTDS-goodness-(VSSADMIN,-WMIS,-NTDS-dit,-SYSTEM)/\n    - https://securingtomorrow.mcafee.com/mcafee-labs/new-teslacrypt-ransomware-arrives-via-spam/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        CommandLine:\n            # Ransomware\n            - 'vssadmin.exe Delete Shadows'\n            # Hacking \n            - 'vssadmin create shadow /for=C:'\n            - 'copy \\\\?\\GLOBALROOT\\Device\\*\\windows\\ntds\\ntds.dit'\n            - 'copy \\\\?\\GLOBALROOT\\Device\\*\\config\\SAM'\n            - 'vssadmin delete shadows /for=C:'\n            - 'reg SAVE HKLM\\SYSTEM '\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - Administrative activity\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_susp_vssadmin_ntds_activity.yml", "title": "sigma: Activity Related to NTDS.dit Domain Hash Retrieval", "author_keyword": "Florian Roth, Michael Haag", "is_verified": false, "downloads": 1, "hash": "99ac824cf1d9c99a22a445666bd5591eefe1d9c98d4eab5a2fa058bf57ad6bed", "level": "high"}, "jjwdG2YBatiiaHt9ayRP": {"status": "", "category": null, "updated": "2018-09-27T12:58:11.976877", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Network Scans", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Network Scans", "released": "2018-09-27T12:58:11.976874", "sigma_text": "title: Network Scans\ndescription: Detects many failed connection attempts to different ports or hosts\nauthor: Thomas Patzke\nlogsource:\n    category: firewall\ndetection:\n    selection:\n        action: denied\n    timeframe: 24h\n    condition:\n        - selection | count(dst_port) by src_ip > 10\n        - selection | count(dst_ip) by src_ip > 10\nfields:\n    - src_ip\n    - dst_ip\n    - dst_port\nfalsepositives:\n    - Inventarization systems\n    - Vulnerability scans\n    - Penetration testing activity\nlevel: medium\n", "git_filepath": "/network/net_susp_network_scan.yml", "hash": "d9d3030101ea563fdd3f15539adc431765fd43c5e0a92dc6ab2aea98e89f67b7", "level": "medium", "is_verified": false, "downloads": 0}, "gjxcSWMB_9rlszZ26s-K": {"status": "testing", "category": "", "updated": "2018-05-10T09:23:36Z", "user_id": "80", "views": 40, "downloads": 4, "author": "Alexandr Yampolskyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Locky Ransomware C2/Download/Payment Communication.", "released": "2018-05-10T09:23:36Z", "sigma_text": "title: Locky Ransomware C2/Download/Payment Communication.\ndescription: Locky Ransomware C2/Download/Payment Communication Detection.\nauthor: Alexandr Yampolskyi, SOC Prime\nreferences: https://malwarebreakdown.com/tag/locky/\ndate: 2017/01/14\nstatus: testing\nlogsource:\n  product: firewall\ndetection:\n  outgoing:\n    dst:\n    - 115.29.247.219\n    - 211.149.241.201\n    - 176.114.0.20\n    - 162.144.211.154\n    - 202.133.118.222\n    - 194.28.49.140\n    - 216.110.144.152\n    - 209.126.99.6\n    - 193.201.225.124\n    - 176.121.14.95\n    - 138.128.171.35\n    - 178.62.242.179\n    - 92.53.120.233\n    - 200.7.102.105\n    - 188.127.239.53\n    - 62.75.162.77\n    - 218.232.104.232\n    - 210.196.232.211\n    - 104.27.149.238\n    - 37.59.51.53\n    - 211.40.221.90\n    - 207.45.186.214\n    - 122.114.99.100\n    - 97.74.215.147\n    - 212.85.104.64\n    - 89.149.4.195\n    - 123.30.181.207\n    - 37.187.143.115\n    - 212.23.79.123\n    - 195.228.152.23\n    - 188.94.74.76\n    - 172.246.156.150\n    - 180.71.58.101\n    - 119.29.99.214\n    - 208.56.45.17\n    - 203.98.84.123\n    - 211.149.250.179\n    - 120.39.243.225\n    - 202.125.36.106\n    - 85.13.128.34\n    - 107.180.51.106\n    - 103.63.26.159\n    - 119.29.9.237\n    - 216.249.101.162\n    - 31.202.128.199\n    - 162.144.116.161\n    - 222.124.206.41\n    - 199.101.51.76\n    - 107.180.1.210\n    - 116.255.193.108\n    - 91.142.90.46\n    - 95.211.144.65\n    - 185.87.184.130\n    - 120.25.161.125\n    - 94.231.77.230\n    - 185.25.149.13\n    - 139.224.165.195\n    - 69.195.129.70\n    - 93.185.104.25\n    - 37.153.89.141\n    - 108.163.209.27\n    - 194.1.239.152\n    - 51.255.107.20\n    - 194.28.87.26\n    - 185.17.41.83\n    - 176.103.56.119\n    - 109.234.35.230\n    - 192.186.241.104\n    - 108.168.206.100\n    - 208.100.26.234\n  incoming:\n    src:\n    - 115.29.247.219\n    - 211.149.241.201\n    - 176.114.0.20\n    - 162.144.211.154\n    - 202.133.118.222\n    - 194.28.49.140\n    - 216.110.144.152\n    - 209.126.99.6\n    - 193.201.225.124\n    - 176.121.14.95\n    - 138.128.171.35\n    - 178.62.242.179\n    - 92.53.120.233\n    - 200.7.102.105\n    - 188.127.239.53\n    - 62.75.162.77\n    - 218.232.104.232\n    - 210.196.232.211\n    - 104.27.149.238\n    - 37.59.51.53\n    - 211.40.221.90\n    - 207.45.186.214\n    - 122.114.99.100\n    - 97.74.215.147\n    - 212.85.104.64\n    - 89.149.4.195\n    - 123.30.181.207\n    - 37.187.143.115\n    - 212.23.79.123\n    - 195.228.152.23\n    - 188.94.74.76\n    - 172.246.156.150\n    - 180.71.58.101\n    - 119.29.99.214\n    - 208.56.45.17\n    - 203.98.84.123\n    - 211.149.250.179\n    - 120.39.243.225\n    - 202.125.36.106\n    - 85.13.128.34\n    - 107.180.51.106\n    - 103.63.26.159\n    - 119.29.9.237\n    - 216.249.101.162\n    - 31.202.128.199\n    - 162.144.116.161\n    - 222.124.206.41\n    - 199.101.51.76\n    - 107.180.1.210\n    - 116.255.193.108\n    - 91.142.90.46\n    - 95.211.144.65\n    - 185.87.184.130\n    - 120.25.161.125\n    - 94.231.77.230\n    - 185.25.149.13\n    - 139.224.165.195\n    - 69.195.129.70\n    - 93.185.104.25\n    - 37.153.89.141\n    - 108.163.209.27\n    - 194.1.239.152\n    - 51.255.107.20\n    - 194.28.87.26\n    - 185.17.41.83\n    - 176.103.56.119\n    - 109.234.35.230\n    - 192.186.241.104\n    - 108.168.206.100\n    - 208.100.26.234\n  condition: outgoing or incoming\nfalsepositives:\n- Unknown\nlevel: medium\nmitre-attack:\n  Command and Control:\n  - Commonly Used Port\n  - Standard Application Layer Protocol", "title": "sigma: Locky Ransomware C2/Download/Payment Communication.", "author_keyword": "Alexandr Yampolskyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "f144450780c341f7eb32f59dd4438558bdfcdcc4e123bb46a920bdd7894c3900", "level": "medium"}, "-rMw42IB8Wx35J1-ucxE": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:03.970237", "user_id": null, "views": 9, "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Suspicious Typical Malware Back Connect Ports", "released": "2018-04-20T13:14:03.970234", "sigma_text": "title: Suspicious Typical Malware Back Connect Ports\nstatus: experimental\ndescription: Detects programs that connect to typical malware back connetc ports based on statistical analysis from two different sandbox system databases\nreferences:\n    - https://docs.google.com/spreadsheets/d/17pSTDNpa0sf6pHeRhusvWG6rThciE8CsXTSlDUAZDyo\nauthor: Florian Roth\ndate: 2017/03/19\nlogsource:\n    product: windows\n    service: sysmon\n    description: 'Use the following config to generate the necessary Event ID 10 Process Access events: <ProcessAccess onmatch=\"include\"><CallTrace condition=\"contains\">VBE7.DLL</CallTrace></ProcessAccess><ProcessAccess onmatch=\"exclude\"><CallTrace condition=\"excludes\">UNKNOWN</CallTrace></ProcessAccess>'\ndetection:\n    selection:\n        EventID: 3\n        DestinationPort:\n            - '4443'\n            - '2448'\n            - '8143'\n            - '1777'\n            - '1443'\n            - '243'\n            - '65535'\n            - '13506'\n            - '3360'\n            - '200'\n            - '198'\n            - '49180'\n            - '13507'\n            - '6625'\n            - '4444'\n            - '4438'\n            - '1904'\n            - '13505'\n            - '13504'\n            - '12102'\n            - '9631'\n            - '5445'\n            - '2443'\n            - '777'\n            - '13394'\n            - '13145'\n            - '12103'\n            - '5552'\n            - '3939'\n            - '3675'\n            - '666'\n            - '473'\n            - '5649'\n            - '4455'\n            - '4433'\n            - '1817'\n            - '100'\n            - '65520'\n            - '1960'\n            - '1515'\n            - '743'\n            - '700'\n            - '14154'\n            - '14103'\n            - '14102'\n            - '12322'\n            - '10101'\n            - '7210'\n            - '4040'\n            - '9943'\n    filter:\n        Image: '*\\Program Files*'\n    condition: selection and not filter\nfalsepositives:\n    - unknown\nlevel: medium", "git_filepath": "/windows/sysmon/sysmon_malware_backconnect_ports.yml", "title": "sigma: Suspicious Typical Malware Back Connect Ports", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 0, "hash": "3b265c77120034dd5f1788abed8594f13472e79b2ab3a9e628e99f01a88808f5", "level": "medium"}, "qzwdG2YBatiiaHt9gyRQ": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:18.122679", "author_keyword": "Florian Roth", "user_id": null, "title": "NTLM Logon", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "NTLM Logon", "released": "2018-09-27T12:58:18.122676", "sigma_text": "title: NTLM Logon\nstatus: experimental\ndescription: Detects logons using NTLM, which could be caused by a legacy source or attackers\nreferences:\n    - https://twitter.com/JohnLaTwC/status/1004895028995477505\n    - https://goo.gl/PsqrhT\nauthor: Florian Roth\ndate: 2018/06/08\ntags:\n    - attack.credential_access\n    - attack.t1208\nlogsource:\n    product: windows\n    service: ntlm\n    description: Reqiures events from Microsoft-Windows-NTLM/Operational\ndetection:\n    selection:\n        EventID: 8002\n        CallingProcessName: '*'  # We use this to avoid false positives with ID 8002 on other log sources if the logsource isn't set correctly\n    condition: selection\nfalsepositives:\n    - Legacy hosts\nlevel: low\n", "git_filepath": "/windows/builtin/win_susp_ntlm_auth.yml", "hash": "4488c6b212a849c92c0d6d1b45261664174988eed752248f14f2dc744b08ea16", "level": "low", "is_verified": false, "downloads": 0}, "07Mw42IB8Wx35J1-Pcx0": {"status": "experimental", "category": 11, "updated": "2018-04-20T13:13:32.275075", "user_id": null, "title": "sigma: DHCP Server Error Failed Loading the CallOut DLL", "permission_id": 3, "author": "Dimitrios Slamaris", "mitre_attack": null, "title_keyword": "sigma: DHCP Server Error Failed Loading the CallOut DLL", "released": "2018-04-20T13:13:32.275072", "sigma_text": "title: DHCP Server Error Failed Loading the CallOut DLL\ndescription: This rule detects a DHCP server error in which a specified Callout DLL (in registry) could not be loaded\nstatus: experimental\nreferences:\n    - https://blog.3or.de/mimilib-dhcp-server-callout-dll-injection.html\n    - https://technet.microsoft.com/en-us/library/cc726884(v=ws.10).aspx\n    - https://msdn.microsoft.com/de-de/library/windows/desktop/aa363389(v=vs.85).aspx\ndate: 2017/05/15\nauthor: Dimitrios Slamaris\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n          EventID: \n            - 1031\n            - 1032\n            - 1034\n    condition: selection\nfalsepositives: \n    - Unknown\nlevel: critical\n", "git_filepath": "/windows/builtin/win_susp_dhcp_config_failed.yml", "hash": "e863caf7e4c42735a9adebc45ba119079ac6bd6399ec9498bb5d6931c537ab6c", "author_keyword": "Dimitrios Slamaris", "is_verified": false, "downloads": 0, "level": "critical"}, "57Mw42IB8Wx35J1-fMzc": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:13:48.507091", "user_id": null, "views": "1", "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Processes created by MMC", "released": "2018-04-20T13:13:48.507088", "sigma_text": "title: Processes created by MMC \nstatus: experimental\ndescription: Processes started by MMC could by a sign of lateral movement using MMC application COM object \nreferences:\n    - https://enigma0x3.net/2017/01/05/lateral-movement-using-the-mmc20-application-com-object/\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage: '*\\mmc.exe'\n        Image: '*\\cmd.exe'\n    exclusion:\n        CommandLine: '*\\RunCmd.cmd'\n    condition: selection and not exclusion\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: medium\n", "git_filepath": "/windows/sysmon/sysmon_susp_mmc_source.yml", "title": "sigma: Processes created by MMC", "author_keyword": null, "is_verified": true, "downloads": 0, "hash": "6ca0b3ab8f183b206504e9f7cb98cc0019d964247dcf30a8d49ce0dab9cd665a", "level": "medium"}, "VAJmkWMBqfpvXJhTFQwo": {"status": "testing", "category": "", "updated": "2018-06-04T09:08:26Z", "user_id": "3518", "views": 81, "downloads": 9, "author": "Rostyslav Hembus, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: VPNFilter Destructive Malware detection (IP)", "released": "2018-05-24T09:06:16Z", "sigma_text": "title: VPNFilter Destructive Malware detection (IP)\ndescription: This rule detects VPNFilter Destructive Malware  activity (IP)\nauthor: Rostyslav Hembus, SOC Prime\nstatus: testing\nlogsource:\n  product: firewall\ndetection:\n  outgoing:\n    dst:\n    - 91.121.109.209\n    - 217.12.202.40\n    - 94.242.222.68\n    - 82.118.242.124\n    - 46.151.209.33\n    - 217.79.179.14\n    - 91.214.203.144\n    - 95.211.198.231\n    - 195.154.180.60\n    - 5.149.250.54\n    - 91.200.13.76\n    - 94.185.80.82\n    - 62.210.180.229\n    - 91.200.13.76\n    - 23.111.177.114\n    - 138.186.2.250\n    - 250.2.186.138\n    - 178.78.13.69\n    - 178.78.6.224\n    - 187.85.58.107\n    - 192.157.214.6\n    - 77.45.243.188\n    - 88.213.189.253\n    - 9.110.0.5\n  incoming:\n    src:\n    - 91.121.109.209\n    - 217.12.202.40\n    - 94.242.222.68\n    - 82.118.242.124\n    - 46.151.209.33\n    - 217.79.179.14\n    - 91.214.203.144\n    - 95.211.198.231\n    - 195.154.180.60\n    - 5.149.250.54\n    - 91.200.13.76\n    - 94.185.80.82\n    - 62.210.180.229\n    - 91.200.13.76\n    - 23.111.177.114\n    - 138.186.2.250\n    - 250.2.186.138\n    - 178.78.13.69\n    - 178.78.6.224\n    - 187.85.58.107\n    - 192.157.214.6\n    - 77.45.243.188\n    - 88.213.189.253\n    - 9.110.0.5\n  condition: outgoing or incoming\nfields:\n- DestinationIp\n- UserAgent\n- SourceIp\nfalsepositives:\n- Unknown\nlevel: critical\ndate: 2018/05/24\nreference:\n- https://ssu.gov.ua/ua/news/1/category/2/view/4823#.fceLIKev.dpbs\n- https://blog.talosintelligence.com/2018/05/VPNFilter.html\n- https://www.reuters.com/article/us-cyber-routers-ukraine/cyber-firms-ukraine-warn-of-planned-russian-attack-idUSKCN1IO1U9\n- https://blogs.cisco.com/security/talos/vpnfilter\n- https://jask.com/from-russia-with-love/\nmitre-attack:\n  Command and Control:\n  - Remote File Copy\n  - Standard Application Layer Protocol\n  - Web Service", "title": "sigma: VPNFilter Destructive Malware detection (IP)", "author_keyword": "Rostyslav Hembus, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "4fd8020a8bc1162c0d9ae69218063ce2c998deadd937a1a34ca7df7320d6a86f", "level": "critical"}, "fjwdG2YBatiiaHt9XiQ2": {"status": "experimental", "category": null, "updated": "2018-09-27T12:58:08.623103", "author_keyword": "Florian Roth", "user_id": null, "title": "Detects Suspicious Commands on Linux systems", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "Detects Suspicious Commands on Linux systems", "released": "2018-09-27T12:58:08.623101", "sigma_text": "title: Detects Suspicious Commands on Linux systems\nstatus: experimental\ndescription: Detects relevant commands often related to malware or hacking activity\nreferences:\n    - 'Internal Research - mostly derived from exploit code including code in MSF'\ndate: 2017/12/12\nauthor: Florian Roth\nlogsource:\n    product: linux\n    service: auditd\ndetection:\n    cmds:\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: '777'\n        - type: 'EXECVE'\n          a0: 'chmod'\n          a1: 'u+s'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/ksh'\n        - type: 'EXECVE'\n          a0: 'cp'\n          a1: '/bin/sh'\n    condition: 1 of cmds\nfalsepositives:\n    - Admin activity\nlevel: medium", "git_filepath": "/linux/auditd/lnx_auditd_susp_cmds.yml", "hash": "49a979f8fb5a88e134325306b4f619db31c33eeb987815b3372e55fc71b18d1b", "level": "medium", "is_verified": false, "downloads": 0}, "fTxCKmMB_9rlszZ20s_X": {"status": "testing", "category": "", "updated": "2018-05-04T08:44:47Z", "user_id": "80", "views": 43, "downloads": 0, "author": "Alexandr Yamposlkyi, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: List RDP Connections History Unload", "released": "2018-05-04T08:26:52Z", "sigma_text": "title: List RDP Connections History Unload\ndescription: Detects RDP Connections History Unloading.\nreferences:\n- https://github.com/3gstudent/List-RDP-Connections-History\nauthor: Alexandr Yamposlkyi, SOC Prime\nstatus: testing\nlogsource:\n  product: windows\n  service: sysmon\ndetection:\n  selection:\n    EventID: \"1\"\n    CommandLine:\n    - reg.exe*NTUSER.DAT\n  condition: selection\nfields:\n- CommandLine\n- ParentCommandLine\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Discovery:\n  - Account Discovery\n  - Remote System Discovery", "title": "sigma: List RDP Connections History Unload", "author_keyword": "Alexandr Yamposlkyi, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "9ce81e8eab2c7983fff2beb4cbb0d162b878fd62a55a52e882d3dd279064da29", "level": "high"}, "PLMx42IB8Wx35J1-is0-": {"status": "", "category": 2, "updated": "2018-04-20T13:14:57.468552", "user_id": null, "views": 19, "permission_id": 3, "author": null, "mitre_attack": null, "title_keyword": "sigma: Turla Service Install", "released": "2018-04-20T13:14:57.468548", "sigma_text": "title: Turla Service Install\ndescription: 'This method detects a service install of malicious services mentioned in Carbon Paper - Turla report by ESET' \nreferences:\n    - https://www.welivesecurity.com/2017/03/30/carbon-paper-peering-turlas-second-stage-backdoor/\nlogsource:\n    product: windows\n    service: system\ndetection:\n    selection:\n        EventID: 7045\n        ServiceName:\n            - 'srservice'\n            - 'ipvpn'\n            - 'hkmsvc' \n    condition: selection\nfalsepositives:\n    - Unknown\nlevel: high\n", "git_filepath": "/apt/apt_carbonpaper_turla.yml", "title": "sigma: Turla Service Install", "author_keyword": null, "is_verified": true, "downloads": 2, "hash": "f99a40b5eb6cef7586c583894de4898e82b30722c8911bdb28488e03ad9266d8", "level": "high"}, "tbMv42IB8Wx35J1-3szm": {"status": "", "category": 11, "updated": "2018-04-20T13:13:08.068584", "user_id": null, "views": "5", "permission_id": 3, "author": "Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Account Tampering - Suspicious Failed Logon Reasons", "released": "2018-04-20T13:13:08.068581", "sigma_text": "title: Account Tampering - Suspicious Failed Logon Reasons\ndescription: This method uses uncommon error codes on failed logons to determine suspicious activity and tampering with accounts that have been disabled or somehow restricted.\nauthor: Florian Roth\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4625\n            - 4776\n        Status:\n            - 0xC0000072\n            - 0xC000006F\n            - 0xC0000070\n            - 0xC0000413\n            - 0xC000018C\n    condition: selection\nfalsepositives:\n    - User using a disabled account\nlevel: high\n", "git_filepath": "/windows/builtin/win_susp_failed_logon_reasons.yml", "title": "sigma: Account Tampering - Suspicious Failed Logon Reasons", "author_keyword": "Florian Roth", "is_verified": true, "downloads": 1, "hash": "71f3a470f90c06514c93a23b72e30ca33289abf18bc398487e5290060acd8197", "level": "high"}, "qDwdG2YBatiiaHt9gCQP": {"status": "stable", "category": null, "updated": "2018-09-27T12:58:17.288557", "author_keyword": "Thomas Patzke", "user_id": null, "title": "Addition of SID History to Active Directory Object", "permission_id": 3, "author": "Thomas Patzke", "mitre_attack": null, "title_keyword": "Addition of SID History to Active Directory Object", "released": "2018-09-27T12:58:17.288554", "sigma_text": "title: Addition of SID History to Active Directory Object\nstatus: stable\ndescription: An attacker can use the SID history attribute to gain additional privileges.\nreferences:\n    - https://adsecurity.org/?p=1772\nauthor: Thomas Patzke\ntags:\n    - attack.privilege_escalation\n    - attack.t1178\nlogsource:\n    product: windows\n    service: security\ndetection:\n    selection:\n        EventID:\n            - 4765\n            - 4766\n    condition: selection\nfalsepositives:\n    - Migration of an account into a new domain\nlevel: medium\n", "git_filepath": "/windows/builtin/win_susp_add_sid_history.yml", "hash": "62412daaea088252c6809e79ad28484737eb0952daaef908138591cddb0ec2d4", "level": "medium", "is_verified": false, "downloads": 0}, "ezxIJWMB_9rlszZ2a89z": {"status": "testing", "category": "", "updated": "2018-05-10T14:22:35Z", "user_id": "3518", "views": 60, "downloads": 7, "author": "Eugene Nechiporenko, SOC Prime", "mitre_attack": "", "title_keyword": "sigma: Suspicious PowerShell ZIPing activity", "released": "2018-05-03T09:14:53Z", "sigma_text": "title: Suspicious PowerShell ZIPing activity\ndescription: Detects PowerShell commands used for creation/updating ZIP archives\nreference:\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/compress-archive?view=powershell-6\n- https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.archive/expand-archive?view=powershell-6\nauthor: Eugene Nechiporenko, SOC Prime\ndate: 2018/05/03\nstatus: testing\nlogsource:\n  product: windows\n  service: powershell\ndetection:\n  keyword1:\n  - Compress-Archive\n  keyword2:\n  - Expand-Archive\n  keyword3:\n  - Microsoft.PowerShell.Archive\n  condition: keyword1 or keyword2 or keyword3\nfalsepositives:\n- Unknown\nlevel: high\nmitre-attack:\n  Collection:\n  - Data Staged\n  Exfiltration:\n  - Data Compressed", "title": "sigma: Suspicious PowerShell ZIPing activity", "author_keyword": "Eugene Nechiporenko, SOC Prime", "is_verified": true, "permission_id": "3", "hash": "59a48e3af006962c6f65e2b10cfa013b822a953e403a18268c5388a839428040", "level": "high"}, "E7Mx42IB8Wx35J1-CM1o": {"status": "experimental", "category": 15, "updated": "2018-04-20T13:14:24.231106", "user_id": null, "views": 4, "permission_id": 3, "author": "Michael Haag, Florian Roth", "mitre_attack": null, "title_keyword": "sigma: Microsoft Office Product Spawning Windows Shell", "released": "2018-04-20T13:14:24.231103", "sigma_text": "title: Microsoft Office Product Spawning Windows Shell\nstatus: experimental\ndescription: Detects a Windows command line executable started from Microsoft Word, Excel, Powerpoint, Publisher and Visio.\nreferences:\n    - https://www.hybrid-analysis.com/sample/465aabe132ccb949e75b8ab9c5bda36d80cf2fd503d52b8bad54e295f28bbc21?environmentId=100\n    - https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\nauthor: Michael Haag, Florian Roth\ndate: 2018/04/06\nlogsource:\n    product: windows\n    service: sysmon\ndetection:\n    selection:\n        EventID: 1\n        ParentImage:\n            - '*\\WINWORD.EXE'\n            - '*\\EXCEL.EXE'\n            - '*\\POWERPNT.exe'\n            - '*\\MSPUB.exe'\n            - '*\\VISIO.exe'\n            - '*\\OUTLOOK.EXE'\n        Image:\n            - '*\\cmd.exe'\n            - '*\\powershell.exe'\n            - '*\\wscript.exe'\n            - '*\\cscript.exe'\n            - '*\\sh.exe'\n            - '*\\bash.exe'\n            - '*\\scrcons.exe'\n            - '*\\schtasks.exe'  # see https://www.hybrid-analysis.com/sample/b409538c99f99b94a5035d9fa44a506b41be0feb23e89b7e4d272ba791aa6002?environmentId=100\n            - '*\\regsvr32.exe'  # see https://twitter.com/subTee/status/899283365647458305\n            - '*\\hh.exe'  # see https://www.hybrid-analysis.com/sample/6abc2b63f1865a847ff7f5a9d49bb944397b36f5503b9718d6f91f93d60f7cd7?environmentId=100\n            - '*\\wmic.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\mshta.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\rundll32.exe'  # see https://mgreen27.github.io/posts/2018/04/02/DownloadCradle.html\n            - '*\\msiexec.exe'  # see https://twitter.com/DissectMalware/status/984252467474026497\n    condition: selection\nfields:\n    - CommandLine\n    - ParentCommandLine\nfalsepositives:\n    - unknown\nlevel: high\n", "git_filepath": "/windows/sysmon/sysmon_office_shell.yml", "title": "sigma: Microsoft Office Product Spawning Windows Shell", "author_keyword": "Michael Haag, Florian Roth", "is_verified": false, "downloads": 0, "hash": "c7c685cf818480a0ccf44e57f04b631ad0147f579c7326a7425fd0aca377e4be", "level": "high"}}